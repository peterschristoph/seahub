webpackJsonp([5],{100:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p={selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,onDirentItemClick:d.default.func.isRequired,node:d.default.object.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,filePath:d.default.string,fileSuffixes:d.default.array},f=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.onToggleClick=function(e){e.stopPropagation();var t=n.props.node;t.isExpanded?n.props.onNodeCollapse(t):n.props.onNodeExpanded(t)},n.onItemClick=function(e){e.stopPropagation();var t=!1;n.props.selectedRepo&&(t=n.props.selectedRepo.repo_id===n.props.repo.repo_id),t?n.props.selectedPath!==n.state.filePath?n.props.onDirentItemClick(n.state.filePath,n.props.node.object):"dir"===n.props.node.object.type&&n.onToggleClick(e):n.props.onDirentItemClick(n.state.filePath,n.props.node.object)},n.renderChildren=function(){var e=n.props.node;return e.hasChildren()?u.default.createElement("div",{className:"list-view-content"},e.children.map(function(e){return u.default.createElement(t,{key:e.path,node:e,onNodeCollapse:n.props.onNodeCollapse,onNodeExpanded:n.props.onNodeExpanded,repo:n.props.repo,onDirentItemClick:n.props.onDirentItemClick,selectedRepo:n.props.selectedRepo,selectedPath:n.props.selectedPath,fileSuffixes:n.props.fileSuffixes})})):""};var a=n.props.filePath?n.props.filePath+"/"+n.props.node.object.name:n.props.node.path;return n.state={filePath:a},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.node,t=!1;this.props.selectedRepo&&(t=this.props.selectedRepo.repo_id===this.props.repo.repo_id);var n=this.props.selectedPath===this.state.filePath,a=e.object.name;if(this.props.fileSuffixes&&a&&"file"===e.object.type)if(-1!==a.indexOf(".")){var r=a.slice(a.lastIndexOf(".")+1).toLowerCase();if(!this.props.fileSuffixes.includes(r))return null}else if("file"===e.object.type)return null;return u.default.createElement("div",{className:"file-chooser-item"},u.default.createElement("div",{className:"/"===e.path?"hide":""},u.default.createElement("div",{className:(t&&n?"item-active":"")+" item-info",onClick:this.onItemClick},u.default.createElement("div",{className:"item-text"},u.default.createElement("span",{className:"name user-select-none ellipsis"},e.object&&e.object.name)),u.default.createElement("div",{className:"item-left-icon"},"file"!==e.object.type&&u.default.createElement("span",{className:"icon item-toggle fa "+(e.isExpanded?"fa-caret-down":"fa-caret-right"),onClick:this.onToggleClick}),u.default.createElement("i",{className:"tree-node-icon"},u.default.createElement("span",{className:"icon far "+("dir"===e.object.type?"fa-folder":"fa-file")}))))),e.isExpanded&&this.renderChildren())}}]),t}(u.default.Component);f.propTypes=p,t.default=f},101:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(102),f=a(p),h={searchResults:d.default.array.isRequired,onItemClick:d.default.func.isRequired,onSearchedItemDoubleClick:d.default.func.isRequired},m=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemClick=function(e){n.setState({currentItem:e}),n.props.onItemClick(e)},n.state={currentItem:null},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this;return u.default.createElement("table",{className:"table-thead-hidden file-chooser-table",rules:"node",frame:"void"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"8%"}),u.default.createElement("th",{width:"92%"}))),u.default.createElement("tbody",null,this.props.searchResults.map(function(t,n){return u.default.createElement(f.default,{key:n,item:t,currentItem:e.state.currentItem,onItemClick:e.onItemClick,onSearchedItemDoubleClick:e.props.onSearchedItemDoubleClick})})))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},102:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(3),f={currentItem:d.default.object,onItemClick:d.default.func.isRequired,onSearchedItemDoubleClick:d.default.func.isRequired},h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({highlight:!0})},n.onMouseLeave=function(){n.setState({highlight:!1})},n.onClick=function(){var e=n.props.item;n.props.onItemClick(e)},n.searchItemDoubleClick=function(e){var t=n.props.item;n.props.onSearchedItemDoubleClick(t)},n.state={highlight:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.item,n=e.currentItem,a=t.link_content?p.Utils.getFolderIconUrl(!1,192):p.Utils.getDefaultLibIconUrl(!1),r=t.is_dir?a:p.Utils.getFileIconUrl(t.name,192),o=this.state.highlight?"tr-highlight":"";return n&&t.repo_id===n.repo_id&&t.path===n.path&&(o="tr-active"),u.default.createElement("tr",{className:o,onClick:this.onClick,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave,onDoubleClick:this.searchItemDoubleClick},u.default.createElement("td",{className:"text-center"},u.default.createElement("img",{className:"item-img",src:r,alt:"",width:"24"})),u.default.createElement("td",null,u.default.createElement("span",{className:"item-link"},t.repo_name,"/",t.link_content)))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},103:function(e,t){},104:function(e,t){},1056:function(e,t){},1057:function(e,t){},1058:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(811),i=function(e){return e&&e.__esModule?e:{default:e}}(o),s=n(2),l=""!==s.seafileCollabServer?(0,i.default)(s.seafileCollabServer):void 0,u=function(){function e(){a(this,e)}return r(e,[{key:"watchRepo",value:function(e,t){l&&(l.emit("repo_update",{request:"watch_update",repo_id:e,user:{name:s.name,username:s.username,contact_email:s.contactEmail}}),l.on("repo_update",t))}},{key:"unwatchRepo",value:function(e,t){l&&(l.emit("repo_update",{request:"unwatch_update",repo_id:e,user:{name:s.name,username:s.username,contact_email:s.contactEmail}}),l.off("repo_update",t))}}]),e}(),c=new u;t.default=c},1059:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(6),h={currentNode:d.default.object.isRequired,toggleCancel:d.default.func.isRequired,handleSubmit:d.default.func.isRequired},m=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.toggle=function(){a.props.toggleCancel()},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.currentNode,t=e.object.name,n=(0,p.gettext)("Delete File");return e.object.isDir()&&(n=(0,p.gettext)("Delete Folder")),u.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(f.ModalHeader,{toggle:this.toggle},n),u.default.createElement(f.ModalBody,null,u.default.createElement("p",null,(0,p.gettext)("Are you sure to delete")," ",u.default.createElement("b",null,t)," ?")),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),u.default.createElement(f.Button,{color:"primary",onClick:this.props.handleSubmit},(0,p.gettext)("Delete"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},1060:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(3),h=n(6),m={currentNode:d.default.object,onRename:d.default.func.isRequired,toggleCancel:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({newName:e.target.value})},n.handleSubmit=function(){var e=n.validateInput(),t=e.isValid,a=e.errMessage;if(t){if(n.checkDuplicatedName()){var r=(0,p.gettext)('The name "{name}" is already taken. Please choose a different name.');r=r.replace("{name}",f.Utils.HTMLescape(n.state.newName)),n.setState({errMessage:r})}else n.props.onRename(n.state.newName)}else n.setState({errMessage:a})},n.handleKeyPress=function(e){"Enter"===e.key&&n.handleSubmit()},n.toggle=function(){n.props.toggleCancel()},n.changeState=function(e){var t=e.object.name;n.setState({newName:t})},n.validateInput=function(){var e=n.state.newName.trim(),t=!0,a="";return e?e.indexOf("/")>-1?(t=!1,a=(0,p.gettext)("Name should not include '/'."),{isValid:t,errMessage:a}):{isValid:t,errMessage:a}:(t=!1,a=(0,p.gettext)("Name is required."),{isValid:t,errMessage:a})},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.newName)},n.state={newName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.setState({newName:this.props.currentNode.object.name})}},{key:"componentDidMount",value:function(){var e=this.props.currentNode;if(this.changeState(e),this.newInput.focus(),"file"===e.object.type){var t=e.object.name.lastIndexOf(".md");this.newInput.setSelectionRange(0,t,"forward")}else this.newInput.setSelectionRange(0,-1)}},{key:"componentWillReceiveProps",value:function(e){this.changeState(e.currentNode)}},{key:"render",value:function(){var e=this,t=this.props.currentNode.object.type;return u.default.createElement(h.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(h.ModalHeader,{toggle:this.toggle},"file"===t?(0,p.gettext)("Rename File"):(0,p.gettext)("Rename Folder")),u.default.createElement(h.ModalBody,null,u.default.createElement("p",null,"file"===t?(0,p.gettext)("New file name"):(0,p.gettext)("New folder name")),u.default.createElement(h.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},placeholder:"newName",value:this.state.newName,onChange:this.handleChange}),this.state.errMessage&&u.default.createElement(h.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(h.ModalFooter,null,u.default.createElement(h.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel")),u.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,p.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},1061:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f={currentMode:d.default.string.isRequired,switchViewMode:d.default.func.isRequired},h=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.switchViewMode=function(e){e.preventDefault();var t=e.target.id;t!==a.props.currentMode&&a.props.switchViewMode(t)},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){var e="btn btn-secondary btn-icon sf-view-mode-btn ";return u.default.createElement(u.default.Fragment,null,u.default.createElement("div",{className:"view-mode btn-group"},u.default.createElement("button",{className:e+" sf2-icon-list-view "+("list"===this.props.currentMode?"current-mode":""),id:"list",title:(0,p.gettext)("List"),onClick:this.switchViewMode}),u.default.createElement("button",{className:e+" sf2-icon-grid-view "+("grid"===this.props.currentMode?"current-mode":""),id:"grid",title:(0,p.gettext)("Grid"),onClick:this.switchViewMode}),u.default.createElement("button",{className:e+" sf2-icon-two-columns "+("column"===this.props.currentMode?"current-mode":""),id:"column",title:(0,p.gettext)("Column"),onClick:this.switchViewMode})),u.default.createElement("div",{className:"detail-btn btn-group"},u.default.createElement("button",{className:"btn btn-secondary btn-icon ml-1 fas fa-info",id:"detail",title:(0,p.gettext)("Detail"),onClick:this.switchViewMode})))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},1062:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(3),f=n(2),h=n(24),m=a(h),g=n(404),v=a(g),y=n(323),b=a(y),C=n(108),S=a(C),w={path:d.default.string.isRequired,repoID:d.default.string.isRequired,repoName:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,userPerm:d.default.string.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,showShareBtn:d.default.bool.isRequired,onAddFile:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onUploadFile:d.default.func.isRequired,onUploadFolder:d.default.func.isRequired,direntList:d.default.array.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.hideOperationMenu=function(){n.setState({isUploadMenuShow:!1,isCreateMenuShow:!1})},n.toggleOperationMenu=function(e){e.nativeEvent.stopImmediatePropagation();var t=e.target.getBoundingClientRect(),a=t.left,r=t.bottom,o={position:"fixed",display:"block",left:a,top:r};n.setState({operationMenuStyle:o})},n.onUploadClick=function(e){n.toggleOperationMenu(e),n.setState({isUploadMenuShow:!0,isCreateMenuShow:!1})},n.onUploadFile=function(e){n.setState({isUploadMenuShow:!1}),n.props.onUploadFile(e)},n.onUploadFolder=function(e){n.setState({isUploadMenuShow:!1}),n.props.onUploadFolder(e)},n.onCreateClick=function(e){n.toggleOperationMenu(e),n.setState({isCreateMenuShow:!0,isUploadMenuShow:!1})},n.onShareClick=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:""})},n.onCreateMarkdownToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".md"})},n.onCreateExcelToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".xlsx"})},n.onCreatePPTToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".pptx"})},n.onCreateWordToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow,fileType:".docx"})},n.onAddFile=function(e,t){n.setState({isCreateFileDialogShow:!1}),n.props.onAddFile(e,t)},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some(function(t){return t.name===e})},n.state={fileType:".md",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isUploadMenuShow:!1,isCreateMenuShow:!1,isShareDialogShow:!1,operationMenuStyle:""},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.hideOperationMenu)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.hideOperationMenu)}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.repoName,a=e.userPerm;if("rw"!==a&&"admin"!==a)return"";var r="/"===t?"library":"dir",o="/"==t?n:p.Utils.getFolderName(t);return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"operation"},p.Utils.isSupportUploadFolder()?u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,f.gettext)("Upload"),onClick:this.onUploadClick},(0,f.gettext)("Upload")):u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,f.gettext)("Upload"),onClick:this.onUploadFile},(0,f.gettext)("Upload")),u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,f.gettext)("New"),onClick:this.onCreateClick},(0,f.gettext)("New")),this.props.showShareBtn&&u.default.createElement("button",{className:"btn btn-secondary operation-item",title:(0,f.gettext)("Share"),onClick:this.onShareClick},(0,f.gettext)("Share"))),this.state.isUploadMenuShow&&u.default.createElement("ul",{className:"menu dropdown-menu",style:this.state.operationMenuStyle},u.default.createElement("li",{className:"dropdown-item",onClick:this.onUploadFile},(0,f.gettext)("Upload Files")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onUploadFolder},(0,f.gettext)("Upload Folder"))),this.state.isCreateMenuShow&&u.default.createElement("ul",{className:"menu dropdown-menu",style:this.state.operationMenuStyle},u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateFolderToggle},(0,f.gettext)("New Folder")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateFileToggle},(0,f.gettext)("New File")),u.default.createElement("li",{className:"dropdown-divider"}),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateMarkdownToggle},(0,f.gettext)("New Markdown File")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateExcelToggle},(0,f.gettext)("New Excel File")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreatePPTToggle},(0,f.gettext)("New PowerPoint File")),u.default.createElement("li",{className:"dropdown-item",onClick:this.onCreateWordToggle},(0,f.gettext)("New Word File"))),this.state.isCreateFileDialogShow&&u.default.createElement(m.default,null,u.default.createElement(b.default,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.onAddFile,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onCreateFileToggle})),this.state.isCreateFolderDialogShow&&u.default.createElement(m.default,null,u.default.createElement(v.default,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})),this.state.isShareDialogShow&&u.default.createElement(m.default,null,u.default.createElement(S.default,{itemType:r,itemName:o,itemPath:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.onShareClick})))}}]),t}(u.default.Component);D.propTypes=w,t.default=D},1063:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(3),m=n(4),g=n(240),v=a(g),y=n(228),b=a(y),C=n(324),S=a(C),w=n(325),D=a(w),E=n(108),P=a(E),L=n(401),T=a(L),Y=n(290),M=a(Y),_=n(314),k=a(_),Z=n(24),N=a(Z),I=n(322),R=a(I),O=n(5),F=a(O);n(1064);var X={path:d.default.string.isRequired,userPerm:d.default.string.isRequired,repoID:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,selectedDirentList:d.default.array.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,isRepoOwner:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,currentRepoInfo:d.default.object.isRequired,onFilesTagChanged:d.default.func.isRequired,unSelectDirent:d.default.func.isRequired,updateDirent:d.default.func.isRequired},J=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDelete=function(){n.props.onItemsDelete()},n.onItemsDownload=function(){var e=n.props,t=e.path,a=e.repoID,r=e.selectedDirentList;if(r.length){if(1===r.length&&!r[0].isDir()){var o=h.Utils.joinPath(t,r[0].name),i=v.default.getUrl({type:"download_file_url",repoID:a,filePath:o});return void(location.href=i)}n.setState({isZipDialogOpen:!0})}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.getDirentMenuList=function(e){var t=[],a=n.props.currentRepoInfo,r=h.Utils.isHasPermissionToShare(a,e.permission,e),o=b.default.SHARE,i=b.default.TAGS,s=b.default.RELATED_FILES,l=b.default.HISTORY,u=b.default.ACCESS_LOG,c=b.default.OPEN_VIA_CLIENT,d=b.default.LOCK,p=b.default.UNLOCK;if("dir"===e.type)return r&&(t=[o]),t;if("file"===e.type){return t=[].concat(r?[o]:[],[i,s,"Divider",l,u,"Divider",c]),h.Utils.isMarkdownFile(e.name)||(t=t.filter(function(e){return e!==s})),f.isPro&&f.fileAuditEnabled||(t=t.filter(function(e){return e!==u})),f.isPro&&(e.is_locked?(e.locked_by_me||"OnlineOffice"===e.lock_owner&&"rw"===a.permission)&&t.splice(1,0,p):t.splice(1,0,d)),t}},n.onMenuItemClick=function(e){var t=n.props.selectedDirentList,a=t[0];switch(e){case"Share":n.setState({showLibContentViewDialogs:!0,showShareDialog:!0});break;case"Tags":n.listFileTags(a);break;case"Lock":n.lockFile(a);break;case"Unlock":n.unlockFile(a);break;case"Related Files":n.openRelatedFilesDialog(a);break;case"History":n.onHistory(a);break;case"Access Log":n.onAccessLog(a);break;case"Open via Client":n.onOpenViaClient(a)}},n.lockFile=function(e){var t=n.getDirentPath(e);m.seafileAPI.lockfile(n.props.repoID,t).then(function(t){t.data.is_locked&&(n.props.updateDirent(e,"is_locked",!0),n.props.updateDirent(e,"locked_by_me",!0),n.props.unSelectDirent())}).catch(function(e){var t=h.Utils.getErrorMsg(e);F.default.danger(t)})},n.unlockFile=function(e){var t=n.getDirentPath(e);m.seafileAPI.unlockfile(n.props.repoID,t).then(function(t){t.data.is_locked||(n.props.updateDirent(e,"is_locked",!1),n.props.updateDirent(e,"locked_by_me",!1),n.props.unSelectDirent())}).catch(function(e){var t=h.Utils.getErrorMsg(e);F.default.danger(t)})},n.onOpenViaClient=function(e){var t=n.getDirentPath(e),a=v.default.getUrl({type:"open_via_client",repoID:n.props.repoID,filePath:t});location.href=a,n.props.unSelectDirent()},n.onHistory=function(e){var t=n.getDirentPath(e),a=v.default.getUrl({type:"file_revisions",repoID:n.props.repoID,filePath:t});location.href=a},n.onAccessLog=function(e){var t=n.getDirentPath(e),a=f.siteRoot+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(t);window.open(a)},n.openRelatedFilesDialog=function(e){var t=n.getDirentPath(e);m.seafileAPI.listRelatedFiles(n.props.repoID,t).then(function(e){var t=e.data.related_files;t.length>0?n.setState({relatedFiles:t,showLibContentViewDialogs:!0,showRelatedFileDialog:!0,viewMode:"list_related_file"}):n.setState({relatedFiles:t,showLibContentViewDialogs:!0,showRelatedFileDialog:!0,viewMode:"add_related_file"})}).catch(function(e){var t=h.Utils.getErrorMsg(e);F.default.danger(t)})},n.toggleCancel=function(){n.setState({showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,showRelatedFileDialog:!1})},n.listFileTags=function(e){var t=n.getDirentPath(e);m.seafileAPI.listFileTags(n.props.repoID,t).then(function(e){for(var t=e.data.file_tags,a=0,r=t.length;a<r;a++)t[a].id=t[a].file_tag_id;n.setState({fileTagList:t,showLibContentViewDialogs:!0,showEditFileTagDialog:!0})}).catch(function(e){var t=h.Utils.getErrorMsg(e);F.default.danger(t)})},n.onMenuFileTagChanged=function(){n.listFileTags(n.props.selectedDirentList[0]);for(var e=n.props.selectedDirentList.length,t=0;t<e;t++){var a=n.props.selectedDirentList[t],r=n.getDirentPath(a);n.props.onFilesTagChanged(a,r)}},n.listRelatedFiles=function(e){var t=n.getDirentPath(e);m.seafileAPI.listRelatedFiles(n.props.repoID,t).then(function(e){n.setState({relatedFiles:e.data.related_files})}).catch(function(e){var t=h.Utils.getErrorMsg(e);F.default.danger(t)})},n.onRelatedFileChange=function(){n.listRelatedFiles(n.props.selectedDirentList[0])},n.getDirentPath=function(e){if(e)return h.Utils.joinPath(n.props.path,e.name)},n.state={isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isMutipleOperation:!0,showLibContentViewDialogs:!1,showShareDialog:!1,showEditFileTagDialog:!1,fileTagList:[],multiFileTagList:[],showRelatedFileDialog:!1,viewMode:"list_related_file"},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.repoID,n=e.userPerm,a=this.getDirentPath(this.props.selectedDirentList[0]);return"rw"!==n&&"admin"!==n?"":u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"d-flex"},u.default.createElement(p.ButtonGroup,{className:"flex-row group-operations"},u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-move",title:(0,f.gettext)("Move"),onClick:this.onMoveToggle}),u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-copy",title:(0,f.gettext)("Copy"),onClick:this.onCopyToggle}),u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-delete",title:(0,f.gettext)("Delete"),onClick:this.onItemsDelete}),u.default.createElement(p.Button,{className:"secondary group-op-item action-icon sf2-icon-download",title:(0,f.gettext)("Download"),onClick:this.onItemsDownload}),1===this.props.selectedDirentList.length&&u.default.createElement(R.default,{tagName:"button",item:this.props.selectedDirentList[0],toggleClass:"fas fa-ellipsis-v dirents-more-menu",onMenuItemClick:this.onMenuItemClick,getMenuList:this.getDirentMenuList}))),this.state.isMoveDialogShow&&u.default.createElement(S.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,isMutipleOperation:this.state.isMutipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&u.default.createElement(D.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.repoEncrypted,selectedDirentList:this.props.selectedDirentList,isMutipleOperation:this.state.isMutipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isZipDialogOpen&&u.default.createElement(N.default,null,u.default.createElement(k.default,{repoID:this.props.repoID,path:this.props.path,target:this.props.selectedDirentList.map(function(e){return e.name}),toggleDialog:this.closeZipDialog})),this.state.showLibContentViewDialogs&&u.default.createElement(l.Fragment,null,this.state.showShareDialog&&u.default.createElement(N.default,null,u.default.createElement(P.default,{itemType:this.props.selectedDirentList[0].type,itemName:this.props.selectedDirentList[0].name,itemPath:a,userPerm:this.props.selectedDirentList[0].permission,repoID:t,repoEncrypted:!1,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.state.isGroupOwnedRepo,toggleDialog:this.toggleCancel})),this.state.showEditFileTagDialog&&u.default.createElement(N.default,null,u.default.createElement(M.default,{repoID:t,filePath:a,fileTagList:this.state.fileTagList,toggleCancel:this.toggleCancel,onFileTagChanged:this.onMenuFileTagChanged})),this.state.showRelatedFileDialog&&u.default.createElement(N.default,null,u.default.createElement(T.default,{repoID:t,filePath:a,relatedFiles:this.state.relatedFiles,toggleCancel:this.toggleCancel,onRelatedFileChange:this.onRelatedFileChange,dirent:this.props.selectedDirentList[0],viewMode:this.state.viewMode}))))}}]),t}(u.default.Component);J.propTypes=X,t.default=J},1064:function(e,t){},1065:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(1066),f=a(p),h=n(1067),m=a(h),g={repoID:d.default.string.isRequired,repoName:d.default.string.isRequired,permission:d.default.bool.isRequired,currentPath:d.default.string.isRequired,onPathClick:d.default.func.isRequired,onTabNavClick:d.default.func,pathPrefix:d.default.array,isViewFile:d.default.bool,updateUsedRepoTags:d.default.func.isRequired,fileTags:d.default.array.isRequired,onDeleteRepoTag:d.default.func.isRequired},v=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{repoName:this.props.repoName,pathPrefix:this.props.pathPrefix,currentPath:this.props.currentPath,onPathClick:this.props.onPathClick,onTabNavClick:this.props.onTabNavClick,repoID:this.props.repoID,isViewFile:this.props.isViewFile,fileTags:this.props.fileTags}),u.default.createElement(m.default,{repoID:this.props.repoID,repoName:this.props.repoName,permission:this.props.permission,currentPath:this.props.currentPath,updateUsedRepoTags:this.props.updateUsedRepoTags,onDeleteRepoTag:this.props.onDeleteRepoTag}))}}]),t}(u.default.Component);v.propTypes=g,t.default=v},1066:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(72),f=n(6),h=n(2),m=n(292),g=a(m),v=n(3),y={repoName:d.default.string.isRequired,currentPath:d.default.string.isRequired,onPathClick:d.default.func.isRequired,onTabNavClick:d.default.func,pathPrefix:d.default.array,repoID:d.default.string.isRequired,isViewFile:d.default.bool,fileTags:d.default.array.isRequired},b=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,c=Array(s),d=0;d<s;d++)c[d]=arguments[d];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.onPathClick=function(e){var t=v.Utils.getEventData(e,"path");a.props.onPathClick(t)},a.onTabNavClick=function(e,t,n){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress){if(!window.confirm((0,h.gettext)("A file is being uploaded. Are you sure you want to leave this page?")))return e.preventDefault(),!1;window.uploader.isUploadProgressDialogShow=!1}a.props.onTabNavClick(t,n)},a.turnPathToLink=function(e){e="/"===e[e.length-1]?e.slice(0,e.length-1):e;var t=e.split("/"),n="";return t.map(function(e,r){if(""!==e)return r===t.length-1?u.default.createElement(l.Fragment,{key:r},u.default.createElement("span",{className:"path-split"},"/"),u.default.createElement("span",{className:"path-file-name"},e)):(n+="/"+e,u.default.createElement(l.Fragment,{key:r},u.default.createElement("span",{className:"path-split"},"/"),u.default.createElement("a",{className:"path-link","data-path":n,onClick:a.onPathClick},e)))})},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentPath,a=t.repoName,r=t.fileTags,o=this.turnPathToLink(n),i="";return r.length>0&&r.forEach(function(e){i+=e.name+" "}),u.default.createElement("div",{className:"path-container"},this.props.pathPrefix&&this.props.pathPrefix.map(function(t,n){return u.default.createElement(l.Fragment,{key:n},u.default.createElement(p.Link,{to:t.url,className:"normal",onClick:function(n){return e.onTabNavClick(n,t.name,t.id)}},(0,h.gettext)(t.showName)),u.default.createElement("span",{className:"path-split"},"/"))}),this.props.pathPrefix&&0===this.props.pathPrefix.length&&u.default.createElement(l.Fragment,null,u.default.createElement(p.Link,{to:h.siteRoot+"my-libs/",className:"normal",onClick:function(t){return e.onTabNavClick(t,"my-libs")}},(0,h.gettext)("Libraries")),u.default.createElement("span",{className:"path-split"},"/")),!this.props.pathPrefix&&u.default.createElement(l.Fragment,null,u.default.createElement(p.Link,{href:h.siteRoot+"my-libs/",className:"normal",onClick:function(t){return e.onTabNavClick(t,"my-libs")}},(0,h.gettext)("Libraries")),u.default.createElement("span",{className:"path-split"},"/")),"/"===n||""===n?u.default.createElement("span",{className:"path-repo-name"},a):u.default.createElement("a",{className:"path-link","data-path":"/",onClick:this.onPathClick},a),o,this.props.isViewFile&&u.default.createElement(g.default,{repoID:this.props.repoID,path:this.props.currentPath}),this.props.isViewFile&&0!==r.length&&u.default.createElement("span",{id:"column-mode-file-tags",className:"tag-list tag-list-stacked align-middle ml-1"},r.map(function(e,t){return u.default.createElement("span",{className:"file-tag",key:e.id,style:{zIndex:t,backgroundColor:e.color}})}),u.default.createElement(f.UncontrolledTooltip,{target:"column-mode-file-tags",placement:"bottom"},i)))}}]),t}(u.default.Component);b.propTypes=y,t.default=b},1067:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(2),d=n(3),p=n(1),f=a(p),h=n(24),m=a(h),g=n(6),v=n(1068),y=a(v),b=n(506),C=a(b),S=n(1069),w=a(S),D=n(824),E=a(D),P={repoID:f.default.string.isRequired,repoName:f.default.string.isRequired,permission:f.default.bool.isRequired,currentPath:f.default.string.isRequired,updateUsedRepoTags:f.default.func.isRequired,onDeleteRepoTag:f.default.func.isRequired},L=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowListRepoTag=function(){n.setState({isRepoTagDialogShow:!0,isListRepoTagShow:!0,isUpdateRepoTagShow:!1,isCreateRepoTagShow:!1,isListTaggedFileShow:!1})},n.onCloseRepoTagDialog=function(){n.setState({isRepoTagDialogShow:!1,isListRepoTagShow:!1,isUpdateRepoTagShow:!1,isCreateRepoTagShow:!1,isListTaggedFileShow:!1})},n.onCreateRepoTagToggle=function(){n.setState({isCreateRepoTagShow:!n.state.isCreateRepoTagShow,isListRepoTagShow:!n.state.isListRepoTagShow})},n.onUpdateRepoTagToggle=function(e){n.setState({currentTag:e,isListRepoTagShow:!n.state.isListRepoTagShow,isUpdateRepoTagShow:!n.state.isUpdateRepoTagShow})},n.onListTaggedFileToggle=function(e){n.setState({currentTag:e,isListRepoTagShow:!n.state.isListRepoTagShow,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.state={isRepoTagDialogShow:!1,currentTag:null,isListRepoTagShow:!1,isUpdateRepoTagShow:!1,isCreateRepoTagShow:!1,isListTaggedFileShow:!1},n}return i(t,e),s(t,[{key:"isMarkdownFile",value:function(e){return d.Utils.getFileName(e).indexOf(".md")>-1}},{key:"render",value:function(){var e=this.props,t=e.repoID,n=(e.repoName,e.permission),a=e.currentPath,r=this.isMarkdownFile(a),o=d.Utils.getFileName(a),i=c.siteRoot+"repo/"+t+"/trash/",s=c.siteRoot+"repo/history/"+t+"/";return n&&!r?o?(i=c.siteRoot+"repo/"+t+"/trash/?path="+encodeURIComponent(a),u.default.createElement("ul",{className:"path-toolbar"},u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-recycle",href:i,title:(0,c.gettext)("Trash"),"aria-label":(0,c.gettext)("Trash")})))):u.default.createElement(l.Fragment,null,u.default.createElement("ul",{className:"path-toolbar"},u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-tag",onClick:this.onShowListRepoTag,title:(0,c.gettext)("Tags"),"aria-label":(0,c.gettext)("Tags")})),u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-recycle",href:i,title:(0,c.gettext)("Trash"),"aria-label":(0,c.gettext)("Trash")})),u.default.createElement("li",{className:"toolbar-item"},u.default.createElement("a",{className:"op-link sf2-icon-history",href:s,title:(0,c.gettext)("History"),"aria-label":(0,c.gettext)("History")}))),this.state.isRepoTagDialogShow&&u.default.createElement(m.default,null,u.default.createElement(g.Modal,{isOpen:!0},this.state.isListRepoTagShow&&u.default.createElement(y.default,{repoID:t,onListTagCancel:this.onCloseRepoTagDialog,onCreateRepoTag:this.onCreateRepoTagToggle,onUpdateRepoTag:this.onUpdateRepoTagToggle,onListTaggedFiles:this.onListTaggedFileToggle}),this.state.isCreateRepoTagShow&&u.default.createElement(C.default,{repoID:t,onClose:this.onCloseRepoTagDialog,toggleCancel:this.onCreateRepoTagToggle}),this.state.isUpdateRepoTagShow&&u.default.createElement(w.default,{repoID:t,currentTag:this.state.currentTag,onClose:this.onCloseRepoTagDialog,toggleCancel:this.onUpdateRepoTagToggle,onDeleteRepoTag:this.props.onDeleteRepoTag,updateUsedRepoTags:this.props.updateUsedRepoTags}),this.state.isListTaggedFileShow&&u.default.createElement(E.default,{repoID:this.props.repoID,currentTag:this.state.currentTag,onClose:this.onCloseRepoTagDialog,toggleCancel:this.onListTaggedFileToggle,updateUsedRepoTags:this.props.updateUsedRepoTags})))):""}}]),t}(u.default.Component);L.propTypes=P,t.default=L},1068:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),v=a(g),y=n(320),b=a(y);n(507);var C={item:d.default.object.isRequired,onTagUpdate:d.default.func.isRequired,onListTaggedFiles:d.default.func.isRequired},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseOver=function(){n.setState({showSelectedTag:!0})},n.onMouseOut=function(){n.setState({showSelectedTag:!1})},n.onTagUpdate=function(){n.props.onTagUpdate(n.props.item)},n.onListTaggedFiles=function(){n.props.onListTaggedFiles(n.props.item)},n.state={showSelectedTag:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item.color,t=m.Utils.getDarkColor(e),n=this.props.item.fileCount,a=1===n||0===n?(0,f.gettext)("file"):(0,f.gettext)("files");return u.default.createElement("li",{className:"tag-list-item"},u.default.createElement("div",{className:"tag-demo",style:{backgroundColor:e},onMouseOver:this.onMouseOver,onMouseOut:this.onMouseOut},u.default.createElement("span",{className:this.state.showSelectedTag?"show-tag-selected":"",style:{backgroundColor:t}}),u.default.createElement("span",{className:"tag-name"},this.props.item.name),u.default.createElement("span",{className:"tag-files",onClick:this.onListTaggedFiles},n," ",a)),u.default.createElement("i",{className:"tag-edit fa fa-pencil-alt",onClick:this.onTagUpdate}))}}]),t}(u.default.Component);S.propTypes=C;var w={repoID:d.default.string.isRequired,onListTagCancel:d.default.func.isRequired,onCreateRepoTag:d.default.func.isRequired,onUpdateRepoTag:d.default.func.isRequired,onListTaggedFiles:d.default.func.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.props.onListTagCancel()},n.createNewTag=function(e){e.preventDefault(),n.props.onCreateRepoTag()},n.state={repotagList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;h.seafileAPI.listRepoTags(t).then(function(t){var n=[];t.data.repo_tags.forEach(function(e){var t=new b.default(e);n.push(t)}),e.setState({repotagList:n})}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Tags")),u.default.createElement(p.ModalBody,null,u.default.createElement("ul",{className:"tag-list tag-list-container"},this.state.repotagList.map(function(t,n){return u.default.createElement(S,{key:n,item:t,onTagUpdate:e.props.onUpdateRepoTag,onListTaggedFiles:e.props.onListTaggedFiles})})),u.default.createElement("a",{href:"#",className:"add-tag-link",onClick:this.createNewTag},(0,f.gettext)("Create a new tag"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Close"))))}}]),t}(u.default.Component);D.propTypes=w,t.default=D},1069:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(5),v=a(g),y={currentTag:d.default.object,repoID:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onDeleteRepoTag:d.default.func.isRequired,updateUsedRepoTags:d.default.func.isRequired,onClose:d.default.func.isRequired},b=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputNewName=function(e){n.setState({newName:e.target.value})},n.selectNewcolor=function(e){n.setState({newColor:e.target.value})},n.updateTag=function(){var e=n.props.currentTag.id,t=n.state.newName,a=n.state.newColor,r=n.props.repoID;h.seafileAPI.updateRepoTag(r,e,t,a).then(function(){n.props.toggleCancel(),n.props.updateUsedRepoTags()}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})},n.handleKeyPress=function(e){"Enter"===e.key&&n.updateTag()},n.deleteTagClick=function(e){n.setState({deleteRepoTag:!n.state.deleteRepoTag})},n.onDeleteTag=function(){var e=n.props.currentTag,t=n.props.repoID;h.seafileAPI.deleteRepoTag(t,e.id).then(function(t){n.props.toggleCancel(),"true"===t.data.success&&n.props.onDeleteRepoTag(e.id)}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})},n.state={deleteRepoTag:!1,newName:n.props.currentTag.name,newColor:n.props.currentTag.color,colorList:["#FFA8A8","#FFA94D","#FFD43B","#A0EC50","#A9E34B","#63E6BE","#4FD2C9","#72C3FC","#91A7FF","#E599F7","#B197FC","#F783AC","#CED4DA"]},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.newInput.focus(),this.newInput.setSelectionRange(0,-1)}},{key:"render",value:function(){var e=this,t=this.state.colorList;return-1===t.indexOf(this.props.currentTag.color)&&t.push(this.props.currentTag.color),u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.props.toggleCancel,"aria-label":(0,f.gettext)("Back")}),(0,f.gettext)("Edit Tag")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{className:"tag-edit"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.newName,onChange:this.inputNewName})),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Select a color")),u.default.createElement("div",{className:"row gutters-xs"},t.map(function(t,n){return u.default.createElement("div",{key:n,className:"col-auto",onChange:e.selectNewcolor},u.default.createElement("label",{className:"colorinput"},t===e.props.currentTag.color?u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onChange:e.selectNewcolor}):u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onChange:e.selectNewcolor}),u.default.createElement("span",{className:"colorinput-color",style:{backgroundColor:t}})))}))))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"danger",onClick:this.onDeleteTag},(0,f.gettext)("Delete")),u.default.createElement(p.Button,{color:"primary",onClick:this.updateTag},(0,f.gettext)("Save"))))}}]),t}(u.default.Component);b.propTypes=y,t.default=b},1070:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(1),p=a(d),f=n(2),h=n(3),m=n(228),g=a(m),v=n(4),y=n(240),b=a(y),C=n(12),S=a(C),w=n(5),D=a(w),E=n(24),P=a(E),L=n(323),T=a(L),Y=n(404),M=a(Y),_=n(511),k=a(_),Z=n(314),N=a(Z),I=n(324),R=a(I),O=n(325),F=a(O),X=n(1071),J=a(X),x=n(403),H=a(x),B=n(213),Q=n(1077),j=a(Q),G={path:p.default.string.isRequired,repoID:p.default.string.isRequired,currentRepoInfo:p.default.object,isAllItemSelected:p.default.bool.isRequired,isDirentListLoading:p.default.bool.isRequired,direntList:p.default.array.isRequired,sortBy:p.default.string.isRequired,sortOrder:p.default.string.isRequired,sortItems:p.default.func.isRequired,onAddFile:p.default.func.isRequired,onAddFolder:p.default.func.isRequired,onItemDelete:p.default.func.isRequired,onAllItemSelected:p.default.func.isRequired,onItemSelected:p.default.func.isRequired,onItemRename:p.default.func.isRequired,onItemClick:p.default.func.isRequired,onItemMove:p.default.func.isRequired,onItemCopy:p.default.func.isRequired,onDirentClick:p.default.func.isRequired,updateDirent:p.default.func.isRequired,selectedDirentList:p.default.array.isRequired,onItemsMove:p.default.func.isRequired,onItemsCopy:p.default.func.isRequired,onItemsDelete:p.default.func.isRequired,onFileTagChanged:p.default.func,enableDirPrivateShare:p.default.bool.isRequired,isGroupOwnedRepo:p.default.bool.isRequired,userPerm:p.default.string,showDirentDetail:p.default.func.isRequired},A=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onItemRename=function(e,t){if(n.props.direntList.some(function(e){return e.name===t})){var a=(0,f.gettext)('The name "{name}" is already taken. Please choose a different name.');return a=a.replace("{name}",h.Utils.HTMLescape(t)),D.default.danger(a),!1}n.props.onItemRename(e,t)},n.onItemRenameToggle=function(){n.freezeItem()},n.onItemSelected=function(e){n.setState({activeDirent:null}),n.props.onItemSelected(e)},n.onDirentClick=function(e){n.props.selectedDirentList.length>0&&!n.state.activeDirent||(n.setState({activeDirent:e}),n.props.onDirentClick(e))},n.sortByName=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("name",t)},n.sortByTime=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("time",t)},n.sortBySize=function(e){e.preventDefault();var t="asc"==n.props.sortOrder?"desc":"asc";n.props.sortItems("size",t)},n.prepareImageItem=function(e){var t=!n.repoEncrypted,a=e.name,r=a.substr(a.lastIndexOf(".")+1).toLowerCase(),o="gif"==r,i=h.Utils.encodePath(h.Utils.joinPath(n.props.path,a)),s=n.props.repoID,l=void 0;return l=t&&!o?f.siteRoot+"thumbnail/"+s+"/"+f.thumbnailSizeForOriginal+i:f.siteRoot+"repo/"+s+"/raw"+i,{name:a,url:f.siteRoot+"lib/"+s+"/file"+i,src:l}},n.showImagePopup=function(e){var t=n.props.direntList.filter(function(e){return h.Utils.imageCheck(e.name)}),a=t.map(function(e){return n.prepareImageItem(e)});n.setState({isImagePopupOpen:!0,imageItems:a,imageIndex:t.indexOf(e)})},n.moveToPrevImage=function(){var e=n.state.imageItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+e-1)%e}})},n.moveToNextImage=function(){var e=n.state.imageItems.length;n.setState(function(t){return{imageIndex:(t.imageIndex+1)%e}})},n.closeImagePopup=function(){n.setState({isImagePopupOpen:!1})},n.onCreateFileToggle=function(){n.setState({isCreateFileDialogShow:!n.state.isCreateFileDialogShow})},n.onCreateFolderToggle=function(){n.setState({isCreateFolderDialogShow:!n.state.isCreateFolderDialogShow})},n.onAddFile=function(e,t){n.setState({isCreateFileDialogShow:!1}),n.props.onAddFile(e,t)},n.onAddFolder=function(e){n.setState({isCreateFolderDialogShow:!1}),n.props.onAddFolder(e)},n.checkDuplicatedName=function(e){return n.props.direntList.some(function(t){return t.name===e})},n.onMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onItemsDownload=function(){var e=n.props,t=e.path,a=e.repoID,r=e.selectedDirentList;if(r.length){if(1===r.length&&!r[0].isDir()){var o=h.Utils.joinPath(t,r[0].name),i=b.default.getUrl({type:"download_file_url",repoID:a,filePath:o});return void(location.href=i)}var s=r.map(function(e){return e.name});n.setState({isProgressDialogShow:!0,progress:0}),v.seafileAPI.zipDownload(a,t,s).then(function(e){n.zipToken=e.data.zip_token,n.addDownloadAnimation(),n.interval=setInterval(n.addDownloadAnimation,1e3)}).catch(function(e){var t=h.Utils.getErrorMsg(e);D.default.danger(t)})}},n.addDownloadAnimation=function(){var e=n,t=n.zipToken;v.seafileAPI.queryZipProgress(t).then(function(a){var r=a.data,o=0===r.total?100:(r.zipped/r.total*100).toFixed(0);n.setState({progress:parseInt(o)}),r.total===r.zipped&&(n.setState({progress:100}),clearInterval(n.interval),location.href=b.default.getUrl({type:"download_dir_zip_url",token:t}),setTimeout(function(){e.setState({isProgressDialogShow:!1})},500))}).catch(function(e){var t=h.Utils.getErrorMsg(e);D.default.danger(t)})},n.onCancelDownload=function(){v.seafileAPI.cancelZipTask(n.zipToken).then(function(){n.setState({isProgressDialogShow:!1})}).catch(function(e){var t=h.Utils.getErrorMsg(e);D.default.danger(t)})},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.handleContextClick=function(e,t,a){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.preventDefault(),e.stopPropagation();var o=e.clientX||e.touches&&e.touches[0].pageX,i=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(o-=n.props.posX),n.props.posY&&(i-=n.props.posY),(0,B.hideMenu)();var s={id:t,position:{x:o,y:i},target:e.target,currentObject:r,menuList:a};0!==a.length&&(0,B.showMenu)(s)},n.onContainerClick=function(){n.state.activeDirent&&n.onDirentClick(null)},n.onContainerMouseDown=function(e){n.onMouseDown(e)},n.onContainerContextMenu=function(e){e.preventDefault();var t=n.props.userPerm;if("admin"===t||"rw"===t)if(0===n.props.selectedDirentList.length){var a=[g.default.NEW_FOLDER,g.default.NEW_FILE];n.handleContextClick(e,"dirent-container-menu",a)}else if(1===n.props.selectedDirentList.length)if(n.state.activeDirent)n.onDirentClick(null),e.preventDefault(),e.persist(),setTimeout(function(){var t=[g.default.NEW_FOLDER,g.default.NEW_FILE];n.handleContextClick(e,"dirent-container-menu",t)},0);else{var r=n.props.selectedDirentList[0],o=n.getDirentItemMenuList(r,!0);n.handleContextClick(e,"dirent-item-menu",o,r)}else{var i=[g.default.MOVE,g.default.COPY,g.default.DOWNLOAD,g.default.DELETE];n.handleContextClick(e,"dirents-menu",i)}},n.onContainerMenuItemClick=function(e){switch(e){case"New Folder":n.onCreateFolderToggle();break;case"New File":n.onCreateFileToggle()}(0,B.hideMenu)()},n.onDirentsMenuItemClick=function(e){switch(e){case"Move":n.onMoveToggle();break;case"Copy":n.onCopyToggle();break;case"Download":n.onItemsDownload();break;case"Delete":n.props.onItemsDelete()}(0,B.hideMenu)()},n.onThreadMouseDown=function(e){n.onMouseDown(e)},n.onThreadContextMenu=function(e){e.stopPropagation()},n.onItemMouseDown=function(e){n.onMouseDown(e)},n.onItemContextMenu=function(e,t){if(!(n.props.selectedDirentList.length>1)){n.onDirentClick(t);var a=n.getDirentItemMenuList(t,!0);n.handleContextClick(e,"dirent-item-menu",a,t)}},n.setDirentItemRef=function(e){return function(t){n.direntItems[e]=t}},n.onMenuItemClick=function(e,t,a){var r=n.getDirentIndex(t);n.direntItems[r].onMenuItemClick(e,a),(0,B.hideMenu)()},n.onShowMenu=function(e){n.freezeItem()},n.onHideMenu=function(e){n.unfreezeItem()},n.getDirentIndex=function(e){for(var t=n.props.direntList,a=0,r=0;r<t.length;r++)if(t[r].name===e.name){a=r;break}return a},n.getDirentItemMenuList=function(e,t){var a=n.isRepoOwner,o=n.props.currentRepoInfo,i=f.folderPermEnabled&&(a&&o.has_been_shared_out||o.is_admin),s=e.type,l=e.permission,u=h.Utils.isHasPermissionToShare(o,l,e),c=[],d=[];if(t){var p=g.default.SHARE,m=g.default.DOWNLOAD,v=g.default.DELETE;u&&(d=[p]),"rw"!==e.permission&&"r"!==e.permission||(d=[].concat(r(d),[m])),"rw"===e.permission&&(d=[].concat(r(d),[v])),d=d.length>0?[].concat(r(d),["Divider"]):[]}var y=g.default.RENAME,b=g.default.MOVE,C=g.default.COPY,S=g.default.PERMISSION,w=g.default.OPEN_VIA_CLIENT,D=g.default.LOCK,E=g.default.UNLOCK,P=g.default.COMMENT,L=g.default.HISTORY,T=g.default.ACCESS_LOG,Y=g.default.TAGS;return"dir"===s&&"rw"===l?c=i?[].concat(r(d),[y,b,C,"Divider",S,"Divider",w]):[].concat(r(d),[y,b,C,"Divider",w]):"dir"===s&&"r"===l?(c=[].concat(r(d)),c=o.encrypted?[].concat(r(c),[C]):c.slice(0,c.length-1)):"file"===s&&"rw"===l?(c=[].concat(r(d)),(!e.is_locked||e.is_locked&&e.locked_by_me)&&(c.push(y),c.push(b)),c.push(C),c.push(Y),f.isPro&&(e.is_locked?(e.locked_by_me||"OnlineOffice"===e.lock_owner&&"rw"===l)&&c.push(E):c.push(D)),c.push("Divider"),f.enableFileComment&&c.push(P),c.push(L),f.isPro&&f.fileAuditEnabled&&c.push(T),c.push("Divider"),c.push(w),c):"file"===s&&"r"===l?(c=[].concat(r(d)),o.encrypted||c.push(C),f.enableFileComment&&c.push(P),c.push(L),c):[]},n.onTableDragEnter=function(e){if(h.Utils.isIEBrower())return!1;if(0!==++n.enteredCounter){if(n.state.isListDropTipShow)return;n.setState({isListDropTipShow:!0})}},n.onTableDragOver=function(e){if(h.Utils.isIEBrower())return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onTableDragLeave=function(e){if(h.Utils.isIEBrower())return!1;0===--n.enteredCounter&&n.setState({isListDropTipShow:!1})},n.tableDrop=function(e){if(h.Utils.isIEBrower())return!1;if(e.persist(),n.enteredCounter=0,n.setState({isListDropTipShow:!1}),!e.dataTransfer.files.length){var t=e.dataTransfer.getData("applicaiton/drag-item-info");t=JSON.parse(t);var a=t,r=a.nodeDirent,o=a.nodeParentPath,i=a.nodeRootPath;Array.isArray(t)||i!==n.props.path&&o!==n.props.path&&-1===n.props.path.indexOf(i)&&n.props.onItemMove(n.props.currentRepoInfo,r,n.props.path,o)}},n.onShowDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!0})},n.onHideDirentsDraggablePreview=function(){n.setState({isShowDirentsDraggablePreview:!1})},n.state={isItemFreezed:!1,isImagePopupOpen:!1,imageItems:[],imageIndex:0,fileType:"",isCreateFileDialogShow:!1,isCreateFolderDialogShow:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isProgressDialogShow:!1,progress:0,isMutipleOperation:!0,activeDirent:null,isListDropTipShow:!1,isShowDirentsDraggablePreview:!1},n.enteredCounter=0,n.isRepoOwner=e.currentRepoInfo.owner_email===f.username,n.isAdmin=e.currentRepoInfo.is_admin,n.repoEncrypted=e.currentRepoInfo.encrypted,n.clickedDirent=null,n.direntItems=[],n.currentItemRef=null,n.zipToken=null,n}return s(t,e),l(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.direntList,a=t.sortBy,r=t.sortOrder;if(this.props.isDirentListLoading)return c.default.createElement(S.default,null);var o="name"==a,i="time"==a,s="size"==a,l="asc"==r?c.default.createElement("span",{className:"fas fa-caret-up"}):c.default.createElement("span",{className:"fas fa-caret-down"});return c.default.createElement("div",{className:"table-container "+(this.state.isListDropTipShow?"table-drop-active":""),onMouseDown:this.onContainerMouseDown,onContextMenu:this.onContainerContextMenu,onClick:this.onContainerClick,onDragEnter:this.onTableDragEnter,onDragOver:this.onTableDragOver,onDragLeave:this.onTableDragLeave,onDrop:this.tableDrop},c.default.createElement("table",null,c.default.createElement("thead",{onMouseDown:this.onThreadMouseDown,onContextMenu:this.onThreadContextMenu},c.default.createElement("tr",null,c.default.createElement("th",{width:"3%",className:"pl10"},c.default.createElement("input",{type:"checkbox",className:"vam",onChange:this.props.onAllItemSelected,checked:this.props.isAllItemSelected})),c.default.createElement("th",{width:"3%",className:"pl10"}),c.default.createElement("th",{width:"5%",className:"pl10"}),c.default.createElement("th",{width:"39%"},c.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByName},(0,f.gettext)("Name")," ",o&&l)),c.default.createElement("th",{width:"6%"}),c.default.createElement("th",{width:"18%"}),c.default.createElement("th",{width:"11%"},c.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortBySize},(0,f.gettext)("Size")," ",s&&l)),c.default.createElement("th",{width:"15%"},c.default.createElement("a",{className:"d-block table-sort-op",href:"#",onClick:this.sortByTime},(0,f.gettext)("Last Update")," ",i&&l)))),c.default.createElement("tbody",null,n.map(function(t,n){return c.default.createElement(J.default,{ref:e.setDirentItemRef(n),key:n,dirent:t,path:e.props.path,repoID:e.props.repoID,currentRepoInfo:e.props.currentRepoInfo,isAdmin:e.isAdmin,isRepoOwner:e.isRepoOwner,repoEncrypted:e.repoEncrypted,enableDirPrivateShare:e.props.enableDirPrivateShare,isGroupOwnedRepo:e.props.isGroupOwnedRepo,onItemClick:e.props.onItemClick,onItemRenameToggle:e.onItemRenameToggle,onItemSelected:e.onItemSelected,onItemDelete:e.props.onItemDelete,onItemRename:e.onItemRename,onItemMove:e.props.onItemMove,onItemCopy:e.props.onItemCopy,updateDirent:e.props.updateDirent,isItemFreezed:e.state.isItemFreezed,freezeItem:e.freezeItem,unfreezeItem:e.unfreezeItem,onDirentClick:e.onDirentClick,showImagePopup:e.showImagePopup,onItemMouseDown:e.onItemMouseDown,onItemContextMenu:e.onItemContextMenu,selectedDirentList:e.props.selectedDirentList,activeDirent:e.state.activeDirent,onFileTagChanged:e.props.onFileTagChanged,getDirentItemMenuList:e.getDirentItemMenuList,showDirentDetail:e.props.showDirentDetail,onItemsMove:e.props.onItemsMove,onShowDirentsDraggablePreview:e.onShowDirentsDraggablePreview})}))),c.default.createElement(u.Fragment,null,c.default.createElement(H.default,{id:"dirent-container-menu",onMenuItemClick:this.onContainerMenuItemClick}),c.default.createElement(H.default,{id:"dirent-item-menu",onMenuItemClick:this.onMenuItemClick,onShowMenu:this.onShowMenu,onHideMenu:this.onHideMenu}),c.default.createElement(H.default,{id:"dirents-menu",onMenuItemClick:this.onDirentsMenuItemClick}),this.state.isShowDirentsDraggablePreview&&c.default.createElement(P.default,null,c.default.createElement(j.default,{selectedDirentList:this.props.selectedDirentList,onHideDirentsDraggablePreview:this.onHideDirentsDraggablePreview,dragStartPosition:this.state.dragStartPosition})),this.state.isImagePopupOpen&&c.default.createElement(P.default,null,c.default.createElement(k.default,{imageItems:this.state.imageItems,imageIndex:this.state.imageIndex,closeImagePopup:this.closeImagePopup,moveToPrevImage:this.moveToPrevImage,moveToNextImage:this.moveToNextImage})),this.state.isCreateFolderDialogShow&&c.default.createElement(P.default,null,c.default.createElement(M.default,{parentPath:this.props.path,onAddFolder:this.onAddFolder,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onCreateFolderToggle})),this.state.isCreateFileDialogShow&&c.default.createElement(P.default,null,c.default.createElement(T.default,{parentPath:this.props.path,fileType:this.state.fileType,onAddFile:this.onAddFile,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onCreateFileToggle})),this.state.isMoveDialogShow&&c.default.createElement(R.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,isMutipleOperation:this.state.isMutipleOperation,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onCancelMove:this.onMoveToggle}),this.state.isCopyDialogShow&&c.default.createElement(F.default,{path:this.props.path,repoID:this.props.repoID,repoEncrypted:this.props.currentRepoInfo.encrypted,selectedDirentList:this.props.selectedDirentList,isMutipleOperation:this.state.isMutipleOperation,onItemsCopy:this.props.onItemsCopy,onCancelCopy:this.onCopyToggle}),this.state.isProgressDialogShow&&c.default.createElement(N.default,{progress:this.state.progress,onCancelDownload:this.onCancelDownload})))}}]),t}(c.default.Component);A.propTypes=G,t.default=A},1071:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(598),f=a(p),h=n(6),m=n(2),g=n(3),v=n(4),y=n(240),b=a(y),C=n(322),S=a(C),w=n(599),D=a(w),E=n(24),P=a(E),L=n(324),T=a(L),Y=n(325),M=a(Y),_=n(108),k=a(_),Z=n(314),N=a(Z),I=n(290),R=a(I),O=n(600),F=a(O);n(1076);var X=n(5),J=a(X),x={path:d.default.string.isRequired,repoID:d.default.string.isRequired,isItemFreezed:d.default.bool.isRequired,dirent:d.default.object.isRequired,onItemClick:d.default.func.isRequired,freezeItem:d.default.func.isRequired,unfreezeItem:d.default.func.isRequired,onItemRenameToggle:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onDirentClick:d.default.func.isRequired,updateDirent:d.default.func.isRequired,showImagePopup:d.default.func.isRequired,currentRepoInfo:d.default.object,isRepoOwner:d.default.bool,isAdmin:d.default.bool.isRequired,repoEncrypted:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,onItemMouseDown:d.default.func.isRequired,onItemContextMenu:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,activeDirent:d.default.object,getDirentItemMenuList:d.default.func.isRequired,onFileTagChanged:d.default.func,enableDirPrivateShare:d.default.bool.isRequired,showDirentDetail:d.default.func.isRequired,onItemsMove:d.default.func.isRequired,onShowDirentsDraggablePreview:d.default.func},H=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.setState({isDragTipShow:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({highlight:!0,isOperationShow:!0}),n.setState({isDragTipShow:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({highlight:!1,isOperationShow:!1}),n.setState({isDragTipShow:!1})},n.unfreezeItem=function(){n.setState({highlight:!1,isOperationShow:!1}),n.props.unfreezeItem()},n.onItemSelected=function(){n.props.onItemSelected(n.props.dirent)},n.onItemStarred=function(){var e=n.props.dirent,t=n.props.repoID,a=n.getDirentPath(e);e.starred?v.seafileAPI.unstarItem(t,a).then(function(){n.props.updateDirent(n.props.dirent,"starred",!1)}).catch(function(e){var t=g.Utils.getErrorMsg(e);J.default.danger(t)}):v.seafileAPI.starItem(t,a).then(function(){n.props.updateDirent(n.props.dirent,"starred",!0)}).catch(function(e){var t=g.Utils.getErrorMsg(e);J.default.danger(t)})},n.onDirentClick=function(e){e.stopPropagation(),"TD"==e.target.tagName&&n.props.onDirentClick(n.props.dirent)},n.onItemClick=function(e){e.preventDefault();var t=n.props.dirent;g.Utils.imageCheck(t.name)?n.props.showImagePopup(t):n.props.onItemClick(t)},n.onItemDelete=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onItemDelete(n.props.dirent)},n.onItemShare=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.closeSharedDialog=function(){n.setState({isShareDialogShow:!n.state.isShareDialogShow})},n.onMenuItemClick=function(e,t){switch(e){case"Download":n.onItemDownload(t);break;case"Share":n.onItemShare(t);break;case"Delete":n.onItemDelete(t);break;case"Rename":n.onItemRenameToggle();break;case"Move":n.onItemMoveToggle();break;case"Copy":n.onItemCopyToggle();break;case"Tags":n.onEditFileTagToggle();break;case"Permission":n.onPermissionItem();break;case"Unlock":n.onUnlockItem();break;case"Lock":n.onLockItem();break;case"Comment":n.props.onDirentClick(n.props.dirent),n.props.showDirentDetail("comments");break;case"History":n.onHistory();break;case"Access Log":n.onAccessLog();break;case"Open via Client":n.onOpenViaClient()}},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.getDirentPath(n.props.dirent);n.props.onFileTagChanged(n.props.dirent,e)},n.onItemRenameToggle=function(){n.props.onItemRenameToggle(n.props.dirent),n.setState({isOperationShow:!1,isRenameing:!0})},n.onRenameConfirm=function(e){n.props.onItemRename(n.props.dirent,e),n.onRenameCancel()},n.onRenameCancel=function(){n.setState({isRenameing:!1}),n.unfreezeItem()},n.onItemMoveToggle=function(){n.setState({isMoveDialogShow:!n.state.isMoveDialogShow})},n.onItemCopyToggle=function(){n.setState({isCopyDialogShow:!n.state.isCopyDialogShow})},n.onPermissionItem=function(){n.setState({isPermissionDialogOpen:!n.state.isPermissionDialogOpen})},n.onLockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);v.seafileAPI.lockfile(e,t).then(function(){n.props.updateDirent(n.props.dirent,"is_locked",!0),n.props.updateDirent(n.props.dirent,"locked_by_me",!0);var e=m.username.split("@");n.props.updateDirent(n.props.dirent,"lock_owner_name",e[0])}).catch(function(e){var t=g.Utils.getErrorMsg(e);J.default.danger(t)})},n.onUnlockItem=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent);v.seafileAPI.unlockfile(e,t).then(function(){n.props.updateDirent(n.props.dirent,"is_locked",!1),n.props.updateDirent(n.props.dirent,"locked_by_me",!1),n.props.updateDirent(n.props.dirent,"lock_owner_name","")}).catch(function(e){var t=g.Utils.getErrorMsg(e);J.default.danger(t)})},n.onHistory=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),a=b.default.getUrl({type:"file_revisions",repoID:e,filePath:t});location.href=a},n.onAccessLog=function(){var e=n.getDirentPath(n.props.dirent),t=m.siteRoot+"repo/file-access/"+n.props.repoID+"/?p="+encodeURIComponent(e);window.open(t)},n.onOpenViaClient=function(){var e=n.props.repoID,t=n.getDirentPath(n.props.dirent),a=b.default.getUrl({type:"open_via_client",repoID:e,filePath:t});location.href=a},n.onItemDownload=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.props.dirent,a=n.props.repoID,r=n.getDirentPath(t);if("dir"===t.type)n.setState({isZipDialogOpen:!0});else{var o=b.default.getUrl({type:"download_file_url",repoID:a,filePath:r});location.href=o}},n.closeZipDialog=function(){n.setState({isZipDialogOpen:!1})},n.getDirentPath=function(e){var t=n.props.path;return"/"===t?t+e.name:t+"/"+e.name},n.onTagTooltipToggle=function(e){e.stopPropagation(),n.setState({isShowTagTooltip:!n.state.isShowTagTooltip})},n.onItemMove=function(e,t,a,r){n.props.onItemMove(e,t,a,r)},n.onItemDragStart=function(e){if(g.Utils.isIEBrower())return!1;e.dataTransfer.effectAllowed="move";var t=n.props.selectedDirentList;if(t.length>0&&t.includes(n.props.dirent)){n.props.onShowDirentsDraggablePreview(),e.dataTransfer.setDragImage(n.refs.empty_content,0,0);var a=t.map(function(e){var t=n.getDirentPath(e);return{nodeDirent:e,nodeParentPath:n.props.path,nodeRootPath:t}});return a=JSON.stringify(a),void e.dataTransfer.setData("applicaiton/drag-item-info",a)}e.dataTransfer&&e.dataTransfer.setDragImage&&e.dataTransfer.setDragImage(n.refs.drag_icon,15,15);var r=n.getDirentPath(n.props.dirent),o={nodeDirent:n.props.dirent,nodeParentPath:n.props.path,nodeRootPath:r};o=JSON.stringify(o),e.dataTransfer.setData("applicaiton/drag-item-info",o)},n.onItemDragEnter=function(e){if(g.Utils.isIEBrower())return!1;"dir"===n.props.dirent.type&&(e.stopPropagation(),n.setState({isDropTipshow:!0}))},n.onItemDragOver=function(e){if(g.Utils.isIEBrower())return!1;"copy"!==e.dataTransfer.dropEffect&&(e.preventDefault(),e.dataTransfer.dropEffect="move")},n.onItemDragLeave=function(e){if(g.Utils.isIEBrower())return!1;"dir"===n.props.dirent.type&&e.stopPropagation(),n.setState({isDropTipshow:!1})},n.onItemDragDrop=function(e){if(g.Utils.isIEBrower())return!1;if(n.setState({isDropTipshow:!1}),!e.dataTransfer.files.length&&"dir"===n.props.dirent.type){e.stopPropagation();var t=e.dataTransfer.getData("applicaiton/drag-item-info");if(t=JSON.parse(t),Array.isArray(t)){var a=t.map(function(e){return e.nodeRootPath}),r=g.Utils.joinPath(n.props.path,n.props.dirent.name);if(a.some(function(e){return e===r}))return;return void n.props.onItemsMove(n.props.currentRepoInfo,r)}var o=t,i=o.nodeDirent,s=o.nodeParentPath,l=o.nodeRootPath,u=n.props.dirent;if(i.name!==u.name&&("dir"!==u.type||"dir"!==i.type||s===n.props.path||-1===n.props.path.indexOf(l))){var c=g.Utils.joinPath(n.props.path,n.props.dirent.name);n.onItemMove(n.props.currentRepoInfo,i,c,s)}}},n.onItemMouseDown=function(e){n.props.onItemMouseDown(e)},n.onItemContextMenu=function(e){var t=n.props.dirent;n.props.onItemContextMenu(e,t)},n.renderItemOperation=function(){var e=n.props,t=e.dirent,a=e.selectedDirentList,r=e.currentRepoInfo;if("cloud-edit"===r.permission||"preview"===r.permission)return"";var o=g.Utils.isHasPermissionToShare(r,t.permission,t);return u.default.createElement(l.Fragment,null,a.length>1?u.default.createElement(l.Fragment,null,n.state.isOperationShow&&!t.isSelected&&u.default.createElement("div",{className:"operations"},u.default.createElement("ul",{className:"operation-group"},("rw"===t.permission||"r"===t.permission)&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-download",title:(0,m.gettext)("Download"),onClick:n.onItemDownload})),o&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-share",title:(0,m.gettext)("Share"),onClick:n.onItemShare})),"rw"===t.permission&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-delete",title:(0,m.gettext)("Delete"),onClick:n.onItemDelete})),u.default.createElement("li",{className:"operation-group-item"},u.default.createElement(S.default,{item:n.props.dirent,toggleClass:"sf2-icon-caret-down",isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem}))))):u.default.createElement(l.Fragment,null,n.state.isOperationShow&&u.default.createElement("div",{className:"operations"},u.default.createElement("ul",{className:"operation-group"},("rw"===t.permission||"r"===t.permission)&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-download",title:(0,m.gettext)("Download"),onClick:n.onItemDownload})),o&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-share",title:(0,m.gettext)("Share"),onClick:n.onItemShare})),"rw"===t.permission&&u.default.createElement("li",{className:"operation-group-item"},u.default.createElement("i",{className:"op-icon sf2-icon-delete",title:(0,m.gettext)("Delete"),onClick:n.onItemDelete})),u.default.createElement("li",{className:"operation-group-item"},u.default.createElement(S.default,{item:n.props.dirent,toggleClass:"sf2-icon-caret-down",isHandleContextMenuEvent:!0,getMenuList:n.props.getDirentItemMenuList,onMenuItemClick:n.onMenuItemClick,unfreezeItem:n.unfreezeItem,freezeItem:n.props.freezeItem}))))))},n.state={isOperationShow:!1,highlight:!1,isZipDialogOpen:!1,isMoveDialogShow:!1,isCopyDialogShow:!1,isShareDialogShow:!1,isMutipleOperation:!1,isShowTagTooltip:!1,isDragTipShow:!1,isDropTipshow:!1,isEditFileTagShow:!1,isPermissionDialogOpen:!1},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.isItemFreezed||this.setState({highlight:!1,isOperationShow:!1},function(){e.activeDirent&&e.activeDirent.name===e.dirent.name&&t.setState({isOperationShow:!0})})}},{key:"render",value:function(){var e=this.props,t=e.path,n=e.dirent,a=e.activeDirent,r=g.Utils.joinPath(t,n.name),o="";this.props.currentRepoInfo&&(o=m.siteRoot+"library/"+this.props.repoID+"/"+this.props.currentRepoInfo.repo_name+g.Utils.encodePath(r));var i=m.siteRoot+"lib/"+this.props.repoID+"/file"+g.Utils.encodePath(r),s="",c="";n.file_tags&&n.file_tags.length>0&&(s=(0,f.default)(n.name).slice(0,7),c=n.file_tags.map(function(e){return e.name}).join(" "));var d=g.Utils.getDirentIcon(n),p=this.state.highlight?"tr-highlight ":"";p+=this.state.isDropTipshow?"tr-drop-effect":"",p+=a&&a.name===n.name?"tr-active":"",p+=n.isSelected?"tr-active":"";var v=(0,m.gettext)("locked by {name}");return v=v.replace("{name}",n.lock_owner_name),u.default.createElement(l.Fragment,null,u.default.createElement("tr",{className:p,draggable:"true",onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onClick:this.onDirentClick,onDragStart:this.onItemDragStart,onDragEnter:this.onItemDragEnter,onDragOver:this.onItemDragOver,onDragLeave:this.onItemDragLeave,onDrop:this.onItemDragDrop,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu},u.default.createElement("td",{className:"pl10 "+(this.state.isDragTipShow?"tr-drag-effect":"")},u.default.createElement("input",{type:"checkbox",className:"vam",onChange:this.onItemSelected,checked:n.isSelected})),u.default.createElement("td",{className:"pl10"},void 0!==n.starred&&!n.starred&&u.default.createElement("i",{className:"far fa-star star-empty cursor-pointer",onClick:this.onItemStarred}),void 0!==n.starred&&n.starred&&u.default.createElement("i",{className:"fas fa-star cursor-pointer",onClick:this.onItemStarred})),u.default.createElement("td",{className:"pl10"},u.default.createElement("div",{className:"dir-icon"},n.encoded_thumbnail_src?u.default.createElement("img",{ref:"drag_icon",src:""+m.siteRoot+n.encoded_thumbnail_src,className:"thumbnail cursor-pointer",onClick:this.onItemClick,alt:""}):u.default.createElement("img",{ref:"drag_icon",src:d,width:"24",alt:""}),n.is_locked&&u.default.createElement("img",{className:"locked",src:m.mediaUrl+"img/file-locked-32.png",alt:(0,m.gettext)("locked"),title:v}),u.default.createElement("div",{ref:"empty_content",style:{position:"absolute",width:"1px",height:"1px"}}))),u.default.createElement("td",{className:"name"},this.state.isRenameing?u.default.createElement(D.default,{hasSuffix:"dir"!==n.type,name:n.name,onRenameConfirm:this.onRenameConfirm,onRenameCancel:this.onRenameCancel}):u.default.createElement("a",{href:"dir"===n.type?o:i,onClick:this.onItemClick},n.name)),u.default.createElement("td",{className:"tag-list-title"},"dir"!==n.type&&n.file_tags&&n.file_tags.length>0&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{id:"tag-list-title-"+s,className:"dirent-item tag-list tag-list-stacked"},n.file_tags.map(function(e,t){var a=n.file_tags.length;return u.default.createElement("span",{className:"file-tag",key:e.id,style:{zIndex:a-t,backgroundColor:e.color}})})),u.default.createElement(h.UncontrolledTooltip,{target:"tag-list-title-"+s,placement:"bottom"},c))),u.default.createElement("td",{className:"operation"},this.renderItemOperation()),u.default.createElement("td",{className:"file-size"},n.size&&n.size),u.default.createElement("td",{className:"last-update"},n.mtime_relative)),this.state.isMoveDialogShow&&u.default.createElement(P.default,null,u.default.createElement(T.default,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMutipleOperation:this.state.isMutipleOperation,onItemMove:this.props.onItemMove,onCancelMove:this.onItemMoveToggle,repoEncrypted:this.props.repoEncrypted})),this.state.isCopyDialogShow&&u.default.createElement(P.default,null,u.default.createElement(M.default,{path:this.props.path,repoID:this.props.repoID,dirent:this.props.dirent,isMutipleOperation:this.state.isMutipleOperation,onItemCopy:this.props.onItemCopy,onCancelCopy:this.onItemCopyToggle,repoEncrypted:this.props.repoEncrypted})),this.state.isEditFileTagShow&&u.default.createElement(R.default,{repoID:this.props.repoID,fileTagList:n.file_tags,filePath:r,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged}),this.state.isZipDialogOpen&&u.default.createElement(P.default,null,u.default.createElement(N.default,{repoID:this.props.repoID,path:this.props.path,target:this.props.dirent.name,toggleDialog:this.closeZipDialog})),this.state.isShareDialogShow&&u.default.createElement(P.default,null,u.default.createElement(k.default,{itemType:n.type,itemName:n.name,itemPath:r,userPerm:n.permission,repoID:this.props.repoID,repoEncrypted:!1,enableDirPrivateShare:this.props.enableDirPrivateShare,isGroupOwnedRepo:this.props.isGroupOwnedRepo,toggleDialog:this.closeSharedDialog})),this.state.isPermissionDialogOpen&&u.default.createElement(P.default,null,u.default.createElement(F.default,{toggleDialog:this.onPermissionItem,repoID:this.props.repoID,folderPath:r,folderName:n.name,isDepartmentRepo:this.props.isGroupOwnedRepo})))}}]),t}(u.default.Component);H.propTypes=x,t.default=H},1072:function(e,t){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,a=0;n<e.length;n++,a+=8)t[a>>>5]|=e[n]<<24-a%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],a=0;a<e.length;a+=3)for(var r=e[a]<<16|e[a+1]<<8|e[a+2],o=0;o<4;o++)8*a+6*o<=8*e.length?n.push(t.charAt(r>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],a=0,r=0;a<e.length;r=++a%4)0!=r&&n.push((t.indexOf(e.charAt(a-1))&Math.pow(2,-2*r+8)-1)<<2*r|t.indexOf(e.charAt(a))>>>6-2*r);return n}};e.exports=n}()},1073:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(6),h=n(4),m=n(3),g=n(57),v=a(g),y=n(81),b=a(y),C=n(52),S=a(C),w=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteUserFolderPermission=function(){var e=n.props.item;n.props.deleteUserFolderPermission(e)},n.onChangeUserFolderPerm=function(e){var t=n.props.item;n.props.onChangeUserFolderPerm(t.repo_id,e,t.folder_path,t.user_email)},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.permission;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("a",{href:p.siteRoot+"profile/"+encodeURIComponent(e.user_email)+"/",target:"_blank"},e.user_name)),this.props.showPath&&u.default.createElement("td",null,u.default.createElement("a",{href:p.siteRoot+"library/"+e.repo_id+"/"+m.Utils.encodePath(this.props.repoName+e.folder_path)},e.folder_name)),u.default.createElement("td",null,u.default.createElement(b.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserFolderPerm})),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteUserFolderPermission,title:(0,p.gettext)("Delete")})))}}]),t}(u.default.Component),D={repoID:d.default.string.isRequired,isDepartmentRepo:d.default.bool},E=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleUserSelectChange=function(e){n.setState({selectedUsers:e})},n.setPermission=function(e){n.setState({permission:e})},n.addUserFolderPerm=function(){var e=n.state.selectedUsers,t=n.props.folderPath||n.state.folderPath;if(!e||!e.length||!t)return!1;var a=e.map(function(e,t){return e.email});(n.props.isDepartmentRepo?h.seafileAPI.addDepartmentRepoUserFolderPerm(n.props.repoID,n.state.permission,t,a):h.seafileAPI.addUserFolderPerm(n.props.repoID,n.state.permission,t,a)).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];n.setState({errorMsg:t,userFolderPermItems:n.state.userFolderPermItems.concat(e.data.success),selectedUsers:null,permission:"rw",folderPath:""}),n.refs.userSelect.clearSelect()}).catch(function(e){var t="";t=e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,p.gettext)("Error"):(0,p.gettext)("Please check the network."),n.setState({errorMsg:[t]})})},n.deleteUserFolderPermItem=function(e){(n.props.isDepartmentRepo?h.seafileAPI.deleteDepartmentRepoUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email):h.seafileAPI.deleteUserFolderPerm(e.repo_id,e.permission,e.folder_path,e.user_email)).then(function(t){n.setState({userFolderPermItems:n.state.userFolderPermItems.filter(function(t){return t!=e})})})},n.onChangeUserFolderPerm=function(e,t,a,r){(n.props.isDepartmentRepo?h.seafileAPI.updateDepartmentRepoUserFolderPerm(e,t,a,r):h.seafileAPI.updateUserFolderPerm(e,t,a,r)).then(function(e){var o=n.state.userFolderPermItems.map(function(e){return e.user_email===r&&e.folder_path===a&&(e.permission=t),e});n.setState({userFolderPermItems:o})})},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,a){n.setState({folderPath:t})},n.handleFileChooserSubmit=function(){n.setState({showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedUsers:null,errorMsg:[],permission:"rw",userFolderPermItems:[],folderPath:"",showFileChooser:!1},p.isPro?n.permissions=["r","rw","cloud-edit","preview"]:n.permissions=["r","rw"],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,a=t.folderPath;(t.isDepartmentRepo?h.seafileAPI.listDepartmentRepoUserFolderPerm(n,a):h.seafileAPI.listUserFolderPerm(n,a)).then(function(t){0!==t.data.length&&e.setState({userFolderPermItems:t.data})})}},{key:"render",value:function(){var e=this,t=!this.props.folderPath,n=this.state.userFolderPermItems;return this.state.showFileChooser?u.default.createElement("div",null,u.default.createElement(S.default,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),u.default.createElement("div",{className:"modal-footer"},u.default.createElement(f.Button,{color:"secondary",onClick:this.toggleFileChooser},(0,p.gettext)("Cancel")),u.default.createElement(f.Button,{color:"primary",onClick:this.handleFileChooserSubmit},(0,p.gettext)("Submit")))):u.default.createElement(l.Fragment,null,u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:t?"32%":"55%"},(0,p.gettext)("User")),t&&u.default.createElement("th",{width:"32%"},(0,p.gettext)("Folder")),u.default.createElement("th",{width:t?"26%":"30%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:t?"10%":"15%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(v.default,{ref:"userSelect",isMulti:!0,className:"reviewer-select",placeholder:(0,p.gettext)("Select users..."),onSelectChange:this.handleUserSelectChange,value:this.state.selectedUsers})),t&&u.default.createElement("td",null,u.default.createElement(f.InputGroup,null,u.default.createElement(f.Input,{value:this.state.folderPath,onChange:this.onSetSubFolder}),u.default.createElement(f.InputGroupAddon,{addonType:"append"},u.default.createElement(f.Button,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})))),u.default.createElement("td",null,u.default.createElement(b.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),u.default.createElement("td",null,u.default.createElement(f.Button,{onClick:this.addUserFolderPerm},(0,p.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n="";return n=e.user_email?e.user_email+": "+e.error_msg:e,u.default.createElement("tr",{key:t},u.default.createElement("td",{colSpan:3},u.default.createElement("p",{className:"error"},n)))}))),u.default.createElement("div",{className:"share-list-container"},u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:t?"32%":"55%"},(0,p.gettext)("User")),t&&u.default.createElement("th",{width:"32%"},(0,p.gettext)("Folder")),u.default.createElement("th",{width:t?"26%":"30%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:t?"10%":"15%"}))),u.default.createElement("tbody",null,n.map(function(n,a){return u.default.createElement(w,{key:a,item:n,permissions:e.permissions,deleteUserFolderPermission:e.deleteUserFolderPermItem,onChangeUserFolderPerm:e.onChangeUserFolderPerm,showPath:t,repoName:e.props.repoName})})))))}}]),t}(u.default.Component);E.propTypes=D,t.default=E},1074:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),p=n(1),f=a(p),h=n(6),m=n(96),g=a(m),v=n(223),y=a(v),b=n(2),C=n(4),S=n(3),w=n(81),D=a(w),E=n(52),P=a(E),L=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteGroupPermissionItem=function(){var e=n.props.item;n.props.deleteGroupPermissionItem(e)},n.onChangeGroupPermission=function(e){var t=n.props.item;n.props.onChangeGroupPermission(t,e)},n.state={isOperationShow:!1},n}return s(t,e),u(t,[{key:"render",value:function(){var e=this.props.item;return d.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},d.default.createElement("td",null,d.default.createElement("a",{href:b.siteRoot+"group/"+e.group_id+"/",target:"_blank"},e.group_name)),this.props.showPath&&d.default.createElement("td",null,d.default.createElement("a",{href:b.siteRoot+"library/"+e.repo_id+"/"+S.Utils.encodePath(this.props.repoName+e.folder_path)},e.folder_name)),d.default.createElement("td",null,d.default.createElement(D.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:e.permission,permissions:this.props.permissions,onPermissionChanged:this.onChangeGroupPermission})),d.default.createElement("td",null,d.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteGroupPermissionItem,title:(0,b.gettext)("Delete")})))}}]),t}(d.default.Component),T={repoID:f.default.string.isRequired,isDepartmentRepo:f.default.bool},Y=function(e){return d.default.createElement("div",l({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,b.gettext)("Group not found"))},M=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){C.seafileAPI.shareableGroups().then(function(e){n.options=e.data.map(function(e,t){return{id:e.id,label:e.name,value:e.name}})})},n.listGroupPermissionItems=function(){var e=n.props,t=e.isDepartmentRepo,a=e.repoID,r=e.folderPath;(t?C.seafileAPI.listDepartmentRepoGroupFolderPerm(a,r):C.seafileAPI.listGroupFolderPerm(a,r)).then(function(e){0!==e.data.length&&n.setState({groupPermissionItems:e.data})})},n.setPermission=function(e){n.setState({permission:e})},n.addGroupFolderPerm=function(){var e=n.state.selectedOption,t=n.props.folderPath||n.state.folderPath;if(!e||!t)return!1;(n.props.isDepartmentRepo?C.seafileAPI.addDepartmentRepoGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id):C.seafileAPI.addGroupFolderPerm(n.props.repoID,n.state.permission,t,e.id)).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];n.setState({errorMsg:t,groupPermissionItems:n.state.groupPermissionItems.concat(e.data.success),selectedOption:null,permission:"rw",folderPath:""})}).catch(function(e){var t="";t=e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,b.gettext)("Error"):(0,b.gettext)("Please check the network."),n.setState({errorMsg:[t]})})},n.deleteGroupPermissionItem=function(e){(n.props.isDepartmentRepo?C.seafileAPI.deleteDepartmentRepoGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id):C.seafileAPI.deleteGroupFolderPerm(e.repo_id,e.permission,e.folder_path,e.group_id)).then(function(){n.setState({groupPermissionItems:n.state.groupPermissionItems.filter(function(t){return t!=e})})})},n.onChangeGroupPermission=function(e,t){(n.props.isDepartmentRepo?C.seafileAPI.updateDepartmentRepoGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id):C.seafileAPI.updateGroupFolderPerm(e.repo_id,t,e.folder_path,e.group_id)).then(function(){n.updateGroupPermission(e,t)})},n.updateGroupPermission=function(e,t){var a=e.group_id,r=n.state.groupPermissionItems.map(function(n){var r=n.group_id;return a===r&&e.folder_path===n.folder_path&&(n.permission=t),n});n.setState({groupPermissionItems:r})},n.onSetSubFolder=function(e){n.setState({folderPath:e.target.value})},n.toggleFileChooser=function(){n.setState({showFileChooser:!n.state.showFileChooser,folderPath:""})},n.toggleSubFolder=function(e,t,a){n.setState({folderPath:t})},n.handleSubmit=function(){n.setState({showFileChooser:!n.state.showFileChooser})},n.onRepoItemClick=function(){n.setState({folderPath:"/"})},n.state={selectedOption:null,errorMsg:[],permission:"rw",groupPermissionItems:[],folderPath:"",showFileChooser:!1},n.options=[],b.isPro?n.permissions=["r","rw","cloud-edit","preview"]:n.permissions=["r","rw"],n}return s(t,e),u(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listGroupPermissionItems()}},{key:"render",value:function(){var e=this,t=!this.props.folderPath;return this.state.showFileChooser?d.default.createElement("div",null,d.default.createElement(P.default,{repoID:this.props.repoID,mode:"only_current_library",onDirentItemClick:this.toggleSubFolder,onRepoItemClick:this.onRepoItemClick}),d.default.createElement("div",{className:"modal-footer"},d.default.createElement(h.Button,{color:"secondary",onClick:this.toggleFileChooser},(0,b.gettext)("Cancel")),d.default.createElement(h.Button,{color:"primary",onClick:this.handleSubmit},(0,b.gettext)("Submit")))):d.default.createElement(c.Fragment,null,d.default.createElement("table",null,d.default.createElement("thead",null,d.default.createElement("tr",null,d.default.createElement("th",{width:t?"32%":"55%"},(0,b.gettext)("Group")),t&&d.default.createElement("th",{width:"32%"},(0,b.gettext)("Folder")),d.default.createElement("th",{width:t?"26%":"30%"},(0,b.gettext)("Permission")),d.default.createElement("th",{width:t?"10%":"15%"}))),d.default.createElement("tbody",null,d.default.createElement("tr",null,d.default.createElement("td",null,d.default.createElement(g.default,r({onChange:this.handleSelectChange,options:this.options,placeholder:(0,b.gettext)("Select a group"),components:(0,y.default)(),maxMenuHeight:200,inputId:"react-select-2-input",value:this.state.selectedOption},"components",{NoOptionsMessage:Y}))),t&&d.default.createElement("td",null,d.default.createElement(h.InputGroup,null,d.default.createElement(h.Input,{value:this.state.folderPath,onChange:this.onSetSubFolder}),d.default.createElement(h.InputGroupAddon,{addonType:"append"},d.default.createElement(h.Button,{className:"sf2-icon-plus",onClick:this.toggleFileChooser})))),d.default.createElement("td",null,d.default.createElement(D.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),d.default.createElement("td",null,d.default.createElement(h.Button,{onClick:this.addGroupFolderPerm},(0,b.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n=e.group_id+": "+e.error_msg;return d.default.createElement("tr",{key:t},d.default.createElement("td",{colSpan:3},d.default.createElement("p",{className:"error"},n)))}))),d.default.createElement("div",{className:"share-list-container"},d.default.createElement("table",{className:"table-thead-hidden"},d.default.createElement("thead",null,d.default.createElement("tr",null,d.default.createElement("th",{width:t?"32%":"55%"},(0,b.gettext)("Group")),t&&d.default.createElement("th",{width:"32%"},(0,b.gettext)("Folder")),d.default.createElement("th",{width:t?"26%":"30%"},(0,b.gettext)("Permission")),d.default.createElement("th",{width:t?"10%":"15%"}))),d.default.createElement("tbody",null,this.state.groupPermissionItems.map(function(n,a){return d.default.createElement(L,{key:a,item:n,permissions:e.permissions,deleteGroupPermissionItem:e.deleteGroupPermissionItem,onChangeGroupPermission:e.onChangeGroupPermission,showPath:t,repoName:e.props.repoName})})))))}}]),t}(d.default.Component);M.propTypes=T,t.default=M},1075:function(e,t){},1076:function(e,t){},1077:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(3),h={selectedDirentList:d.default.array,onHideDirentsDraggablePreview:d.default.func},m=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.handleDragEnd=function(){a.element.style.opacity=0,a.props.onHideDirentsDraggablePreview()},a.handleDragOver=function(e){if(f.Utils.isIEBrower())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move",a.element.style.top=e.clientY+"px",a.element.style.left=e.clientX+"px"},a.handleDrop=function(e){a.element.style.opacity=0,a.props.onHideDirentsDraggablePreview()},i=n,o(a,i)}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",this.handleDragOver),document.addEventListener("drop",this.handleDrop),document.addEventListener("dragend",this.handleDragEnd)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDrop),document.removeEventListener("dragend",this.handleDragEnd)}},{key:"render",value:function(){var e=this,t=this.props.selectedDirentList,n={position:"absolute",opacity:1,pointerEvents:"none",display:"block",left:"-9999px",top:"-9999px",zIndex:101,maxHeight:document.documentElement.clientHeight,overflow:"hidden"};return u.default.createElement("div",{style:n,ref:function(t){return e.element=t}},t.map(function(e,t){var n=f.Utils.getDirentIcon(e);return u.default.createElement("div",{key:t},e.encoded_thumbnail_src?u.default.createElement("img",{src:""+p.siteRoot+e.encoded_thumbnail_src,className:"thumbnail cursor-pointer",alt:""}):u.default.createElement("img",{src:n,width:"24",alt:""}))}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},1078:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(10),f=a(p),h=n(6),m=n(1079),g=a(m),v=n(2),y=n(4),b=n(3),C=n(5),S=a(C),w=n(43),D=a(w),E=n(1080),P=a(E),L=n(71),T=a(L);n(313);var Y={repoID:d.default.string.isRequired,dirent:d.default.object,path:d.default.string.isRequired,currentRepoInfo:d.default.object.isRequired,onItemDetailsClose:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired,direntDetailPanelTab:d.default.string},M=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.loadDirentInfo=function(e,t,a){if(e){var r=b.Utils.joinPath(t,e.name);n.updateDetailView(e,r)}else{var o=b.Utils.getDirName(t);y.seafileAPI.listDir(a,o).then(function(e){for(var a=e.data.dirent_list,r=null,o=0;o<a.length;o++){var i=a[o];if(i.parent_dir+i.name===t){r=new D.default(i);break}}n.setState({folderDirent:r}),n.updateDetailView(r,t)}).catch(function(e){var t=b.Utils.getErrorMsg(e);S.default.danger(t)})}},n.updateDetailView=function(e,t){var a=n.props.repoID;"file"===e.type?(y.seafileAPI.getFileInfo(a,t).then(function(e){n.setState({direntType:"file",direntDetail:e.data})}).catch(function(e){var t=b.Utils.getErrorMsg(e);S.default.danger(t)}),y.seafileAPI.listFileTags(a,t).then(function(e){var t=[];e.data.file_tags.forEach(function(e){var n=new T.default(e);t.push(n)}),n.setState({fileTagList:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);S.default.danger(t)}),y.seafileAPI.listRelatedFiles(a,t).then(function(e){var t=[];e.data.related_files.map(function(e){t.push(e)}),n.setState({relatedFiles:t})}).catch(function(e){500===e.response.status&&n.setState({relatedFiles:[]})}),n.listParticipants(a,t)):y.seafileAPI.getDirInfo(a,t).then(function(e){n.setState({direntType:"dir",direntDetail:e.data})}).catch(function(e){var t=b.Utils.getErrorMsg(e);S.default.danger(t)})},n.listParticipants=function(e,t){y.seafileAPI.listFileParticipants(e,t).then(function(e){n.setState({fileParticipantList:e.data.participant_list})})},n.onParticipantsChange=function(e,t){n.listParticipants(e,t)},n.onRelatedFileChange=function(e,t){n.updateDetailView(e,t)},n.tabItemClick=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderNavItem=function(e){switch(e){case"info":return u.default.createElement(h.NavItem,{className:"nav-item w-50"},u.default.createElement(h.NavLink,{className:(0,f.default)({active:"info"===n.state.activeTab}),onClick:function(){n.tabItemClick("info")}},u.default.createElement("i",{className:"fas fa-info-circle"})));case"comments":return u.default.createElement(h.NavItem,{className:"nav-item w-50"},u.default.createElement(h.NavLink,{className:(0,f.default)({active:"comments"===n.state.activeTab}),onClick:function(){n.tabItemClick("comments")}},u.default.createElement("i",{className:"fa fa-comments"})))}},n.renderHeader=function(e,t){return u.default.createElement("div",{className:"detail-header"},u.default.createElement("div",{className:"detail-control sf2-icon-x1",onClick:n.props.onItemDetailsClose}),u.default.createElement("div",{className:"detail-title dirent-title"},u.default.createElement("img",{src:e,width:"24",height:"24",alt:""})," ",u.default.createElement("span",{className:"name ellipsis",title:t},t)))},n.renderDetailBody=function(e,t){return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"detail-body dirent-info"},u.default.createElement("div",{className:"img"},u.default.createElement("img",{src:e,className:"thumbnail",alt:""})),n.state.direntDetail&&u.default.createElement("div",{className:"dirent-table-container"},u.default.createElement(P.default,{repoInfo:n.props.currentRepoInfo,path:n.props.path,repoID:n.props.repoID,dirent:n.props.dirent||t,direntType:n.state.direntType,direntDetail:n.state.direntDetail,fileTagList:n.state.fileTagList,relatedFiles:n.state.relatedFiles,onFileTagChanged:n.props.onFileTagChanged,onRelatedFileChange:n.onRelatedFileChange,fileParticipantList:n.state.fileParticipantList,onParticipantsChange:n.onParticipantsChange}))))},n.state={direntType:"",direntDetail:"",fileTagList:[],relatedFiles:[],folderDirent:null,activeTab:"info",fileParticipantList:[]},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.props.direntDetailPanelTab&&this.tabItemClick(this.props.direntDetailPanelTab)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.dirent,n=e.path,a=e.repoID;this.loadDirentInfo(t,n,a)}},{key:"componentWillReceiveProps",value:function(e){var t=e.dirent,n=e.path,a=e.repoID;this.props.dirent!==e.dirent&&this.loadDirentInfo(t,n,a),this.props.direntDetailPanelTab&&this.tabItemClick(this.props.direntDetailPanelTab)}},{key:"render",value:function(){var e=this.props,t=e.dirent,n=e.repoID,a=e.path,r=this.state.folderDirent;if(!t&&!r)return"";var o=t?b.Utils.getDirentIcon(t):b.Utils.getDirentIcon(r),i=t?b.Utils.getDirentIcon(t,!0):b.Utils.getDirentIcon(r,!0);(t?b.Utils.imageCheck(t.name):b.Utils.imageCheck(r.name))&&(i=v.siteRoot+"thumbnail/"+n+"/1024"+b.Utils.encodePath(("/"===a?"":a)+"/"+t.name));var s=t?t.name:r.name;return t&&"file"===t.type||a.lastIndexOf(".")>-1?u.default.createElement("div",{className:"detail-container"},this.renderHeader(o,s),u.default.createElement(h.Nav,{tabs:!0,className:"mx-0"},this.renderNavItem("info"),this.renderNavItem("comments")),u.default.createElement(h.TabContent,{activeTab:this.state.activeTab},u.default.createElement(h.TabPane,{tabId:"info"},this.renderDetailBody(i,r)),u.default.createElement(h.TabPane,{tabId:"comments",className:"comments h-100"},u.default.createElement(g.default,{repoID:this.props.repoID,filePath:t&&"file"===t.type?b.Utils.joinPath(a,t.name):a,fileParticipantList:this.state.fileParticipantList,onParticipantsChange:this.onParticipantsChange})))):u.default.createElement("div",{className:"detail-container"},this.renderHeader(o,s),this.renderDetailBody(i,r))}}]),t}(u.default.Component);M.propTypes=Y,t.default=M},1079:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(9),f=a(p),h=n(167),m=n(6),g=n(2),v=n(4),y=n(3),b=n(5),C=a(b),S=n(229),w=a(S),D=n(319),E=n(296);n(297);var P={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,onParticipantsChange:d.default.func.isRequired,fileParticipantList:d.default.array.isRequired},L=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleCommentChange=function(e){n.setState({comment:e.target.value})},n.listComments=function(e){v.seafileAPI.listComments(n.props.repoID,e||n.props.filePath).then(function(e){n.setState({commentsList:e.data.comments})}).catch(function(e){var t=y.Utils.getErrorMsg(e);C.default.danger(t)})},n.addComment=function(){var e=n.props,t=e.repoID,a=e.filePath;n.state.comment.trim()&&(v.seafileAPI.postComment(t,a,n.state.comment.trim()).then(function(){n.listComments()}).catch(function(e){C.default.danger(y.Utils.getErrorMsg(e))}),n.setState({comment:""}))},n.onSubmit=function(){if(n.addParticipant(g.username),0===n.toBeAddedParticipant.length)n.addComment();else{var e=n.props,t=e.repoID,a=e.filePath;v.seafileAPI.addFileParticipants(t,a,n.toBeAddedParticipant).then(function(e){n.props.onParticipantsChange(t,a),n.toBeAddedParticipant=[],n.addComment()}).catch(function(e){C.default.danger(y.Utils.getErrorMsg(e))})}},n.resolveComment=function(e){var t=n.props.repoID;v.seafileAPI.updateComment(t,e.target.id,"true").then(function(){n.listComments()}).catch(function(e){var t=y.Utils.getErrorMsg(e);C.default.danger(t)})},n.deleteComment=function(e){var t=n.props.repoID;v.seafileAPI.deleteComment(t,e.target.id).then(function(){n.listComments()}).catch(function(e){var t=y.Utils.getErrorMsg(e);C.default.danger(t)})},n.editComment=function(e,t){var a=n.props.repoID;v.seafileAPI.updateComment(a,e,null,null,t).then(function(){n.listComments()}).catch(function(e){var t=y.Utils.getErrorMsg(e);C.default.danger(t)})},n.listRepoRelatedUsers=function(){var e=n.props.repoID;v.seafileAPI.listRepoRelatedUsers(e).then(function(e){var t=e.data.user_list.map(function(e){return{id:e.email,display:e.name}});n.setState({relatedUsers:t})})},n.checkParticipant=function(e){return n.props.fileParticipantList.map(function(e){return e.email}).includes(e)},n.addParticipant=function(e){n.checkParticipant(e)||n.toBeAddedParticipant.push(e)},n.renderUserSuggestion=function(e,t,n,a,r){return u.default.createElement("div",{className:"user "+(r?"focused":"")},n)},n.state={commentsList:[],relatedUsers:null,comment:""},n.toBeAddedParticipant=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listComments(),this.checkParticipant(),this.listRepoRelatedUsers()}},{key:"componentWillReceiveProps",value:function(e){e.filePath!==this.props.filePath&&this.listComments(e.filePath)}},{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,a=t.filePath,r=t.fileParticipantList;return u.default.createElement("div",{className:"seafile-comment detail-comments h-100 w-100"},u.default.createElement("ul",{className:"seafile-comment-list"},this.state.commentsList.length>0&&this.state.commentsList.map(function(t){var n=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],arguments[2],new Date(t.created_at).getTime()),a=(0,f.default)(n).format("YYYY-MM-DD HH:mm");return u.default.createElement(u.default.Fragment,{key:t.id},u.default.createElement(Y,{item:t,time:a,deleteComment:e.deleteComment,resolveComment:e.resolveComment,editComment:e.editComment}))}),0==this.state.commentsList.length&&u.default.createElement("li",{className:"comment-vacant"},(0,g.gettext)("No comment yet."))),u.default.createElement("div",{className:"seafile-comment-footer"},r&&u.default.createElement(w.default,{onParticipantsChange:this.props.onParticipantsChange,participants:r,repoID:n,filePath:a,showIconTip:!0}),u.default.createElement(D.MentionsInput,{value:this.state.comment,onChange:this.handleCommentChange,placeholder:(0,g.gettext)("Add a comment."),style:E.defaultStyle},u.default.createElement(D.Mention,{trigger:"@",displayTransform:function(e,t){return"@"+t},data:this.state.relatedUsers,renderSuggestion:this.renderUserSuggestion,style:E.defaultMentionStyle,onAdd:function(t,n){e.addParticipant(t)},appendSpaceOnAdd:!0})),u.default.createElement(m.Button,{className:"submit-comment",color:"primary",size:"sm",onClick:this.onSubmit},(0,g.gettext)("Submit"))))}}]),t}(u.default.Component);L.propTypes=P;var T={time:d.default.string.isRequired,item:d.default.object.isRequired,deleteComment:d.default.func.isRequired,resolveComment:d.default.func.isRequired,editComment:d.default.func.isRequired},Y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.convertComment=function(e){h.processor.process(e).then(function(e){var t=String(e);n.setState({html:t})})},n.toggleDropDownMenu=function(){n.setState({dropdownOpen:!n.state.dropdownOpen})},n.toggleEditComment=function(){n.setState({editable:!n.state.editable})},n.updateComment=function(e){var t=n.state.newComment;n.props.item.comment!==t&&n.props.editComment(e.target.id,t),n.toggleEditComment()},n.handleCommentChange=function(e){n.setState({newComment:e.target.value})},n.onCommentClick=function(e){if("A"===e.target.nodeName){var t=e.target.previousSibling;t&&3===t.nodeType&&"@"===t.nodeValue.slice(-1)&&e.preventDefault()}},n.renderInfo=function(e){return u.default.createElement(l.Fragment,null,u.default.createElement("img",{className:"avatar",src:e.avatar_url,alt:""}),u.default.createElement("div",{className:"reviewer-info"},u.default.createElement("div",{className:"reviewer-name ellipsis"},e.user_name),u.default.createElement("div",{className:"review-time"},n.props.time)))},n.state={dropdownOpen:!1,html:"",newComment:n.props.item.comment,editable:!1},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.convertComment(this.props.item.comment)}},{key:"componentWillReceiveProps",value:function(e){this.convertComment(e.item.comment)}},{key:"render",value:function(){var e=this,t=this.props.item;return this.state.editable?u.default.createElement("li",{className:"seafile-comment-item",id:t.id},u.default.createElement("div",{className:"seafile-comment-info"},this.renderInfo(t)),u.default.createElement("div",{className:"seafile-edit-comment"},u.default.createElement("textarea",{className:"edit-comment-input",value:this.state.newComment,onChange:this.handleCommentChange,clos:"100",rows:"3",warp:"virtual"}),u.default.createElement(m.Button,{className:"comment-btn",color:"primary",size:"sm",onClick:this.updateComment,id:t.id},(0,g.gettext)("Update"))," ",u.default.createElement(m.Button,{className:"comment-btn",color:"secondary",size:"sm",onClick:this.toggleEditComment}," ",(0,g.gettext)("Cancel")))):u.default.createElement("li",{className:t.resolved?"seafile-comment-item seafile-comment-item-resolved":"seafile-comment-item",id:t.id},u.default.createElement("div",{className:"seafile-comment-info"},this.renderInfo(t),u.default.createElement(m.Dropdown,{isOpen:this.state.dropdownOpen,size:"sm",className:"seafile-comment-dropdown",toggle:this.toggleDropDownMenu},u.default.createElement(m.DropdownToggle,{className:"seafile-comment-dropdown-btn"},u.default.createElement("i",{className:"fas fa-ellipsis-v"})),u.default.createElement(m.DropdownMenu,null,t.user_email===g.username&&u.default.createElement(m.DropdownItem,{onClick:this.props.deleteComment,className:"delete-comment",id:t.id},(0,g.gettext)("Delete")),t.user_email===g.username&&u.default.createElement(m.DropdownItem,{onClick:this.toggleEditComment,className:"edit-comment",id:t.id},(0,g.gettext)("Edit")),!t.resolved&&u.default.createElement(m.DropdownItem,{onClick:this.props.resolveComment,className:"seafile-comment-resolved",id:t.id},(0,g.gettext)("Mark as resolved"))))),u.default.createElement("div",{className:"seafile-comment-content",dangerouslySetInnerHTML:{__html:this.state.html},onClick:function(t){return e.onCommentClick(t)}}))}}]),t}(u.default.Component);Y.propTypes=T,t.default=L},108:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(191),m=a(h),g=n(192),v=a(g),y=n(193),b=a(y),C=n(194),S=a(C),w=n(195),D=a(w),E=n(4),P=n(12),L=a(P),T=n(3),Y=n(5),M=a(Y);n(148);var _={isGroupOwnedRepo:d.default.bool,itemType:d.default.string.isRequired,itemName:d.default.string.isRequired,itemPath:d.default.string.isRequired,toggleDialog:d.default.func.isRequired,repoID:d.default.string.isRequired,repoEncrypted:d.default.bool,userPerm:d.default.string,enableDirPrivateShare:d.default.bool},k=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getInitialActiveTab=function(){var e=n.props,t=e.repoEncrypted,a=e.userPerm,r=e.enableDirPrivateShare,o=!t&&f.canGenerateShareLink,i=!t&&f.canGenerateUploadLink&&"rw"==a;return o?"shareLink":i?"uploadLink":r?"shareToUser":void 0},n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderDirContent=function(){if(!n.state.isRepoJudgemented)return u.default.createElement(L.default,null);var e=n.state.activeTab,t=n.props,a=t.repoEncrypted,r=t.userPerm,o=t.enableDirPrivateShare,i=t.itemType,s=!a&&f.canGenerateShareLink,c=!a&&f.canGenerateUploadLink&&"rw"==r;return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"share-dialog-side"},u.default.createElement(p.Nav,{pills:!0,vertical:!0},s&&u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"shareLink"===e?"active":"",onClick:n.toggle.bind(n,"shareLink")},(0,f.gettext)("Share Link"))),c&&u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"uploadLink"===e?"active":"",onClick:n.toggle.bind(n,"uploadLink")},(0,f.gettext)("Upload Link"))),"dir"===i&&u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"internalLink"===e?"active":"",onClick:n.toggle.bind(n,"internalLink")},(0,f.gettext)("Internal Link"))),o&&u.default.createElement(l.Fragment,null,u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"shareToUser"===e?"active":"",onClick:n.toggle.bind(n,"shareToUser")},(0,f.gettext)("Share to user"))),u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"shareToGroup"===e?"active":"",onClick:n.toggle.bind(n,"shareToGroup")},(0,f.gettext)("Share to group")))))),u.default.createElement("div",{className:"share-dialog-main"},u.default.createElement(p.TabContent,{activeTab:n.state.activeTab},s&&u.default.createElement(p.TabPane,{tabId:"shareLink"},u.default.createElement(b.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})),c&&u.default.createElement(p.TabPane,{tabId:"uploadLink"},u.default.createElement(S.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})),"dir"===i&&"internalLink"===e&&u.default.createElement(D.default,{path:n.props.itemPath,repoID:n.props.repoID,direntType:i}),o&&u.default.createElement(l.Fragment,null,u.default.createElement(p.TabPane,{tabId:"shareToUser"},u.default.createElement(m.default,{itemType:n.props.itemType,isGroupOwnedRepo:n.props.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner})),u.default.createElement(p.TabPane,{tabId:"shareToGroup"},u.default.createElement(v.default,{itemType:n.props.itemType,isGroupOwnedRepo:n.props.isGroupOwnedRepo,itemPath:n.props.itemPath,repoID:n.props.repoID,isRepoOwner:n.state.isRepoOwner}))))))},n.renderFileContent=function(){var e=n.state.activeTab;return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"share-dialog-side"},u.default.createElement(p.Nav,{pills:!0,vertical:!0},u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"shareLink"===e?"active":"",onClick:n.toggle.bind(n,"shareLink")},(0,f.gettext)("Share Link"))),u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"internalLink"===e?"active":"",onClick:n.toggle.bind(n,"internalLink")},(0,f.gettext)("Internal Link"))))),u.default.createElement("div",{className:"share-dialog-main"},u.default.createElement(p.TabContent,{activeTab:n.state.activeTab},u.default.createElement(p.TabPane,{tabId:"shareLink"},u.default.createElement(b.default,{itemPath:n.props.itemPath,repoID:n.props.repoID,closeShareDialog:n.props.toggleDialog})),"internalLink"===e&&u.default.createElement(D.default,{path:n.props.itemPath,repoID:n.props.repoID}))))},n.state={activeTab:n.getInitialActiveTab(),isRepoJudgemented:!1,isRepoOwner:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repoID;E.seafileAPI.getRepoInfo(t).then(function(t){var n=t.data.owner_email===f.username;e.setState({isRepoJudgemented:!0,isRepoOwner:n})}).catch(function(e){var t=T.Utils.getErrorMsg(e);M.default.danger(t)})}},{key:"render",value:function(){var e=this.props,t=e.itemType,n=e.itemName,a=e.repoEncrypted,r=!a&&f.canGenerateShareLink;return u.default.createElement("div",null,u.default.createElement(p.Modal,{isOpen:!0,style:{maxWidth:"720px"},className:"share-dialog",toggle:this.props.toggleDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},(0,f.gettext)("Share")," ",u.default.createElement("span",{className:"op-target",title:n},n)),u.default.createElement(p.ModalBody,{className:"share-dialog-content"},("library"===t||"dir"===t)&&this.renderDirContent(),"file"===t&&r&&this.renderFileContent())))}}]),t}(u.default.Component);k.propTypes=_,t.default=k},1080:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(9),f=a(p),h=n(2),m=n(3),g=n(290),v=a(g),y=n(24),b=a(y),C=n(401),S=a(C),w=n(229),D=a(w),E={repoInfo:d.default.object.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object.isRequired,direntType:d.default.string.isRequired,direntDetail:d.default.object.isRequired,path:d.default.string.isRequired,fileTagList:d.default.array.isRequired,relatedFiles:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,onParticipantsChange:d.default.func.isRequired,fileParticipantList:d.default.array.isRequired},P=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getDirentPostion=function(){var e=n.props.repoInfo,t=n.getDirentPath(),a=e.repo_name;if("/"!==t){var r=t.lastIndexOf("/");a+=t.slice(0,r)}return a},n.onEditFileTagToggle=function(){n.setState({isEditFileTagShow:!n.state.isEditFileTagShow})},n.onFileTagChanged=function(){var e=n.getDirentPath();n.props.onFileTagChanged(n.props.dirent,e)},n.getDirentPath=function(){if(m.Utils.isMarkdownFile(n.props.path))return n.props.path;var e=n.props,t=e.dirent,a=e.path;return m.Utils.joinPath(a,t.name)},n.onRelatedFileChange=function(){var e=n.getDirentPath();n.props.onRelatedFileChange(n.props.dirent,e)},n.onListRelatedFileToggle=function(){n.setState({showRelatedFileDialog:!0})},n.toggleCancel=function(){n.setState({showRelatedFileDialog:!1})},n.state={isEditFileTagShow:!1,showRelatedFileDialog:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.direntType,n=e.direntDetail,a=e.fileTagList,r=e.relatedFiles,o=e.fileParticipantList,i=this.getDirentPostion(),s=this.getDirentPath();return"dir"===t?u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"}),u.default.createElement("th",{width:"65%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Location")),u.default.createElement("td",null,i)),u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Last Update")),u.default.createElement("td",null,(0,f.default)(n.mtime).format("YYYY-MM-DD"))))):u.default.createElement(l.Fragment,null,u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"}),u.default.createElement("th",{width:"65%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Size")),u.default.createElement("td",null,m.Utils.bytesToSize(n.size))),u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Location")),u.default.createElement("td",null,i)),u.default.createElement("tr",null,u.default.createElement("th",null,(0,h.gettext)("Last Update")),u.default.createElement("td",null,(0,f.default)(n.last_modified).fromNow())),u.default.createElement("tr",{className:"file-tag-container"},u.default.createElement("th",null,(0,h.gettext)("Tags")),u.default.createElement("td",null,u.default.createElement("ul",{className:"file-tag-list"},a.map(function(e){return u.default.createElement("li",{key:e.id,className:"file-tag-item"},u.default.createElement("span",{className:"file-tag",style:{backgroundColor:e.color}}),u.default.createElement("span",{className:"tag-name",title:e.name},e.name))})),u.default.createElement("i",{className:"fa fa-pencil-alt attr-action-icon",onClick:this.onEditFileTagToggle}))),u.default.createElement("tr",{className:"file-related-files"},u.default.createElement("th",null,(0,h.gettext)("Related Files")),u.default.createElement("td",null,u.default.createElement("ul",null,r.map(function(e,t){var n=h.siteRoot+"lib/"+e.repo_id+"/file"+m.Utils.encodePath(e.path);return u.default.createElement("li",{key:t},u.default.createElement("a",{href:n,target:"_blank"},e.name))})),u.default.createElement("i",{className:"fa fa-pencil-alt attr-action-icon",onClick:this.onListRelatedFileToggle}))),u.default.createElement("tr",{className:"file-participants"},u.default.createElement("th",null,(0,h.gettext)("Participants")),u.default.createElement("td",null,o&&u.default.createElement(D.default,{onParticipantsChange:this.props.onParticipantsChange,participants:o,repoID:this.props.repoID,filePath:s,showIconTip:!1}))))),this.state.showRelatedFileDialog&&u.default.createElement(b.default,null,u.default.createElement(S.default,{repoID:this.props.repoID,filePath:s,relatedFiles:r,toggleCancel:this.toggleCancel,onRelatedFileChange:this.onRelatedFileChange,dirent:this.props.dirent,viewMode:"list_related_file"})),this.state.isEditFileTagShow&&u.default.createElement(b.default,null,u.default.createElement(v.default,{repoID:this.props.repoID,fileTagList:a,filePath:s,toggleCancel:this.onEditFileTagToggle,onFileTagChanged:this.onFileTagChanged})))}}]),t}(u.default.Component);P.propTypes=E,t.default=P},1081:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(1),p=a(d),f=n(1082),h=a(f),m=n(598),g=a(m),v=n(2),y=n(4),b=n(3),C=n(1083),S=a(C),w=n(1085),D=a(w),E=n(5),P=a(E);n(1086);var L={repoID:p.default.string.isRequired,direntList:p.default.array.isRequired,filetypes:p.default.array,chunkSize:p.default.number,withCredentials:p.default.bool,maxFiles:p.default.number,maxFileSize:p.default.number,testMethod:p.default.string,testChunks:p.default.number,simultaneousUploads:p.default.number,fileParameterName:p.default.string,maxFilesErrorCallback:p.default.func,maxFileSizeErrorCallback:p.default.func,minFileSizeErrorCallback:p.default.func,fileTypeErrorCallback:p.default.func,dragAndDrop:p.default.bool.isRequired,path:p.default.string.isRequired,onFileUploadSuccess:p.default.func.isRequired},T=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.componentWillUnmount=function(){window.onbeforeunload=null,!0===n.props.dragAndDrop&&n.resumable.disableDropOnDocument()},n.onbeforeunload=function(){if(window.uploader&&window.uploader.isUploadProgressDialogShow&&100!==window.uploader.totalProgress)return""},n.bindCallbackHandler=function(){var e=n.props,t=e.maxFilesErrorCallback,a=e.minFileSizeErrorCallback,r=e.maxFileSizeErrorCallback,o=e.fileTypeErrorCallback;t&&(n.resumable.opts.maxFilesErrorCallback=n.props.maxFilesErrorCallback),a&&(n.resumable.opts.minFileSizeErrorCallback=n.props.minFileSizeErrorCallback),r&&(n.resumable.opts.maxFileSizeErrorCallback=n.props.maxFileSizeErrorCallback),o&&(n.resumable.opts.fileTypeErrorCallback=n.props.fileTypeErrorCallback)},n.bindEventHandler=function(){n.resumable.on("chunkingComplete",n.onChunkingComplete.bind(n)),n.resumable.on("fileAdded",n.onFileAdded.bind(n)),n.resumable.on("filesAddedComplete",n.filesAddedComplete.bind(n)),n.resumable.on("fileProgress",n.onFileProgress.bind(n)),n.resumable.on("fileSuccess",n.onFileUploadSuccess.bind(n)),n.resumable.on("progress",n.onProgress.bind(n)),n.resumable.on("complete",n.onComplete.bind(n)),n.resumable.on("pause",n.onPause.bind(n)),n.resumable.on("fileRetry",n.onFileRetry.bind(n)),n.resumable.on("fileError",n.onFileError.bind(n)),n.resumable.on("error",n.onError.bind(n)),n.resumable.on("beforeCancel",n.onBeforeCancel.bind(n)),n.resumable.on("cancel",n.onCancel.bind(n)),n.resumable.on("dragstart",n.onDragStart.bind(n))},n.onChunkingComplete=function(e){!0===n.state.allFilesUploaded&&n.setState({allFilesUploaded:!1});var t="/"===n.props.path?"/":n.props.path+"/",a=e.fileName,r=e.relativePath,o=a===r;if(e.formData={},o)e.formData={parent_dir:t};else{var i=r.slice(0,r.lastIndexOf("/")+1);e.formData={parent_dir:t,relative_path:i}}},n.onFileAdded=function(e,t){var a=e.fileName===e.relativePath;if(a&&1===t.length){for(var r=!1,o=n.props.direntList,i=0;i<o.length;i++)if("file"===o[i].type&&o[i].name===e.fileName){r=!0;break}r?n.setState({isUploadRemindDialogShow:!0,currentResumableFile:e}):(n.setUploadFileList(n.resumable.files),n.resumableUpload(e))}else n.setUploadFileList(n.resumable.files),a?n.resumableUpload(e):n.resumable.upload()},n.resumableUpload=function(e){var t=n.props,a=t.repoID,r=t.path;y.seafileAPI.getFileUploadedBytes(a,r,e.fileName).then(function(t){var a=t.data.uploadedBytes,r=1024*parseInt(v.resumableUploadFileBlockSize)*1024||1048576,o=Math.floor(a/r);e.markChunksCompleted(o),n.resumable.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)})},n.filesAddedComplete=function(e,t){},n.setUploadFileList=function(){var e=n.resumable.files;n.setState({uploadFileList:e,isUploadProgressDialogShow:!0}),b.Utils.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},n.onFileProgress=function(e){var t=n.getBitrate(),a=n.state.uploadFileList.map(function(n){if(n.uniqueIdentifier===e.uniqueIdentifier&&t){var a=8*(n.size-n.size*n.progress()),r=Math.floor(a/t);n.remainingTime=r}return n});n.setState({uploadBitrate:t,uploadFileList:a})},n.getBitrate=function(){var e=0,t=0,a=(new Date).getTime();if(n.resumable.files.forEach(function(t){e+=t.progress()*t.size}),n.timestamp){var r=a-n.timestamp;if(r<n.bitrateInterval)return n.state.uploadBitrate;(e<n.loaded||0===n.loaded)&&(n.loaded=e),t=(e-n.loaded)*(1e3/r)*8}return n.timestamp=a,n.loaded=e,t},n.onProgress=function(){var e=Math.round(100*n.resumable.progress());n.setState({totalProgress:e}),b.Utils.registerGlobalVariable("uploader","totalProgress",e)},n.onFileUploadSuccess=function(e,t){var a=e.formData,r=(new Date).getTime()/1e3;if(t=a.replace?t:JSON.parse(t)[0],a.relative_path){var o=a.relative_path,i=o.slice(0,o.indexOf("/")),s={id:t.id,name:i,type:"dir",mtime:r};n.notifiedFolders.some(function(e){return e.name===s.name})||(n.notifiedFolders.push(s),n.props.onFileUploadSuccess(s));var l=n.state.uploadFileList.map(function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=o+t.name,n.isSaved=!0),n});return void n.setState({uploadFileList:l})}if(a.replace){var u=e.fileName,c={id:t,name:u,type:"file",mtime:r};n.props.onFileUploadSuccess(c);var d=n.state.uploadFileList.map(function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.newFileName=u,t.isSaved=!0),t});return void n.setState({uploadFileList:d})}var p={id:t.id,type:"file",name:t.name,size:t.size,mtime:r};n.props.onFileUploadSuccess(p);var f=n.state.uploadFileList.map(function(n){return n.uniqueIdentifier===e.uniqueIdentifier&&(n.newFileName=t.name,n.isSaved=!0),n});n.setState({uploadFileList:f})},n.onFileError=function(e,t){var a="";a=t||(0,v.gettext)("Network error");var r=n.state.uploadFileList.map(function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(n.state.retryFileList.push(t),t.error=a),t});n.loaded=0,n.setState({retryFileList:n.state.retryFileList,uploadFileList:r})},n.onComplete=function(){n.notifiedFolders=[],n.setState({allFilesUploaded:!0})},n.onPause=function(){},n.onError=function(e){b.Utils.registerGlobalVariable("uploader","totalProgress",100)},n.onFileRetry=function(){},n.onBeforeCancel=function(){},n.onCancel=function(){},n.setHeaders=function(e,t){var n=t.offset,a=t.getOpt("chunkSize"),r=e.size,o=0!==n?n*a:0,i=Math.min(r,(n+1)*a)-1;return r-t.endByte<a&&!t.getOpt("forceChunkSize")&&(i=r),{Accept:"application/json; text/javascript, */*; q=0.01","Content-Disposition":'attachment; filename="'+encodeURI(e.fileName)+'"',"Content-Range":"bytes "+o+"-"+i+"/"+r}},n.setQuery=function(e){return e.formData},n.generateUniqueIdentifier=function(e){var t=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return(0,g.default)(t+new Date)+t},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation(),e.stopPropagation()},n.onFileUpload=function(){n.uploadInput.current.removeAttribute("webkitdirectory");var e=n.props.repoID;y.seafileAPI.getUploadLink(e,n.props.path).then(function(e){n.resumable.opts.target=e.data+"?ret-json=1",b.Utils.isIEBrower()&&n.uploadInput.current.click()}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)}),b.Utils.isIEBrower()||n.uploadInput.current.click()},n.onFolderUpload=function(){n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory");var e=n.props.repoID;y.seafileAPI.getUploadLink(e,n.props.path).then(function(e){n.resumable.opts.target=e.data+"?ret-json=1",b.Utils.isIEBrower()&&n.uploadInput.current.click()}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)}),b.Utils.isIEBrower()||n.uploadInput.current.click()},n.onDragStart=function(){var e=n.props.repoID;n.uploadInput.current.setAttribute("webkitdirectory","webkitdirectory"),y.seafileAPI.getUploadLink(e,n.props.path).then(function(e){n.resumable.opts.target=e.data+"?ret-json=1"}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)})},n.onCloseUploadDialog=function(){n.loaded=0,n.resumable.files=[],n.setState({isUploadProgressDialogShow:!1,uploadFileList:[]}),b.Utils.registerGlobalVariable("uploader","isUploadProgressDialogShow",!1)},n.onUploadCancel=function(e){var t=n.state.uploadFileList.filter(function(t){return t.uniqueIdentifier!==e.uniqueIdentifier||(t.cancel(),!1)});n.resumable.isUploading()||(n.setState({totalProgress:"100",allFilesUploaded:!0}),n.loaded=0),n.setState({uploadFileList:t})},n.onCancelAllUploading=function(){var e=n.state.uploadFileList.filter(function(e){return!Math.round(1!==e.progress())||(e.cancel(),!1)});n.loaded=0,n.setState({allFilesUploaded:!0,totalProgress:"100",uploadFileList:e})},n.onUploadRetry=function(e){y.seafileAPI.getUploadLink(n.props.repoID,n.props.path).then(function(t){n.resumable.opts.target=t.data;var a=n.state.retryFileList.filter(function(t){return t.uniqueIdentifier!==e.uniqueIdentifier}),r=n.state.uploadFileList.map(function(t){return t.uniqueIdentifier===e.uniqueIdentifier&&(t.error=null,n.retryUploadFile(t)),t});n.setState({retryFileList:a,uploadFileList:r})}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)})},n.onUploadRetryAll=function(){y.seafileAPI.getUploadLink(n.props.repoID,n.props.path).then(function(e){n.resumable.opts.target=e.data,n.state.retryFileList.forEach(function(e){e.error=!1,n.retryUploadFile(e)});var t=n.state.uploadFileList.slice(0);n.setState({retryFileList:[],uploadFileList:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)})},n.retryUploadFile=function(e){var t=n.props,a=t.repoID,r=t.path,o=e.fileName;if(e.fileName!==e.relativePath){var i=e.formData.relative_path;o=("/"===r?r+i:r+"/"+i)+o}e.bootstrap();var s=!1;e.resumableObj.on("chunkingComplete",function(){s||(console.log(r),y.seafileAPI.getFileUploadedBytes(a,r,o).then(function(t){var n=t.data.uploadedBytes,a=1024*parseInt(v.resumableUploadFileBlockSize)*1024||1048576,r=Math.floor(n/a);e.markChunksCompleted(r),e.resumableObj.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)})),s=!0})},n.replaceRepetitionFile=function(){var e=n.props,t=e.repoID,a=e.path;y.seafileAPI.getUpdateLink(t,a).then(function(e){n.resumable.opts.target=e.data;var t=n.resumable.files[n.resumable.files.length-1];t.formData.replace=1,t.formData.target_file=t.formData.parent_dir+t.fileName,n.setState({isUploadRemindDialogShow:!1}),n.setUploadFileList(n.resumable.files),n.resumable.upload()}).catch(function(e){var t=b.Utils.getErrorMsg(e);P.default.danger(t)})},n.uploadFile=function(){var e=n.resumable.files[n.resumable.files.length-1];n.setState({isUploadRemindDialogShow:!1,isUploadProgressDialogShow:!0,uploadFileList:[].concat(r(n.state.uploadFileList),[e])},function(){n.resumable.upload()}),b.Utils.registerGlobalVariable("uploader","isUploadProgressDialogShow",!0)},n.cancelFileUpload=function(){n.resumable.files.pop(),n.setState({isUploadRemindDialogShow:!1})},n.state={retryFileList:[],uploadFileList:[],totalProgress:0,isUploadProgressDialogShow:!1,isUploadRemindDialogShow:!1,currentResumableFile:null,uploadBitrate:"0",allFilesUploaded:!1},n.uploadInput=c.default.createRef(),n.notifiedFolders=[],n.timestamp=null,n.loaded=0,n.bitrateInterval=500,window.onbeforeunload=n.onbeforeunload,n}return s(t,e),l(t,[{key:"componentDidMount",value:function(){this.resumable=new h.default({target:"",query:this.setQuery||{},fileType:this.props.filetypes,maxFiles:this.props.maxFiles,maxFileSize:this.props.maxFileSize,testMethod:this.props.testMethod||"post",testChunks:this.props.testChunks||!1,headers:this.setHeaders||{},withCredentials:this.props.withCredentials||!1,chunkSize:1024*parseInt(v.resumableUploadFileBlockSize)*1024||1048576,simultaneousUploads:this.props.simultaneousUploads||1,fileParameterName:this.props.fileParameterName,generateUniqueIdentifier:this.generateUniqueIdentifier,forceChunkSize:!0,maxChunkRetries:3}),this.resumable.assignBrowse(this.uploadInput.current,!0),!0===this.props.dragAndDrop&&this.resumable.enableDropOnDocument(),this.bindCallbackHandler(),this.bindEventHandler()}},{key:"render",value:function(){return c.default.createElement(u.Fragment,null,c.default.createElement("div",{className:"file-uploader-container"},c.default.createElement("div",{className:"file-uploader"},c.default.createElement("input",{className:"upload-input",type:"file",ref:this.uploadInput,onClick:this.onClick}))),this.state.isUploadRemindDialogShow&&c.default.createElement(D.default,{currentResumableFile:this.state.currentResumableFile,replaceRepetitionFile:this.replaceRepetitionFile,uploadFile:this.uploadFile,cancelFileUpload:this.cancelFileUpload}),this.state.isUploadProgressDialogShow&&c.default.createElement(S.default,{retryFileList:this.state.retryFileList,uploadFileList:this.state.uploadFileList,totalProgress:this.state.totalProgress,uploadBitrate:this.state.uploadBitrate,allFilesUploaded:this.state.allFilesUploaded,onCloseUploadDialog:this.onCloseUploadDialog,onCancelAllUploading:this.onCancelAllUploading,onUploadCancel:this.onUploadCancel,onUploadRetry:this.onUploadRetry,onUploadRetryAll:this.onUploadRetryAll}))}}]),t}(c.default.Component);T.propTypes=L,t.default=T},1082:function(e,t,n){!function(){"use strict";var t=function(e){function n(e,t,n,a){var o;return e.isFile?e.file(function(e){e.relativePath=t+e.name,n.push(e),a()}):(e.isDirectory?o=e:e instanceof File&&n.push(e),"function"===typeof e.webkitGetAsEntry&&(o=e.webkitGetAsEntry()),o&&o.isDirectory?r(o,t+o.name+"/",n,a):("function"===typeof e.getAsFile&&(e=e.getAsFile())instanceof File&&(e.relativePath=t+e.name,n.push(e)),void a()))}function a(e,t){if(!e||0===e.length)return t();e[0](function(){a(e.slice(1),t)})}function r(e,t,r,o){function i(){s.readEntries(function(e){if(e.length)return l=l.concat(e),i();a(l.map(function(e){return n.bind(null,e,t,r)}),o)})}var s=e.createReader(),l=[];i()}function o(e,t){if(e.length){l.fire("beforeAdd");var r=[];a(Array.prototype.map.call(e,function(e){var t=e;return"function"===typeof e.webkitGetAsEntry&&(t=e.webkitGetAsEntry()),n.bind(null,t,"",r)}),function(){r.length&&f(r,t)})}}function i(e,t,n){var a=this;a.opts={},a.getOpt=e.getOpt,a._prevProgress=0,a.resumableObj=e,a.file=t,a.fileName=t.fileName||t.name,a.size=t.size,a.relativePath=t.relativePath||t.webkitRelativePath||a.fileName,a.uniqueIdentifier=n,a._pause=!1,a.container="",a.preprocessState=0,a.error=null,a.remainingTime=-1,a.isSaved=!1,a.newFileName=a.fileName;var r=void 0!==n,o=function(e,t){switch(e){case"progress":a.resumableObj.fire("fileProgress",a,t);break;case"error":a.abort(),r=!0,a.chunks=[],a.resumableObj.fire("fileError",a,t);break;case"success":if(r)return;a.resumableObj.fire("fileProgress",a,t),a.isComplete()&&a.resumableObj.fire("fileSuccess",a,t);break;case"retry":a.resumableObj.fire("fileRetry",a)}};return a.chunks=[],a.abort=function(){var e=0;u.each(a.chunks,function(t){"uploading"==t.status()&&(t.abort(),e++)}),e>0&&a.resumableObj.fire("fileProgress",a)},a.cancel=function(){var e=a.chunks;a.chunks=[],u.each(e,function(e){"uploading"==e.status()&&(e.abort(),a.resumableObj.uploadNextChunk())}),a.resumableObj.removeFile(a),a.resumableObj.fire("fileProgress",a)},a.retry=function(){a.bootstrap();var e=!1;a.resumableObj.on("chunkingComplete",function(){e||a.resumableObj.upload(),e=!0})},a.bootstrap=function(){a.abort(),r=!1,a.chunks=[],a._prevProgress=0;for(var e=a.getOpt("forceChunkSize")?Math.ceil:Math.floor,t=Math.max(e(a.file.size/a.getOpt("chunkSize")),1),n=0;n<t;n++)!function(e){window.setTimeout(function(){a.chunks.push(new s(a.resumableObj,a,e,o)),a.resumableObj.fire("chunkingProgress",a,e/t)},0)}(n);window.setTimeout(function(){a.resumableObj.fire("chunkingComplete",a)},0)},a.progress=function(){if(r)return 1;var e=0,t=!1;return u.each(a.chunks,function(n){"error"==n.status()&&(t=!0),e+=n.progress(!0)}),e=t?1:e>.99999?1:e,e=Math.max(a._prevProgress,e),a._prevProgress=e,e},a.isUploading=function(){var e=!1;return u.each(a.chunks,function(t){if("uploading"==t.status())return e=!0,!1}),e},a.isComplete=function(){var e=!1;return 1!==a.preprocessState&&(u.each(a.chunks,function(t){var n=t.status();if("pending"==n||"uploading"==n||1===t.preprocessState)return e=!0,!1}),!e)},a.pause=function(e){a._pause="undefined"===typeof e?!a._pause:e},a.isPaused=function(){return a._pause},a.preprocessFinished=function(){a.preprocessState=2,a.upload()},a.upload=function(){var e=!1;if(!1===a.isPaused()){var t=a.getOpt("preprocessFile");if("function"===typeof t)switch(a.preprocessState){case 0:return a.preprocessState=1,t(a),!0;case 1:return!0}u.each(a.chunks,function(t){if("pending"==t.status()&&1!==t.preprocessState)return t.send(),e=!0,!1})}return e},a.markChunksCompleted=function(e){if(a.chunks&&!(a.chunks.length<=e))for(var t=0;t<e;t++)a.chunks[t].markComplete=!0},a.resumableObj.fire("chunkingStart",a),a.bootstrap(),this}function s(e,t,n,a){var r=this;r.opts={},r.getOpt=e.getOpt,r.resumableObj=e,r.fileObj=t,r.fileObjSize=t.size,r.fileObjType=t.file.type,r.offset=n,r.callback=a,r.lastProgressCallback=new Date,r.tested=!1,r.retries=0,r.pendingRetry=!1,r.preprocessState=0,r.markComplete=!1;var o=r.getOpt("chunkSize");return r.loaded=0,r.startByte=r.offset*o,r.endByte=Math.min(r.fileObjSize,(r.offset+1)*o),r.fileObjSize-r.endByte<o&&!r.getOpt("forceChunkSize")&&(r.endByte=r.fileObjSize),r.xhr=null,r.test=function(){r.xhr=new XMLHttpRequest;var e=function(e){r.tested=!0;var t=r.status();"success"==t?(r.callback(t,r.message()),r.resumableObj.uploadNextChunk()):r.send()};r.xhr.addEventListener("load",e,!1),r.xhr.addEventListener("error",e,!1),r.xhr.addEventListener("timeout",e,!1);var t=[],n=r.getOpt("parameterNamespace"),a=r.getOpt("query");"function"==typeof a&&(a=a(r.fileObj,r)),u.each(a,function(e,a){t.push([encodeURIComponent(n+e),encodeURIComponent(a)].join("="))}),t=t.concat([["chunkNumberParameterName",r.offset+1],["chunkSizeParameterName",r.getOpt("chunkSize")],["currentChunkSizeParameterName",r.endByte-r.startByte],["totalSizeParameterName",r.fileObjSize],["typeParameterName",r.fileObjType],["identifierParameterName",r.fileObj.uniqueIdentifier],["fileNameParameterName",r.fileObj.fileName],["relativePathParameterName",r.fileObj.relativePath],["totalChunksParameterName",r.fileObj.chunks.length]].filter(function(e){return r.getOpt(e[0])}).map(function(e){return[n+r.getOpt(e[0]),encodeURIComponent(e[1])].join("=")})),r.xhr.open(r.getOpt("testMethod"),u.getTarget("test",t)),r.xhr.timeout=r.getOpt("xhrTimeout"),r.xhr.withCredentials=r.getOpt("withCredentials");var o=r.getOpt("headers");"function"===typeof o&&(o=o(r.fileObj,r)),u.each(o,function(e,t){r.xhr.setRequestHeader(e,t)}),r.xhr.send(null)},r.preprocessFinished=function(){r.preprocessState=2,r.send()},r.send=function(){var e=r.getOpt("preprocess");if("function"===typeof e)switch(r.preprocessState){case 0:return r.preprocessState=1,void e(r);case 1:return}if(r.getOpt("testChunks")&&!r.tested)return void r.test();r.xhr=new XMLHttpRequest,r.xhr.upload.addEventListener("progress",function(e){new Date-r.lastProgressCallback>1e3*r.getOpt("throttleProgressCallbacks")&&(r.callback("progress"),r.lastProgressCallback=new Date),r.loaded=e.loaded||0},!1),r.loaded=0,r.pendingRetry=!1,r.callback("progress");var t=function(e){var t=r.status();if("success"==t||"error"==t)r.callback(t,r.message()),r.resumableObj.uploadNextChunk();else{r.callback("retry",r.message()),r.abort(),r.retries++;var n=r.getOpt("chunkRetryInterval");void 0!==n?(r.pendingRetry=!0,setTimeout(r.send,n)):r.send()}};r.xhr.addEventListener("load",t,!1),r.xhr.addEventListener("error",t,!1),r.xhr.addEventListener("timeout",t,!1);var n=[["chunkNumberParameterName",r.offset+1],["chunkSizeParameterName",r.getOpt("chunkSize")],["currentChunkSizeParameterName",r.endByte-r.startByte],["totalSizeParameterName",r.fileObjSize],["typeParameterName",r.fileObjType],["identifierParameterName",r.fileObj.uniqueIdentifier],["fileNameParameterName",r.fileObj.fileName],["relativePathParameterName",r.fileObj.relativePath],["totalChunksParameterName",r.fileObj.chunks.length]].filter(function(e){return r.getOpt(e[0])}).reduce(function(e,t){return e[r.getOpt(t[0])]=t[1],e},{}),a=r.getOpt("query");"function"==typeof a&&(a=a(r.fileObj,r)),u.each(a,function(e,t){n[e]=t});var o=r.fileObj.file.slice?"slice":r.fileObj.file.mozSlice?"mozSlice":r.fileObj.file.webkitSlice?"webkitSlice":"slice",i=r.fileObj.file[o](r.startByte,r.endByte,r.getOpt("setChunkTypeFromFile")?r.fileObj.file.type:""),s=null,l=[],c=r.getOpt("parameterNamespace");if("octet"===r.getOpt("method"))s=i,u.each(n,function(e,t){l.push([encodeURIComponent(c+e),encodeURIComponent(t)].join("="))});else if(s=new FormData,u.each(n,function(e,t){s.append(c+e,t),l.push([encodeURIComponent(c+e),encodeURIComponent(t)].join("="))}),"blob"==r.getOpt("chunkFormat"))s.append(c+r.getOpt("fileParameterName"),i,r.fileObj.fileName);else if("base64"==r.getOpt("chunkFormat")){var d=new FileReader;d.onload=function(e){s.append(c+r.getOpt("fileParameterName"),d.result),r.xhr.send(s)},d.readAsDataURL(i)}var p=u.getTarget("upload",l),f=r.getOpt("uploadMethod");"post"===f.toLowerCase()&&(p=u.getTarget("upload",[])),r.xhr.open(f,p),"octet"===r.getOpt("method")&&r.xhr.setRequestHeader("Content-Type","application/octet-stream"),r.xhr.timeout=r.getOpt("xhrTimeout"),r.xhr.withCredentials=r.getOpt("withCredentials");var h=r.getOpt("headers");"function"===typeof h&&(h=h(r.fileObj,r)),u.each(h,function(e,t){r.xhr.setRequestHeader(e,t)}),"blob"==r.getOpt("chunkFormat")&&r.xhr.send(s)},r.abort=function(){r.xhr&&r.xhr.abort(),r.xhr=null},r.status=function(){return r.pendingRetry?"uploading":r.markComplete?"success":r.xhr?r.xhr.readyState<4?"uploading":200==r.xhr.status||201==r.xhr.status?"success":u.contains(r.getOpt("permanentErrors"),r.xhr.status)||r.retries>=r.getOpt("maxChunkRetries")?"error":(r.abort(),"pending"):"pending"},r.message=function(){return r.xhr?r.xhr.responseText:""},r.progress=function(e){"undefined"===typeof e&&(e=!1);var t=e?(r.endByte-r.startByte)/r.fileObjSize:1;if(r.pendingRetry)return 0;switch(r.xhr&&r.xhr.status||r.markComplete||(t*=.95),r.status()){case"success":case"error":return 1*t;case"pending":return 0*t;default:return r.loaded/(r.endByte-r.startByte)*t}},this}if(!(this instanceof t))return new t(e);if(this.version=1,this.support="undefined"!==typeof File&&"undefined"!==typeof Blob&&"undefined"!==typeof FileList&&(!!Blob.prototype.webkitSlice||!!Blob.prototype.mozSlice||!!Blob.prototype.slice||!1),!this.support)return!1;var l=this;l.files=[],l.defaults={chunkSize:1048576,forceChunkSize:!1,simultaneousUploads:3,fileParameterName:"file",chunkNumberParameterName:"resumableChunkNumber",chunkSizeParameterName:"resumableChunkSize",currentChunkSizeParameterName:"resumableCurrentChunkSize",totalSizeParameterName:"resumableTotalSize",typeParameterName:"resumableType",identifierParameterName:"resumableIdentifier",fileNameParameterName:"resumableFilename",relativePathParameterName:"resumableRelativePath",totalChunksParameterName:"resumableTotalChunks",dragOverClass:"dragover",throttleProgressCallbacks:.5,query:{},headers:{},preprocess:null,preprocessFile:null,method:"multipart",uploadMethod:"POST",testMethod:"GET",prioritizeFirstAndLastChunk:!1,target:"/",testTarget:null,parameterNamespace:"",testChunks:!0,generateUniqueIdentifier:null,getTarget:null,maxChunkRetries:100,chunkRetryInterval:void 0,permanentErrors:[400,401,403,404,409,415,500,501],maxFiles:void 0,withCredentials:!1,xhrTimeout:0,clearInput:!0,chunkFormat:"blob",setChunkTypeFromFile:!1,maxFilesErrorCallback:function(e,t){var n=l.getOpt("maxFiles");alert("Please upload no more than "+n+" file"+(1===n?"":"s")+" at a time.")},minFileSize:1,minFileSizeErrorCallback:function(e,t){alert(e.fileName||e.name+" is too small, please upload files larger than "+u.formatSize(l.getOpt("minFileSize"))+".")},maxFileSize:void 0,maxFileSizeErrorCallback:function(e,t){alert(e.fileName||e.name+" is too large, please upload files less than "+u.formatSize(l.getOpt("maxFileSize"))+".")},fileType:[],fileTypeErrorCallback:function(e,t){alert(e.fileName||e.name+" has type not allowed, please upload files of type "+l.getOpt("fileType")+".")}},l.opts=e||{},l.getOpt=function(e){var n=this;if(e instanceof Array){var a={};return u.each(e,function(e){a[e]=n.getOpt(e)}),a}if(n instanceof s){if("undefined"!==typeof n.opts[e])return n.opts[e];n=n.fileObj}if(n instanceof i){if("undefined"!==typeof n.opts[e])return n.opts[e];n=n.resumableObj}if(n instanceof t)return"undefined"!==typeof n.opts[e]?n.opts[e]:n.defaults[e]},l.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},l.events=[],l.on=function(e,t){l.events.push(e.toLowerCase(),t)},l.fire=function(){for(var e=[],t=0;t<arguments.length;t++)e.push(arguments[t]);for(var n=e[0].toLowerCase(),t=0;t<=l.events.length;t+=2)l.events[t]==n&&l.events[t+1].apply(l,e.slice(1)),"catchall"==l.events[t]&&l.events[t+1].apply(null,e);"fileerror"==n&&l.fire("error",e[2],e[1]),"fileprogress"==n&&l.fire("progress")};var u={stopEvent:function(e){e.stopPropagation(),e.preventDefault()},each:function(e,t){if("undefined"!==typeof e.length){for(var n=0;n<e.length;n++)if(!1===t(e[n]))return}else for(n in e)if(!1===t(n,e[n]))return},generateUniqueIdentifier:function(e,t){var n=l.getOpt("generateUniqueIdentifier");if("function"===typeof n)return n(e,t);var a=e.webkitRelativePath||e.relativePath||e.fileName||e.name;return e.size+"-"+a.replace(/[^0-9a-zA-Z_-]/gim,"")},contains:function(e,t){var n=!1;return u.each(e,function(e){return e!=t||(n=!0,!1)}),n},formatSize:function(e){return e<1024?e+" bytes":e<1048576?(e/1024).toFixed(0)+" KB":e<1073741824?(e/1024/1024).toFixed(1)+" MB":(e/1024/1024/1024).toFixed(1)+" GB"},getTarget:function(e,t){var n=l.getOpt("target");if("test"===e&&l.getOpt("testTarget")&&(n="/"===l.getOpt("testTarget")?l.getOpt("target"):l.getOpt("testTarget")),"function"===typeof n)return n(t);var a=n.indexOf("?")<0?"?":"&",r=t.join("&");return r&&(n=n+a+r),n}},c=function(e){u.stopEvent(e);var t=e.dataTransfer;l.indexOf(t.types,"Files")<0||(e.dataTransfer&&e.dataTransfer.items?o(e.dataTransfer.items,e):e.dataTransfer&&e.dataTransfer.files&&o(e.dataTransfer.files,e),l.dragstart=!1)},d=function(e){},p=function(e){e.preventDefault();var t=e.dataTransfer;l.indexOf(t.types,"Files")>=0&&(e.stopPropagation(),t.dropEffect="copy",t.effectAllowed="copy",l.dragstart||(l.fire("dragstart",l),l.dragstart=!0))},f=function(e,t){var n=0,a=l.getOpt(["maxFiles","minFileSize","maxFileSize","maxFilesErrorCallback","minFileSizeErrorCallback","maxFileSizeErrorCallback","fileType","fileTypeErrorCallback"]);if("undefined"!==typeof a.maxFiles&&a.maxFiles<e.length+l.files.length){if(1!==a.maxFiles||1!==l.files.length||1!==e.length)return a.maxFilesErrorCallback(e,n++),!1;l.removeFile(l.files[0])}var r=[],o=[],s=e.length,c=function(){if(!--s){if(!r.length&&!o.length)return;window.setTimeout(function(){l.fire("filesAdded",r,o)},0)}};u.each(e,function(e){function s(n){l.getFromUniqueIdentifier(n)?o.push(e):function(){e.uniqueIdentifier=n;var a=new i(l,e,n);l.files.push(a),r.push(a),a.container="undefined"!=typeof t?t.srcElement:null,window.setTimeout(function(){l.fire("fileAdded",a,r)},0)}(),c()}var d=e.name,p=e.type;if(a.fileType.length>0){var f=!1;for(var h in a.fileType){a.fileType[h]=a.fileType[h].replace(/\s/g,"").toLowerCase();var m=(a.fileType[h].match(/^[^.][^\/]+$/)?".":"")+a.fileType[h];if(d.substr(-1*m.length).toLowerCase()===m||-1!==m.indexOf("/")&&(-1!==m.indexOf("*")&&p.substr(0,m.indexOf("*"))===m.substr(0,m.indexOf("*"))||p===m)){f=!0;break}}if(!f)return a.fileTypeErrorCallback(e,n++),!0}if("undefined"!==typeof a.minFileSize&&e.size<a.minFileSize)return a.minFileSizeErrorCallback(e,n++),!0;if("undefined"!==typeof a.maxFileSize&&e.size>a.maxFileSize)return a.maxFileSizeErrorCallback(e,n++),!0;var g=u.generateUniqueIdentifier(e,t);g&&"function"===typeof g.then?g.then(function(e){s(e)},function(){c()}):s(g)}),window.setTimeout(function(){l.fire("filesAddedComplete",l,r)},0)};return l.uploadNextChunk=function(){var e=!1;if(l.getOpt("prioritizeFirstAndLastChunk")&&(u.each(l.files,function(t){return t.chunks.length&&"pending"==t.chunks[0].status()&&0===t.chunks[0].preprocessState?(t.chunks[0].send(),e=!0,!1):t.chunks.length>1&&"pending"==t.chunks[t.chunks.length-1].status()&&0===t.chunks[t.chunks.length-1].preprocessState?(t.chunks[t.chunks.length-1].send(),e=!0,!1):void 0}),e))return!0;if(u.each(l.files,function(t){if(e=t.upload())return!1}),e)return!0;var t=!1;return u.each(l.files,function(e){if(!e.isComplete())return t=!0,!1}),t||l.fire("complete"),!1},l.assignBrowse=function(e,t){"undefined"==typeof e.length&&(e=[e]),u.each(e,function(e){var n;"INPUT"===e.tagName&&"file"===e.type?n=e:(n=document.createElement("input"),n.setAttribute("type","file"),n.style.display="none",e.addEventListener("click",function(){n.style.opacity=0,n.style.display="block",n.focus(),n.click(),n.style.display="none"},!1),e.appendChild(n));var a=l.getOpt("maxFiles");"undefined"===typeof a||1!=a?n.setAttribute("multiple","multiple"):n.removeAttribute("multiple"),t?n.setAttribute("webkitdirectory","webkitdirectory"):n.removeAttribute("webkitdirectory");var r=l.getOpt("fileType");"undefined"!==typeof r&&r.length>=1?n.setAttribute("accept",r.map(function(e){return e=e.replace(/\s/g,"").toLowerCase(),e.match(/^[^.][^\/]+$/)&&(e="."+e),e}).join(",")):n.removeAttribute("accept"),n.addEventListener("change",function(e){f(e.target.files,e),l.getOpt("clearInput")&&(e.target.value="")},!1)})},l.assignDrop=function(e){"undefined"==typeof e.length&&(e=[e]),u.each(e,function(e){e.addEventListener("dragover",p,!1),e.addEventListener("dragenter",p,!1),e.addEventListener("dragleave",d,!1),e.addEventListener("drop",c,!1)})},l.unAssignDrop=function(e){"undefined"==typeof e.length&&(e=[e]),u.each(e,function(e){e.removeEventListener("dragover",p),e.removeEventListener("dragenter",p),e.removeEventListener("dragleave",d),e.removeEventListener("drop",c)})},l.enableDropOnDocument=function(){document.addEventListener("dragover",p,!1),document.addEventListener("dragenter",p,!1),document.addEventListener("dragleave",d,!1),document.addEventListener("drop",c,!1)},l.disableDropOnDocument=function(){document.removeEventListener("dragover",p),document.removeEventListener("dragenter",p),document.removeEventListener("dragleave",d),document.removeEventListener("drop",c)},l.isUploading=function(){var e=!1;return u.each(l.files,function(t){if(t.isUploading())return e=!0,!1}),e},l.upload=function(){if(!l.isUploading()){l.fire("uploadStart");for(var e=1;e<=l.getOpt("simultaneousUploads");e++)l.uploadNextChunk()}},l.pause=function(){u.each(l.files,function(e){e.abort()}),l.fire("pause")},l.cancel=function(){l.fire("beforeCancel");for(var e=l.files.length-1;e>=0;e--)l.files[e].cancel();l.fire("cancel")},l.progress=function(){var e=0,t=0;return u.each(l.files,function(n){e+=n.progress()*n.size,t+=n.size}),t>0?e/t:0},l.addFile=function(e,t){f([e],t)},l.addFiles=function(e,t){f(e,t)},l.removeFile=function(e){for(var t=l.files.length-1;t>=0;t--)l.files[t]===e&&l.files.splice(t,1)},l.getFromUniqueIdentifier=function(e){var t=!1;return u.each(l.files,function(n){n.uniqueIdentifier==e&&(t=n)}),t},l.getSize=function(){var e=0;return u.each(l.files,function(t){e+=t.size}),e},l.handleDropEvent=function(e){c(e)},l.handleChangeEvent=function(e){f(e.target.files,e),e.target.value=""},l.updateQuery=function(e){l.opts.query=e},this};e.exports=t,e.exports.Resumable=t}()},1083:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(1084),h=a(f),m=n(3),g={uploadBitrate:d.default.string.isRequired,totalProgress:d.default.number.isRequired,retryFileList:d.default.array.isRequired,uploadFileList:d.default.array.isRequired,onCloseUploadDialog:d.default.func.isRequired,onCancelAllUploading:d.default.func.isRequired,onUploadCancel:d.default.func.isRequired,onUploadRetry:d.default.func.isRequired,onUploadRetryAll:d.default.func.isRequired,allFilesUploaded:d.default.bool.isRequired},v=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onCancelAllUploading=function(){n.props.onCancelAllUploading()},n.onMinimizeUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isMinimized:!n.state.isMinimized})},n.onCloseUpload=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onCloseUploadDialog()},n.state={isMinimized:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=m.Utils.formatBitRate(this.props.uploadBitrate),n=(0,p.gettext)("File Upload"),a=(0,p.gettext)("File Uploading...")+" "+this.props.totalProgress+"% ("+t+")",r=u.default.createElement("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),o=u.default.createElement(l.Fragment,null,u.default.createElement("span",{className:"sf2-icon-minus",onClick:this.onMinimizeUpload}),u.default.createElement("span",{className:"sf2-icon-x1",onClick:this.onCloseUpload})),i=this.props,s=i.totalProgress,c=i.allFilesUploaded,d=i.retryFileList;return u.default.createElement("div",{className:"uploader-list-view",style:{height:this.state.isMinimized?"2.25rem":"20rem"}},u.default.createElement("div",{className:"uploader-list-header"},u.default.createElement("div",{className:"title"},100===s?n:a),u.default.createElement("div",{className:"uploader-options"},100===s||c?o:r)),u.default.createElement("div",{className:"uploader-list-content"},u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"35%"},(0,p.gettext)("name")),u.default.createElement("th",{width:"15%"},(0,p.gettext)("size")),u.default.createElement("th",{width:"35%"},(0,p.gettext)("progress")),u.default.createElement("th",{width:"15%"},(0,p.gettext)("state")))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",{className:"text-right",colSpan:3},d.length>0?u.default.createElement("span",{className:"cursor-pointer",onClick:this.props.onUploadRetryAll},(0,p.gettext)("Retry All")):u.default.createElement("span",{className:"cursor-pointer disabled-link"},(0,p.gettext)("Retry All"))),u.default.createElement("td",{className:"text-right",colSpan:1},c?u.default.createElement("span",{className:"cursor-pointer disabled-link"},(0,p.gettext)("Cancel All")):u.default.createElement("span",{className:"cursor-pointer",onClick:this.onCancelAllUploading},(0,p.gettext)("Cancel All")))),this.props.uploadFileList.map(function(t,n){return u.default.createElement(h.default,{key:n,resumableFile:t,onUploadCancel:e.props.onUploadCancel,onUploadRetry:e.props.onUploadRetry})})))))}}]),t}(u.default.Component);v.propTypes=g,t.default=v},1084:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(3),h={resumableFile:d.default.object.isRequired,onUploadCancel:d.default.func.isRequired,onUploadRetry:d.default.func.isRequired},m="uploading",g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onUploadCancel=function(e){e.preventDefault(),n.props.onUploadCancel(n.props.resumableFile)},n.onUploadRetry=function(e){e.preventDefault(),n.props.onUploadRetry(n.props.resumableFile)},n.formatFileSize=function(e){return"number"!==typeof e?"":e>=1e9?(e/1e9).toFixed(1)+" G":e>=1e6?(e/1e6).toFixed(1)+" M":e>=1e3?(e/1e3).toFixed(1)+" K":e.toFixed(1)+" B"},n.state={uploadState:m},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){var t=e.resumableFile,n=m;t.error?n="error":(0!==t.remainingTime||t.isSaved||(n="isSaving"),t.isSaved&&(n="uploaded")),this.setState({uploadState:n})}},{key:"render",value:function(){var e=this.props.resumableFile,t=Math.round(100*e.progress()),n=e.error;return u.default.createElement("tr",{className:"file-upload-item"},u.default.createElement("td",{className:"upload-name"},u.default.createElement("div",{className:"ellipsis"},e.newFileName)),u.default.createElement("td",null,u.default.createElement("span",{className:"file-size"},this.formatFileSize(e.size))),u.default.createElement("td",{className:"upload-progress"},(this.state.uploadState===m||"isSaving"===this.state.uploadState)&&u.default.createElement(l.Fragment,null,e.size>=1e8&&u.default.createElement(l.Fragment,null,e.isUploading()&&u.default.createElement("div",{className:"progress-container"},u.default.createElement("div",{className:"progress"},u.default.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})),-1===e.remainingTime&&u.default.createElement("div",{className:"progress-text"},(0,p.gettext)("Preparing to upload...")),e.remainingTime>0&&u.default.createElement("div",{className:"progress-text"},(0,p.gettext)("Remaining")," ",f.Utils.formatTime(e.remainingTime)),0===e.remainingTime&&u.default.createElement("div",{className:"progress-text"},(0,p.gettext)("Indexing..."))),!e.isUploading()&&u.default.createElement("div",{className:"progress-container d-flex align-items-center"},u.default.createElement("div",{className:"progress"},u.default.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})))),e.size<1e8&&u.default.createElement("div",{className:"progress-container d-flex align-items-center"},u.default.createElement("div",{className:"progress"},u.default.createElement("div",{className:"progress-bar",role:"progressbar",style:{width:t+"%"},"aria-valuenow":t,"aria-valuemin":"0","aria-valuemax":"100"})))),"error"===this.state.uploadState&&u.default.createElement("div",{className:"message err-message ml-0",dangerouslySetInnerHTML:{__html:n}})),u.default.createElement("td",{className:"upload-operation"},u.default.createElement(l.Fragment,null,this.state.uploadState===m&&u.default.createElement("a",{href:"#",onClick:this.onUploadCancel},(0,p.gettext)("Cancel")),"error"===this.state.uploadState&&u.default.createElement("a",{href:"#",onClick:this.onUploadRetry},(0,p.gettext)("Retry")),"isSaving"===this.state.uploadState&&u.default.createElement("span",{className:"saving"},(0,p.gettext)("Saving...")),"uploaded"===this.state.uploadState&&u.default.createElement("span",{className:"uploaded"},(0,p.gettext)("Uploaded")))))}}]),t}(u.default.Component);g.propTypes=h,t.default=g},1085:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(6),h={currentResumableFile:d.default.object.isRequired,replaceRepetitionFile:d.default.func.isRequired,uploadFile:d.default.func.isRequired,cancelFileUpload:d.default.func.isRequired},m=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.toggle=function(e){e.nativeEvent.stopImmediatePropagation(),a.props.cancelFileUpload()},a.replaceRepetitionFile=function(e){e.nativeEvent.stopImmediatePropagation(),a.props.replaceRepetitionFile()},a.uploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),a.props.uploadFile()},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=(0,p.gettext)("Replace file {filename}?");return e=e.replace("{filename}",'<span class="a-simaulte">'+this.props.currentResumableFile.fileName+"</span>"),u.default.createElement(f.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(f.ModalHeader,{toggle:this.toggle},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:e}})),u.default.createElement(f.ModalBody,null,u.default.createElement("p",null,(0,p.gettext)("A file with the same name already exists in this folder.")),u.default.createElement("p",null,(0,p.gettext)("Replacing it will overwrite its content."))),u.default.createElement(f.ModalFooter,null,u.default.createElement(f.Button,{color:"primary",onClick:this.replaceRepetitionFile},(0,p.gettext)("Replace")),u.default.createElement(f.Button,{color:"primary",onClick:this.uploadFile},(0,p.gettext)("Don't replace")),u.default.createElement(f.Button,{color:"secondary",onClick:this.toggle},(0,p.gettext)("Cancel"))))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},1086:function(e,t){},1087:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(9),g=a(m),v=n(3),y=n(1088),b=a(y),C={repoID:d.default.string.isRequired,toggle:d.default.func.isRequired},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(){n.props.toggle()},n.state={drafts:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;h.seafileAPI.listRepoDrafts(this.props.repoID).then(function(t){var n=t.data.drafts.map(function(e){return new b.default(e)});e.setState({drafts:n})})}},{key:"render",value:function(){this.state.drafts;return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("Drafts")),u.default.createElement(p.ModalBody,{className:"dialog-list-container"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%",className:"ellipsis"},(0,f.gettext)("Name")),u.default.createElement("th",{width:"25%"},(0,f.gettext)("Owner")),u.default.createElement("th",{width:"25%"},(0,f.gettext)("Last Update")))),u.default.createElement("tbody",null,this.state.drafts.map(function(e){var t=f.siteRoot+"drafts/"+e.id+"/";return u.default.createElement("tr",{key:e.id},u.default.createElement("td",{className:"name"},u.default.createElement("a",{href:t,target:"_blank"},v.Utils.getFileName(e.draftFilePath))),u.default.createElement("td",null,e.ownerNickname),u.default.createElement("td",null,(0,g.default)(e.createdStr).fromNow()))})))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Close"))))}}]),t}(u.default.Component);S.propTypes=C,t.default=S},1088:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(9),o=function(e){return e&&e.__esModule?e:{default:e}}(r),i=function e(t){a(this,e),this.created=t.created_at,this.createdStr=(0,o.default)(new Date(t.created_at).getTime()).format("YYYY-MM-DD HH:mm"),this.id=t.id,this.ownerNickname=t.owner_nickname,this.originRepoID=t.origin_repo_id,this.draftFilePath=t.draft_file_path};t.default=i},1089:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(510),h=a(f),m=n(12),g=a(m),v=n(4),y=n(2),b=n(3),C=n(5),S=a(C),w={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileName:d.default.string.isRequired,href:d.default.string,toggleCancel:d.default.func.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={readmeContent:null,isLoading:!0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;v.seafileAPI.getFileDownloadLink(this.props.repoID,this.props.filePath).then(function(t){v.seafileAPI.getFileContent(t.data).then(function(t){e.setState({readmeContent:t.data,isLoading:!1})})}).catch(function(e){var t=b.Utils.getErrorMsg(e);S.default.danger(t)})}},{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleCancel,className:"readme-dialog",size:"lg"},u.default.createElement(p.ModalHeader,null,this.props.fileName,u.default.createElement("a",{className:"readme-dialog-edit",href:this.props.href,target:"_blank"},u.default.createElement("i",{className:"fa fa-pencil-alt"}))),u.default.createElement(p.ModalBody,null,this.state.isLoading?u.default.createElement(g.default,null):u.default.createElement(h.default,{markdownContent:this.state.readmeContent,showTOC:!1})),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleCancel},(0,y.gettext)("Close"))))}}]),t}(u.default.Component);D.propTypes=w,t.default=D},1090:function(e,t){},1091:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4);n(1092);var m={repoID:d.default.string.isRequired,onLibDecryptDialog:d.default.func.isRequired},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(e){var t=n.props.repoID,a=n.state.password;h.seafileAPI.setRepoDecryptPassword(t,a).then(function(e){n.props.onLibDecryptDialog()}).catch(function(e){n.setState({showError:!0})}),e.preventDefault()},n.handleKeyPress=function(e){"Enter"==e.key&&n.handleSubmit(e)},n.handleChange=function(e){n.setState({password:e.target.value,showError:!1})},n.toggle=function(){window.location.href=f.siteRoot},n.state={password:"",showError:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalBody,null,u.default.createElement("button",{type:"button",className:"close",onClick:this.toggle},u.default.createElement("span",{"aria-hidden":"true"},"\xd7")),u.default.createElement(p.Form,{className:"lib-decrypt-form text-center"},u.default.createElement("img",{src:f.mediaUrl+"img/lock.png",alt:"","aria-hidden":"true"}),u.default.createElement("p",{className:"intro"},(0,f.gettext)("This library is password protected")),this.state.showError&&u.default.createElement("p",{className:"error"},(0,f.gettext)("Wrong password")),u.default.createElement("input",{type:"password",name:"password",className:"form-control password-input",autoComplete:"off",onKeyPress:this.handleKeyPress,placeholder:(0,f.gettext)("Password"),onChange:this.handleChange}),u.default.createElement("button",{type:"submit",className:"btn btn-primary submit",onClick:this.handleSubmit},(0,f.gettext)("Submit")),u.default.createElement("p",{className:"tip"},"* ",(0,f.gettext)("The password will be kept in the server for only 1 hour.")))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},1092:function(e,t){},114:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(4),h=n(2),m=n(3),g=n(5),v=a(g),y={token:d.default.string.isRequired,linkType:d.default.string.isRequired,toggleSendLink:d.default.func.isRequired,closeShareDialog:d.default.func.isRequired},b=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleEmailsInputChange=function(e){n.setState({emails:e.target.value})},n.handleMsgInputChange=function(e){n.setState({msg:e.target.value})},n.sendLink=function(){var e=n.state,t=e.emails,a=e.msg;if(!t.trim())return void n.setState({errorMsg:(0,h.gettext)("Please input at least an email.")});n.setState({btnDisabled:!0,sending:!0});var r=n.props,o=r.token;("uploadLink"==r.linkType?f.seafileAPI.sendUploadLink(o,t.trim(),a.trim()):f.seafileAPI.sendShareLink(o,t.trim(),a.trim())).then(function(e){n.props.closeShareDialog();var t=e.data,a=t.success,r=t.failed;if(a.length){var o=(0,h.gettext)("Successfully sent to {placeholder}").replace("{placeholder}",a.join(", "));v.default.success(o)}r.length&&r.map(function(e){var t=(0,h.gettext)("Failed to send to {email_placeholder}: {errorMsg_placeholder}").replace("{email_placeholder}",e.email).replace("{errorMsg_placeholder}",e.error_msg);v.default.warning(t)})}).catch(function(e){var t=m.Utils.getErrorMsg(e);n.setState({btnDisabled:!1,sending:!1,errorMsg:t})})},n.state={emails:"",msg:"",errorMsg:"",btnDisabled:!1,sending:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state,t=e.emails,n=e.msg,a=e.errorMsg,r=e.btnDisabled,o=e.sending;return u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{htmlFor:"emails",className:"text-secondary font-weight-normal"},(0,h.gettext)("Send to:")),u.default.createElement("input",{type:"text",id:"emails",className:"form-control w-75",value:t,onChange:this.handleEmailsInputChange,placeholder:(0,h.gettext)("Emails, separated by ','")})),u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{htmlFor:"msg",className:"text-secondary font-weight-normal"},(0,h.gettext)("Message (optional):")),u.default.createElement("textarea",{className:"form-control w-75",id:"msg",value:n,onChange:this.handleMsgInputChange})),a&&u.default.createElement("p",{className:"error"},a),u.default.createElement(p.Button,{color:"primary",onClick:this.sendLink,disabled:r,className:"mr-2"},(0,h.gettext)("Send")),u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleSendLink},(0,h.gettext)("Cancel")),o&&u.default.createElement("p",{className:"mt-2"},(0,h.gettext)("Sending...")))}}]),t}(u.default.Component);b.propTypes=y,t.default=b},115:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),i=n(4),s=function(){function e(){a(this,e)}return r(e,[{key:"getFiles",value:function(){return i.seafileAPI.listWikiDir(o.slug,"/").then(function(e){return e.data.dir_file_list.map(function(e){return{name:e.name,type:"dir"===e.type?"dir":"file",isExpanded:"dir"===e.type,parent_path:e.parent_dir,last_update_time:e.last_update_time,permission:e.permission,size:e.size}})})}},{key:"listRepoDir",value:function(){return i.seafileAPI.listDir(o.repoID,"/",{recursive:!0}).then(function(e){return e.data.dirent_list.map(function(e){return{name:e.name,type:"dir"===e.type?"dir":"file",isExpanded:"dir"===e.type,parent_path:e.parent_dir,last_update_time:e.mtime,permission:e.permission,size:e.size}})})}},{key:"createFile",value:function(e,t){return i.seafileAPI.createFile(o.repoID,e,t)}},{key:"deleteFile",value:function(e){return i.seafileAPI.deleteFile(o.repoID,e)}},{key:"renameFile",value:function(e,t){return i.seafileAPI.renameFile(o.repoID,e,t)}},{key:"createDir",value:function(e){return i.seafileAPI.createDir(o.repoID,e)}},{key:"deleteDir",value:function(e){return i.seafileAPI.deleteDir(o.repoID,e)}},{key:"renameDir",value:function(e,t){return i.seafileAPI.renameDir(o.repoID,e,t)}},{key:"getWikiFileContent",value:function(e,t){return i.seafileAPI.getWikiFileContent(e,t)}},{key:"getSource",value:function(){return i.seafileAPI.getSource()}},{key:"searchFiles",value:function(e,t){return i.seafileAPI.searchFiles(e,t)}},{key:"getAccountInfo",value:function(){return i.seafileAPI.getAccountInfo()}},{key:"getFileDownloadLink",value:function(e){return i.seafileAPI.getFileDownloadLink(o.historyRepoID,e)}},{key:"getFileContent",value:function(e){return i.seafileAPI.getFileContent(e)}},{key:"listFileHistoryRecords",value:function(e,t,n){return i.seafileAPI.listFileHistoryRecords(o.historyRepoID,e,t,n)}},{key:"revertFile",value:function(e,t){return i.seafileAPI.revertFile(o.historyRepoID,e,t)}},{key:"listDrafts",value:function(){return i.seafileAPI.listDrafts()}},{key:"deleteDraft",value:function(e){return i.seafileAPI.deleteDraft(e)}},{key:"publishDraft",value:function(e){return i.seafileAPI.publishDraft(e)}},{key:"zipDownload",value:function(e,t){return i.seafileAPI.zipDownload(o.repoID,e,t)}},{key:"queryZipProgress",value:function(e){return i.seafileAPI.queryZipProgress(e)}},{key:"cancelZipTask",value:function(e){return i.seafileAPI.cancelZipTask(e)}}]),e}(),l=new s;t.default=l},12:function(e,t,n){"use strict";function a(){return o.default.createElement("span",{className:"loading-icon loading-tip"})}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default=a},127:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(96),h=a(f);n(155);var m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,options:d.default.array.isRequired,currentOption:d.default.string.isRequired,translateOption:d.default.func.isRequired,translateExplanation:d.default.func,onOptionChanged:d.default.func.isRequired,toggleItemFreezed:d.default.func},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOptions=function(){n.options=[];for(var e=n.props.options,t=0,a=e.length;t<a;t++){var r={};r.value=e[t],r.label=u.default.createElement("div",null,n.props.translateOption(e[t]),n.props.translateExplanation&&u.default.createElement("div",{className:"permission-editor-explanation"},n.props.translateExplanation(e[t]))),n.options.push(r)}n.setState({options:n.options})},n.onEditPermission=function(e){e.nativeEvent.stopImmediatePropagation(),n.setState({isEditing:!0}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!0)},n.onOptionChanged=function(e){var t=e.value;t!==n.props.currentOption&&n.props.onOptionChanged(t),n.setState({isEditing:!1}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!1)},n.onSelectHandler=function(e){e.nativeEvent.stopImmediatePropagation()},n.onHideSelect=function(){n.setState({isEditing:!1}),n.props.toggleItemFreezed&&n.props.toggleItemFreezed(!1)},n.state={isEditing:!1,options:[]},n.options=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){document.addEventListener("click",this.onHideSelect),this.setOptions()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("click",this.onHideSelect)}},{key:"render",value:function(){var e=this.props,t=e.currentOption,n=e.isTextMode;return u.default.createElement("div",{className:"permission-editor",onClick:this.onSelectHandler},(!n||this.state.isEditing)&&u.default.createElement(h.default,{options:this.state.options,className:"permission-editor-select",classNamePrefix:"permission-editor",placeholder:this.props.translateOption(t),onChange:this.onOptionChanged,captureMenuScroll:!1}),n&&!this.state.isEditing&&u.default.createElement("div",null,this.props.translateOption(t),this.props.isEditIconShow&&u.default.createElement("span",{title:(0,p.gettext)("Edit"),className:"fa fa-pencil-alt attr-action-icon",onClick:this.onEditPermission})))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},128:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(121),f=a(p),h=n(4),m=n(2),g=n(138),v=a(g),y=n(115),b=a(y),C=n(139),S=a(C),w=n(3),D=n(5),E=a(D),P={isPublic:d.default.bool,repoID:d.default.string,placeholder:d.default.string,onSearchedClick:d.default.func.isRequired},L=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFocusHandler=function(){n.setState({width:"30rem",isMaskShow:!0,isCloseShow:!0})},n.onCloseHandler=function(){n.resetToDefault()},n.onItemClickHandler=function(e){n.resetToDefault(),n.props.onSearchedClick(e)},n.onChangeHandler=function(e){var t=n;n.setState({value:e.target.value});var a=e.target.value;if(n.inputValue===a.trim())return!1;if(n.inputValue=a.trim(),""===n.inputValue||t.getValueLength(n.inputValue)<3)return n.setState({isResultShow:!1,isResultGetted:!1}),!1;var r=n.props.repoID,o={q:a,search_repo:r||"all",search_ftypes:"all"};n.timer&&clearTimeout(n.timer),n.timer=setTimeout(t.getSearchResult(o),500)},n.onShowMore=function(){var e=n.props.repoID,t=n.state.value,a={q:t,search_repo:e||"all",search_ftypes:"all"},r="";for(var o in a)r+=o+"="+a[o]+"&";window.location=m.siteRoot+"search/?"+r.slice(0,r.length-1)},n.onSearchToggle=function(){n.setState({isSearchInputShow:!n.state.isSearchInputShow,isMaskShow:!n.state.isMaskShow})},n.onSearchPage=function(){window.location.href=m.siteRoot+"search/"},n.state={width:"default",value:"",resultItems:[],isMaskShow:!1,isResultShow:!1,isResultGetted:!1,isCloseShow:!1,isSearchInputShow:!1},n.inputValue="",n.source=null,n}return i(t,e),s(t,[{key:"getSearchResult",value:function(e){this.source&&this.cancelRequest(),this.setState({isResultShow:!0,isResultGetted:!1}),this.source=b.default.getSource(),this.sendRequest(e,this.source.token)}},{key:"sendRequest",value:function(e,t){var n=this;this.props.isPublic?h.seafileAPI.searchFilesInPublishedRepo(e.q,e.search_repo).then(function(e){if(!e.data.total)return n.setState({resultItems:[],isResultGetted:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({resultItems:t,isResultGetted:!0}),n.source=null}).catch(function(e){var t=w.Utils.getErrorMsg(e);E.default.danger(t)}):b.default.searchFiles(e,t).then(function(e){if(!e.data.total)return n.setState({resultItems:[],isResultGetted:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({resultItems:t,isResultGetted:!0}),n.source=null}).catch(function(e){console.log(e)})}},{key:"cancelRequest",value:function(){this.source.cancel("prev request is cancelled")}},{key:"getValueLength",value:function(e){for(var t,n=0,a=0;n<e.length;n++)t=e.charCodeAt(n),10==t?a+=2:t<127?a+=1:t>=128&&t<=2047?a+=2:t>=2048&&t<=65535&&(a+=3);return a}},{key:"formatResultItems",value:function(e){for(var t=[],n=e.length>5?5:e.length,a=0;a<n;a++)t[a]={},t[a].index=[a],t[a].name=e[a].name,t[a].path=e[a].fullpath,t[a].repo_id=e[a].repo_id,t[a].repo_name=e[a].repo_name,t[a].is_dir=e[a].is_dir,t[a].link_content=decodeURI(e[a].fullpath).substring(1),t[a].content=e[a].content_highlight;return t}},{key:"resetToDefault",value:function(){this.inputValue=null,this.setState({width:"",value:"",isMaskShow:!1,isCloseShow:!1,isResultShow:!1,isResultGetted:!1,resultItems:[],isSearchInputShow:!1})}},{key:"renderSearchResult",value:function(){var e=this;if(this.state.isResultShow){if(!this.state.isResultGetted||this.getValueLength(this.inputValue)<3)return u.default.createElement("span",{className:"loading-icon loading-tip"});if(!this.state.resultItems.length)return u.default.createElement("div",{className:"search-result-none"},(0,m.gettext)("No results matching."));var t=this.state.resultItems.length>=5;return u.default.createElement("ul",{className:"search-result-list"},this.state.resultItems.map(function(t){return u.default.createElement(v.default,{key:t.index,item:t,onItemClickHandler:e.onItemClickHandler})}),t&&u.default.createElement(S.default,{onShowMore:this.onShowMore}))}}},{key:"render",value:function(){var e="default"!==this.state.width?this.state.width:"",t={width:e};return u.default.createElement(l.Fragment,null,u.default.createElement(f.default,{query:"(min-width: 768px)"},u.default.createElement("div",{className:"search"},u.default.createElement("div",{className:"search-mask "+(this.state.isMaskShow?"":"hide"),onClick:this.onCloseHandler}),u.default.createElement("div",{className:"search-container"},u.default.createElement("div",{className:"input-icon"},u.default.createElement("i",{className:"search-icon-left input-icon-addon fas fa-search"}),u.default.createElement("input",{type:"text",className:"form-control search-input",name:"query",placeholder:this.props.placeholder,style:t,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:"off"}),this.state.isCloseShow&&m.username&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-external-link-alt search-icon-arrow",onClick:this.onSearchPage}),this.state.isCloseShow&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-times",onClick:this.onCloseHandler})),u.default.createElement("div",{className:"search-result-container"},this.renderSearchResult())))),u.default.createElement(f.default,{query:"(max-width: 767.8px)"},u.default.createElement("div",{className:"search-icon-container"},u.default.createElement("i",{className:"search-icon fas fa-search",onClick:this.onSearchToggle})),this.state.isSearchInputShow&&u.default.createElement("div",{className:"search"},u.default.createElement("div",{className:"search-mask "+(this.state.isMaskShow?"":"hide"),onClick:this.onCloseHandler}),u.default.createElement("div",{className:"search-container"},u.default.createElement("div",{className:"input-icon"},u.default.createElement("i",{className:"search-icon-left input-icon-addon fas fa-search"}),u.default.createElement("input",{type:"text",className:"form-control search-input",name:"query",placeholder:this.props.placeholder,style:t,value:this.state.value,onFocus:this.onFocusHandler,onChange:this.onChangeHandler,autoComplete:"off"}),this.state.isCloseShow&&m.username&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-external-link-alt search-icon-arrow",onClick:this.onSearchPage}),this.state.isCloseShow&&u.default.createElement("i",{className:"search-icon-right input-icon-addon fas fa-times",onClick:this.onCloseHandler})),u.default.createElement("div",{className:"search-result-container"},this.renderSearchResult())))))}}]),t}(l.Component);L.propTypes=P,t.default=L},129:function(e,t){},137:function(e,t){},138:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(3),f={item:d.default.object.isRequired,onItemClickHandler:d.default.func.isRequired},h=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.onClickHandler=function(){var e=a.props.item;a.props.onItemClickHandler(e)},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.link_content?"item-img":"lib-item-img",n=e.link_content?p.Utils.getFolderIconUrl(!1,192):p.Utils.getDefaultLibIconUrl(!0),a=e.is_dir?n:p.Utils.getFileIconUrl(e.name,192);return u.default.createElement("li",{className:"search-result-item",onClick:this.onClickHandler},u.default.createElement("img",{className:t,src:a,alt:""}),u.default.createElement("div",{className:"item-content"},u.default.createElement("div",{className:"item-name ellipsis"},e.name),u.default.createElement("div",{className:"item-link ellipsis"},e.repo_name,"/",e.link_content),u.default.createElement("div",{className:"item-text ellipsis",dangerouslySetInnerHTML:{__html:e.content}})))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},139:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f={onShowMore:d.default.func.isRequired},h=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("li",{className:"list-show-more",onClick:this.props.onShowMore},u.default.createElement("span",{className:"more-message"},(0,p.gettext)("show more")))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},140:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(4),d=n(2),p=n(141),f=a(p),h=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onClick=function(){n.state.showNotice?(c.seafileAPI.updateNotifications(),n.setState({showNotice:!1,unseenCount:0})):(n.loadNotices(),n.setState({showNotice:!0}))},n.loadNotices=function(){c.seafileAPI.listPopupNotices(1,5).then(function(e){var t=e.data.notification_list;n.setState({noticeList:t})})},n.onNoticeItemClick=function(e){var t=n.state.noticeList.map(function(t){return t.id===e.id&&(t.seen=!0),t});c.seafileAPI.markNoticeAsRead(e.id);var a=0===n.state.unseenCount?0:n.state.unseenCount-1;n.setState({noticeList:t,unseenCount:a})},n.state={showNotice:!1,unseenCount:0,noticeList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;c.seafileAPI.getUnseenNotificationCount().then(function(t){e.setState({unseenCount:t.data.unseen_count})})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",{id:"notifications"},u.default.createElement("a",{href:"#",onClick:this.onClick,className:"no-deco",id:"notice-icon",title:"Notifications","aria-label":"Notifications"},u.default.createElement("span",{className:"sf2-icon-bell"}),u.default.createElement("span",{className:"num "+(this.state.unseenCount?"":"hide")},this.state.unseenCount)),u.default.createElement("div",{id:"notice-popover",className:"sf-popover "+(this.state.showNotice?"":"hide")},u.default.createElement("div",{className:"outer-caret up-outer-caret"},u.default.createElement("div",{className:"inner-caret"})),u.default.createElement("div",{className:"sf-popover-hd ovhd"},u.default.createElement("h3",{className:"sf-popover-title title"},(0,d.gettext)("Notifications")),u.default.createElement("a",{href:"#",onClick:this.onClick,title:(0,d.gettext)("Close"),"aria-label":(0,d.gettext)("Close"),className:"sf-popover-close js-close sf2-icon-x1 action-icon float-right"})),u.default.createElement("div",{className:"sf-popover-con"},u.default.createElement("ul",{className:"notice-list"},this.state.noticeList.map(function(t){return u.default.createElement(f.default,{key:t.id,noticeItem:t,onNoticeItemClick:e.onNoticeItemClick})})),u.default.createElement("a",{href:d.siteRoot+"notification/list/",className:"view-all"},(0,d.gettext)("See All Notifications")))))}}]),t}(u.default.Component);t.default=h},141:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(9),f=a(p),h=n(2),m=n(3),g={noticeItem:d.default.object.isRequired,onNoticeItemClick:d.default.func.isRequired},v=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.onNoticeItemClick=function(){var e=a.props.noticeItem;!0!==e.seen&&a.props.onNoticeItemClick(e)},i=n,o(a,i)}return i(t,e),s(t,[{key:"generatorNoticeInfo",value:function(){var e=this.props.noticeItem,t=e.type,n=e.detail;if("add_user_to_group"===t){var a=n.group_staff_avatar_url,r=n.group_staff_name,o=h.siteRoot+"profile/"+n.group_staff_email+"/",i=h.siteRoot+"group/"+n.group_id+"/",s=n.group_name,l=(0,h.gettext)("User {user_link} has added you to {group_link}"),u="<a href="+o+">"+r+"</a>",c="<a href="+i+">"+s+"</a>";return l=l.replace("{user_link}",u),l=l.replace("{group_link}",c),{avatar_url:a,notice:l}}if("repo_share"===t){var d=n.share_from_user_avatar_url,p=n.share_from_user_name,f=n.repo_name,g=h.siteRoot+"library/"+n.repo_id+"/"+f+"/",v=n.path,y="",b="<a href="+g+">"+f+"</a>";return y="/"===v?(0,h.gettext)("{share_from} has shared a library named {repo_link} to you."):(0,h.gettext)("{share_from} has shared a folder named {repo_link} to you."),y=y.replace("{share_from}",p),y=y.replace("{repo_link}",b),{avatar_url:d,notice:y}}if("repo_share_to_group"===t){var C=n.share_from_user_avatar_url,S=n.share_from_user_name,w=n.repo_name,D=h.siteRoot+"library/"+n.repo_id+"/"+w+"/",E=h.siteRoot+"group/"+n.group_id+"/",P=n.group_name,L=n.path,T="",Y="<a href="+D+">"+w+"</a>",M="<a href="+E+">"+P+"</a>";return T="/"===L?(0,h.gettext)("{share_from} has shared a library named {repo_link} to group {group_link}."):(0,h.gettext)("{share_from} has shared a folder named {repo_link} to group {group_link}."),T=T.replace("{share_from}",S),T=T.replace("{repo_link}",Y),T=T.replace("{group_link}",M),{avatar_url:C,notice:T}}if("repo_transfer"===t){var _=n.transfer_from_user_avatar_url,k=n.transfer_from_user_name,Z=n.repo_name,N=h.siteRoot+"library/"+n.repo_id+"/"+Z+"/",I=(0,h.gettext)("{user} has transfered a library named {repo_link} to you."),R="<a href="+N+">"+Z+"</a>";return I=I.replace("{user}",k),I=I.replace("{repo_link}",R),{avatar_url:_,notice:I}}if("file_uploaded"===t){var O=n.uploaded_user_avatar_url,F=n.file_name,X=h.siteRoot+"lib/"+n.repo_id+"/file"+m.Utils.encodePath(n.file_path),J=n.folder_name,x=h.siteRoot+"library/"+n.repo_id+"/"+n.repo_name+m.Utils.encodePath(n.folder_path),H="";if(n.repo_id){var B="<a href="+X+">"+F+"</a>",Q="<a href="+x+">"+J+"</a>";H=(0,h.gettext)("A file named {upload_file_link} is uploaded to {uploaded_link}."),H=H.replace("{upload_file_link}",B),H=H.replace("{uploaded_link}",Q)}else H=(0,h.gettext)("A file named {upload_file_link} is uploaded to {uploaded_link}."),H=H.replace("{upload_file_link}",F),H=H.replace("{uploaded_link}","<strong>Deleted Library</strong>");return{avatar_url:O,notice:H}}if("file_comment"===t){var j=n.author_avatar_url,G=n.author_name,A=n.file_name,W=h.siteRoot+"lib/"+n.repo_id+"/file"+n.file_path,U=(0,h.gettext)("File {file_link} has a new comment form user {author}."),K="<a href="+W+">"+A+"</a>";return U=U.replace("{file_link}",K),U=U.replace("{author}",G),{avatar_url:j,notice:U}}if("draft_comment"===t){var q=n.author_avatar_url,z=n.author_name,V=n.draft_id,$=h.siteRoot+"drafts/"+V+"/",ee=(0,h.gettext)("{draft_link} has a new comment from user {author}."),te="<a href="+$+">"+(0,h.gettext)("Draft")+"#"+V+"</a>";return ee=ee.replace("{draft_link}",te),ee=ee.replace("{author}",z),{avatar_url:q,notice:ee}}if("draft_reviewer"===t){var ne=n.request_user_avatat_url,ae=n.request_user_name,re=n.draft_id,oe=h.siteRoot+"drafts/"+re+"/",ie=(0,h.gettext)("{from_user} has sent you a request for {draft_link}."),se="<a href="+oe+">"+(0,h.gettext)("Draft")+"#"+re+"</a>";return ie=ie.replace("{from_user}",ae),ie=ie.replace("{draft_link}",se),{avatar_url:ne,notice:ie}}return{avatar_url:null,notice:null}}},{key:"render",value:function(){var e=this.props.noticeItem,t=this.generatorNoticeInfo(),n=t.avatar_url,a=t.notice;return n||a?u.default.createElement("li",{onClick:this.onNoticeItemClick,className:e.seen?"read":"unread"},u.default.createElement("div",{className:"notice-item"},u.default.createElement("div",{className:"main-info"},u.default.createElement("img",{src:n,width:"32",height:"32",className:"avatar",alt:""}),u.default.createElement("p",{className:"brief",dangerouslySetInnerHTML:{__html:a}})),u.default.createElement("p",{className:"time"},(0,f.default)(e.time).fromNow()))):""}}]),t}(u.default.Component);v.propTypes=g,t.default=v},148:function(e,t){},155:function(e,t){},156:function(e,t){},157:function(e,t){},158:function(e,t){},159:function(e,t){},160:function(e,t){},170:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){a(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.path=t.path,this.obj_name=t.obj_name,this.is_dir=t.is_dir,this.permissions=t.permissions,this.username=t.username,this.is_expired=t.is_expired,this.expire_date=t.expire_date,this.token=t.token,this.link=t.link,this.view_cnt=t.view_cnt,this.ctime=t.ctime};t.default=r},171:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){a(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.path=t.path,this.link=t.link,this.obj_name=t.obj_name,this.username=t.username,this.ctime=t.ctime,this.token=t.token,this.view_cnt=t.view_cnt,this.expire_date=t.expire_date,this.is_expired=t.is_expired};t.default=r},172:function(e,t,n){"use strict";function a(){return o.default.createElement("span",{className:"session-expired-tip"},(0,i.gettext)("You are logged out.")," ",o.default.createElement("a",{className:"action-link session-expired-link",href:i.loginUrl+"?next="+encodeURIComponent(location.href)},(0,i.gettext)("Login again.")))}Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=function(e){return e&&e.__esModule?e:{default:e}}(r),i=n(2);t.default=a},191:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(6),h=n(4),m=n(3),g=n(5),v=a(g),y=n(57),b=a(y),C=n(81),S=a(C);n(156);var w=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.user_info.name)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.item,t=e.is_admin?"admin":e.permission;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},e.user_info.nickname),u.default.createElement("td",null,u.default.createElement(S.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),u.default.createElement("td",null,u.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,p.gettext)("Delete")})))}}]),t}(u.default.Component),D=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.items;return u.default.createElement("tbody",null,t.map(function(t,n){return u.default.createElement(w,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(u.default.Component),E={isGroupOwnedRepo:d.default.bool,itemPath:d.default.string.isRequired,itemType:d.default.string.isRequired,repoID:d.default.string.isRequired,isRepoOwner:d.default.bool.isRequired},P=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleSelectChange=function(e){n.setState({selectedOption:e}),n.options=[]},n.setPermission=function(e){n.setState({permission:e})},n.shareToUser=function(){var e=[],t=n.props.itemPath,a=n.props.repoID;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var r=0;r<n.state.selectedOption.length;r++)e[r]=n.state.selectedOption[r].email;n.props.isGroupOwnedRepo?h.seafileAPI.shareGroupOwnedRepoToUser(a,n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];var r=e.data.success.map(function(e){return{user_info:{nickname:e.user_name,name:e.user_email},permission:e.permission,share_type:"user"}});n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(r),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()}).catch(function(e){if(e.response){var t=(0,p.gettext)("Library can not be shared to owner."),a=[];a.push(t),n.setState({errorMsg:a,selectedOption:null})}}):h.seafileAPI.shareFolder(a,t,"user",n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(e.data.success),selectedOption:null,permission:"rw"}),n.refs.userSelect.clearSelect()}).catch(function(e){if(e.response){var t=(0,p.gettext)("Library can not be shared to owner."),a=[];a.push(t),n.setState({errorMsg:a,selectedOption:null})}})},n.deleteShareItem=function(e){var t=n.props.itemPath,a=n.props.repoID;n.props.isGroupOwnedRepo?h.seafileAPI.deleteGroupOwnedRepoSharedUserItem(a,e).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.user_info.name!==e})})}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)}):h.seafileAPI.deleteShareToUserItem(a,t,"user",e).then(function(t){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.user_info.name!==e})})}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})},n.onChangeUserPermission=function(e,t){var a=n.props.itemPath,r=n.props.repoID,o=e.user_info.name;n.props.isGroupOwnedRepo?h.seafileAPI.modifyGroupOwnedRepoUserSharedPermission(r,t,o).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)}):h.seafileAPI.updateShareToUserItemPermission(r,a,"user",o,t).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})},n.updateSharedItems=function(e,t){var a=e.user_info.name,r=n.state.sharedItems.map(function(e){var n=e.user_info.name;return a===n&&(e.permission=t),e.is_admin="admin"===t,e});n.setState({sharedItems:r})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=[];var a=e.itemType,i=e.isRepoOwner;return"library"===a?n.permissions=i?["rw","r","admin","cloud-edit","preview"]:["rw","r","cloud-edit","preview"]:"dir"===n.props.itemType&&(n.permissions=["rw","r","cloud-edit","preview"]),!n.props.isGroupOwnedRepo&&p.isPro||(n.permissions=["rw","r"]),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.itemPath,n=this.props.repoID;h.seafileAPI.listSharedItems(n,t,"user").then(function(t){0!==t.data.length&&e.setState({sharedItems:t.data})}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})}},{key:"render",value:function(){var e=this.state.sharedItems;return u.default.createElement(l.Fragment,null,u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%"},(0,p.gettext)("User")),u.default.createElement("th",{width:"35%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:"15%"}))),u.default.createElement("tbody",null,u.default.createElement("tr",null,u.default.createElement("td",null,u.default.createElement(b.default,{ref:"userSelect",isMulti:!0,className:"reviewer-select",placeholder:(0,p.gettext)("Select users..."),onSelectChange:this.handleSelectChange})),u.default.createElement("td",null,u.default.createElement(S.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),u.default.createElement("td",null,u.default.createElement(f.Button,{onClick:this.shareToUser},(0,p.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n="";return n=e.email?e.email+": "+e.error_msg:e,u.default.createElement("tr",{key:t},u.default.createElement("td",{colSpan:3},u.default.createElement("p",{className:"error"},n)))}))),u.default.createElement("div",{className:"share-list-container"},u.default.createElement("table",{className:"table-thead-hidden"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"50%"},(0,p.gettext)("User")),u.default.createElement("th",{width:"35%"},(0,p.gettext)("Permission")),u.default.createElement("th",{width:"15%"}))),u.default.createElement(D,{items:e,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission})),p.canInvitePeople&&u.default.createElement("a",{href:p.siteRoot+"invitations/",className:"invite-link-in-popup"},u.default.createElement("i",{className:"sf2-icon-invite invite-link-icon-in-popup"}),u.default.createElement("span",{className:"invite-link-icon-in-popup"},(0,p.gettext)("Invite People")))))}}]),t}(u.default.Component);P.propTypes=E,t.default=P},192:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),p=n(1),f=a(p),h=n(6),m=n(96),g=a(m),v=n(223),y=a(v),b=n(2),C=n(4),S=n(3),w=n(5),D=a(w),E=n(81),P=a(E),L=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.deleteShareItem=function(){var e=n.props.item;n.props.deleteShareItem(e.group_info.id)},n.onChangeUserPermission=function(e){var t=n.props.item;n.props.onChangeUserPermission(t,e)},n.state={isOperationShow:!1},n}return s(t,e),u(t,[{key:"render",value:function(){var e=this.props.item,t=e.is_admin?"admin":e.permission;return d.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},d.default.createElement("td",{className:"name"},e.group_info.name),d.default.createElement("td",null,d.default.createElement(P.default,{isTextMode:!0,isEditIconShow:this.state.isOperationShow,currentPermission:t,permissions:this.props.permissions,onPermissionChanged:this.onChangeUserPermission})),d.default.createElement("td",null,d.default.createElement("span",{className:"sf2-icon-x3 action-icon "+(this.state.isOperationShow?"":"hide"),onClick:this.deleteShareItem,title:(0,b.gettext)("Delete")})))}}]),t}(d.default.Component),T=function(e){function t(){return o(this,t),i(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),u(t,[{key:"render",value:function(){var e=this,t=this.props.items;return d.default.createElement("tbody",null,t.map(function(t,n){return d.default.createElement(L,{key:n,item:t,permissions:e.props.permissions,deleteShareItem:e.props.deleteShareItem,onChangeUserPermission:e.props.onChangeUserPermission})}))}}]),t}(d.default.Component),Y={isGroupOwnedRepo:f.default.bool,itemPath:f.default.string.isRequired,itemType:f.default.string.isRequired,repoID:f.default.string.isRequired,isRepoOwner:f.default.bool.isRequired},M=function(e){return d.default.createElement("div",l({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,b.gettext)("Group not found"))},_=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.loadOptions=function(){C.seafileAPI.shareableGroups().then(function(e){n.options=[];for(var t=0;t<e.data.length;t++){var a={};a.value=e.data[t].name,a.id=e.data[t].id,a.label=e.data[t].name,n.options.push(a)}}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.listSharedGroups=function(){var e=n.props.itemPath,t=n.props.repoID;C.seafileAPI.listSharedItems(t,e,"group").then(function(e){0!==e.data.length&&n.setState({sharedItems:e.data})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.setPermission=function(e){n.setState({permission:e})},n.shareToGroup=function(){var e=[],t=n.props.itemPath,a=n.props.repoID,r=n.props.isGroupOwnedRepo;if(n.state.selectedOption&&n.state.selectedOption.length>0)for(var o=0;o<n.state.selectedOption.length;o++)e[o]=n.state.selectedOption[o].id;r?C.seafileAPI.shareGroupOwnedRepoToGroup(a,n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];var r=e.data.success.map(function(e){return{group_info:{id:e.group_id,name:e.group_name},permission:e.permission,share_type:"group"}});n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(r),selectedOption:null,permission:"rw"})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)}):C.seafileAPI.shareFolder(a,t,"group",n.state.permission,e).then(function(e){var t=[];if(e.data.failed.length>0)for(var a=0;a<e.data.failed.length;a++)t[a]=e.data.failed[a];n.setState({errorMsg:t,sharedItems:n.state.sharedItems.concat(e.data.success),selectedOption:null,permission:"rw"})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.deleteShareItem=function(e){var t=n.props.itemPath,a=n.props.repoID;n.props.isGroupOwnedRepo?C.seafileAPI.deleteGroupOwnedRepoSharedGroupItem(a,e).then(function(){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.group_info.id!==e})})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)}):C.seafileAPI.deleteShareToGroupItem(a,t,"group",e).then(function(){n.setState({sharedItems:n.state.sharedItems.filter(function(t){return t.group_info.id!==e})})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.onChangeUserPermission=function(e,t){var a=n.props.itemPath,r=n.props.repoID,o=e.group_info.id;n.props.isGroupOwnedRepo?C.seafileAPI.modifyGroupOwnedRepoGroupSharedPermission(r,t,o).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)}):C.seafileAPI.updateShareToGroupItemPermission(r,a,"group",o,t).then(function(){n.updateSharedItems(e,t)}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.updateSharedItems=function(e,t){var a=e.group_info.id,r=n.state.sharedItems.map(function(e){var n=e.group_info.id;return a===n&&(e.permission=t),e.is_admin="admin"===t,e});n.setState({sharedItems:r})},n.state={selectedOption:null,errorMsg:[],permission:"rw",sharedItems:[]},n.options=[],n.permissions=[];var a=e.itemType,r=e.isRepoOwner;return"library"===a?n.permissions=r?["rw","r","admin","cloud-edit","preview"]:["rw","r","cloud-edit","preview"]:"dir"===a&&(n.permissions=["rw","r","cloud-edit","preview"]),!n.props.isGroupOwnedRepo&&b.isPro||(n.permissions=["rw","r"]),n}return s(t,e),u(t,[{key:"componentDidMount",value:function(){this.loadOptions(),this.listSharedGroups()}},{key:"render",value:function(){return d.default.createElement(c.Fragment,null,d.default.createElement("table",null,d.default.createElement("thead",null,d.default.createElement("tr",null,d.default.createElement("th",{width:"50%"},(0,b.gettext)("Group")),d.default.createElement("th",{width:"35%"},(0,b.gettext)("Permission")),d.default.createElement("th",{width:"15%"}))),d.default.createElement("tbody",null,d.default.createElement("tr",null,d.default.createElement("td",null,d.default.createElement(g.default,r({isMulti:!0,onChange:this.handleSelectChange,options:this.options,placeholder:(0,b.gettext)("Select groups..."),components:(0,y.default)(),maxMenuHeight:200,inputId:"react-select-2-input",value:this.state.selectedOption},"components",{NoOptionsMessage:M}))),d.default.createElement("td",null,d.default.createElement(P.default,{isTextMode:!1,isEditIconShow:!1,currentPermission:this.state.permission,permissions:this.permissions,onPermissionChanged:this.setPermission})),d.default.createElement("td",null,d.default.createElement(h.Button,{onClick:this.shareToGroup},(0,b.gettext)("Submit")))),this.state.errorMsg.length>0&&this.state.errorMsg.map(function(e,t){var n=e.group_name+": "+e.error_msg;return d.default.createElement("tr",{key:t},d.default.createElement("td",{colSpan:3},d.default.createElement("p",{className:"error"},n)))}))),d.default.createElement("div",{className:"share-list-container"},d.default.createElement("table",{className:"table-thead-hidden"},d.default.createElement("thead",null,d.default.createElement("tr",null,d.default.createElement("th",{width:"50%"},(0,b.gettext)("Group")),d.default.createElement("th",{width:"35%"},(0,b.gettext)("Permission")),d.default.createElement("th",{width:"15%"}))),d.default.createElement(T,{items:this.state.sharedItems,permissions:this.permissions,deleteShareItem:this.deleteShareItem,onChangeUserPermission:this.onChangeUserPermission}))))}}]),t}(d.default.Component);_.propTypes=Y,t.default=_},193:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(9),f=a(p),h=n(169),m=a(h),g=n(6),v=n(2),y=n(4),b=n(3),C=n(170),S=a(C),w=n(5),D=a(w),E=n(12),P=a(E),L=n(114),T=a(L),Y={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired,closeShareDialog:d.default.func.isRequired},M=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onPasswordInputChecked=function(){n.setState({isShowPasswordInput:!n.state.isShowPasswordInput,password:"",passwdnew:"",errorInfo:""})},n.togglePasswordVisible=function(){n.setState({isPasswordVisible:!n.state.isPasswordVisible})},n.generatePassword=function(){var e=b.Utils.generatePassword(v.shareLinkPasswordMinLength);n.setState({password:e,passwdnew:e})},n.inputPassword=function(e){var t=e.target.value.trim();n.setState({password:t})},n.inputPasswordNew=function(e){var t=e.target.value.trim();n.setState({passwdnew:t})},n.setPermission=function(e){"previewAndDownload"==e?n.permissions={can_edit:!1,can_download:!0}:"preview"==e?n.permissions={can_edit:!1,can_download:!1}:"editOnCloudAndDownload"==e&&(n.permissions={can_edit:!0,can_download:!0})},n.generateShareLink=function(){if(n.validateParamsInput()){n.setState({errorInfo:""});var e=n.props,t=e.itemPath,a=e.repoID,r=n.state,o=r.password,i=r.isExpireChecked,s=r.expireDays,l=n.permissions;l=JSON.stringify(l);var u=i?s:"";y.seafileAPI.createShareLink(a,t,o,u,l).then(function(e){var t=new S.default(e.data);n.setState({sharedLinkInfo:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);D.default.danger(t)})}},n.onCopySharedLink=function(){var e=n.state.sharedLinkInfo.link;(0,m.default)(e),D.default.success((0,v.gettext)("Share link is copied to the clipboard.")),n.props.closeShareDialog()},n.onCopyDownloadLink=function(){var e=n.state.sharedLinkInfo.link+"?dl=1";(0,m.default)(e),D.default.success((0,v.gettext)("Direct download link is copied to the clipboard.")),n.props.closeShareDialog()},n.deleteShareLink=function(){var e=n.state.sharedLinkInfo;y.seafileAPI.deleteShareLink(e.token).then(function(){n.setState({password:"",passwordnew:"",isShowPasswordInput:!1,expireDays:n.defaultExpireDays,isExpireChecked:!n.isExpireDaysNoLimit,errorInfo:"",sharedLinkInfo:null,isNoticeMessageShow:!1}),n.permissions={can_edit:!1,can_download:!0}}).catch(function(e){var t=b.Utils.getErrorMsg(e);D.default.danger(t)})},n.onExpireChecked=function(e){n.setState({isExpireChecked:e.target.checked})},n.onExpireDaysChanged=function(e){var t=e.target.value.trim();n.setState({expireDays:t})},n.validateParamsInput=function(){var e=n.state,t=e.isShowPasswordInput,a=e.password,r=e.passwdnew,o=e.isExpireChecked,i=e.expireDays;if(t){if(0===a.length)return n.setState({errorInfo:"Please enter password"}),!1;if(a.length<v.shareLinkPasswordMinLength)return n.setState({errorInfo:"Password is too short"}),!1;if(a!==r)return n.setState({errorInfo:"Passwords don't match"}),!1}var s=/^\d+$/;if(n.isExpireDaysNoLimit){if(o){if(!i)return n.setState({errorInfo:"Please enter days"}),!1;if(!s.test(i))return n.setState({errorInfo:"Please enter a non-negative integer"}),!1;n.setState({expireDays:parseInt(i)})}}else{if(!i)return n.setState({errorInfo:"Please enter days"}),!1;if(!s.test(i))return n.setState({errorInfo:"Please enter a non-negative integer"}),!1;i=parseInt(i);var l=parseInt(v.shareLinkExpireDaysMin),u=parseInt(v.shareLinkExpireDaysMax);if(0!==l&&u!==u&&i<l)return n.setState({errorInfo:"Please enter valid days"}),!1;if(0===l&&0!==u&&i>u)return n.setState({errorInfo:"Please enter valid days"}),!1;if(0!==l&&0!==u&&(i<l||i>u))return n.setState({errorInfo:"Please enter valid days"}),!1;n.setState({expireDays:i})}return!0},n.onNoticeMessageToggle=function(){n.setState({isNoticeMessageShow:!n.state.isNoticeMessageShow})},n.toggleSendLink=function(){n.setState({isSendLinkShown:!n.state.isSendLinkShown})},n.isExpireDaysNoLimit=0===parseInt(v.shareLinkExpireDaysMin)&&0===parseInt(v.shareLinkExpireDaysMax)&&0==v.shareLinkExpireDaysDefault,n.defaultExpireDays=n.isExpireDaysNoLimit?"":v.shareLinkExpireDaysDefault,n.state={isValidate:!1,isShowPasswordInput:!1,isPasswordVisible:!1,isExpireChecked:!n.isExpireDaysNoLimit,password:"",passwdnew:"",expireDays:n.defaultExpireDays,errorInfo:"",sharedLinkInfo:null,isNoticeMessageShow:!1,isLoading:!0,fileInfo:null,isSendLinkShown:!1},n.permissions={can_edit:!1,can_download:!0},n.isOfficeFile=b.Utils.isOfficeFile(n.props.itemPath),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.itemPath,n=this.props.repoID;y.seafileAPI.getShareLink(n,t).then(function(t){if(0!==t.data.length){var n=new S.default(t.data[0]);e.setState({isLoading:!1,sharedLinkInfo:n})}else e.setState({isLoading:!1})}).catch(function(e){var t=b.Utils.getErrorMsg(e);D.default.danger(t)}),this.isOfficeFile&&y.seafileAPI.getFileInfo(n,t).then(function(t){t.data&&e.setState({fileInfo:t.data})}).catch(function(e){var t=b.Utils.getErrorMsg(e);D.default.danger(t)})}},{key:"render",value:function(){var e=this;if(this.state.isLoading)return u.default.createElement(P.default,null);var t=(0,v.gettext)("(at least {passwordLength} characters)");if(t=t.replace("{passwordLength}",v.shareLinkPasswordMinLength),this.state.sharedLinkInfo){var n=this.state.sharedLinkInfo;return u.default.createElement("div",null,u.default.createElement(g.Form,{className:"mb-4"},u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,v.gettext)("Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,n.link)," ",n.is_expired?u.default.createElement("span",{className:"err-message"},"(",(0,v.gettext)("Expired"),")"):u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopySharedLink}))),!n.is_dir&&n.permissions.can_download&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,v.gettext)("Direct Download Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,n.link,"?dl=1")," ",n.is_expired?u.default.createElement("span",{className:"err-message"},"(",(0,v.gettext)("Expired"),")"):u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyDownloadLink}))),n.expire_date&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,v.gettext)("Expiration Date:")),u.default.createElement("dd",null,(0,f.default)(n.expire_date).format("YYYY-MM-DD hh:mm:ss")))),v.canSendShareLinkEmail&&!this.state.isSendLinkShown&&!this.state.isNoticeMessageShow&&u.default.createElement(g.Button,{onClick:this.toggleSendLink,className:"mr-2"},(0,v.gettext)("Send")),this.state.isSendLinkShown&&u.default.createElement(T.default,{linkType:"shareLink",token:n.token,toggleSendLink:this.toggleSendLink,closeShareDialog:this.props.closeShareDialog}),!this.state.isSendLinkShown&&!this.state.isNoticeMessageShow&&u.default.createElement(g.Button,{onClick:this.onNoticeMessageToggle},(0,v.gettext)("Delete")),this.state.isNoticeMessageShow&&u.default.createElement("div",{className:"alert alert-warning"},u.default.createElement("h4",{className:"alert-heading"},(0,v.gettext)("Are you sure you want to delete the share link?")),u.default.createElement("p",{className:"mb-4"},(0,v.gettext)("If the share link is deleted, no one will be able to access it any more.")),u.default.createElement("button",{className:"btn btn-primary",onClick:this.deleteShareLink},(0,v.gettext)("Delete"))," ",u.default.createElement("button",{className:"btn btn-secondary",onClick:this.onNoticeMessageToggle},(0,v.gettext)("Cancel"))))}var a=this.state.fileInfo;return u.default.createElement(g.Form,{className:"generate-share-link"},u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"checkbox",onChange:this.onPasswordInputChecked}),"  ",(0,v.gettext)("Add password protection"))),this.state.isShowPasswordInput&&u.default.createElement(g.FormGroup,{className:"link-operation-content",check:!0},u.default.createElement(g.Label,{className:"font-weight-bold"},(0,v.gettext)("Password"))," ",u.default.createElement("span",{className:"tip"},t),u.default.createElement(g.InputGroup,{className:"passwd"},u.default.createElement(g.Input,{type:this.state.isPasswordVisible?"text":"password",value:this.state.password||"",onChange:this.inputPassword}),u.default.createElement(g.InputGroupAddon,{addonType:"append"},u.default.createElement(g.Button,{onClick:this.togglePasswordVisible},u.default.createElement("i",{className:"link-operation-icon fas "+(this.state.isPasswordVisible?"fa-eye":"fa-eye-slash")})),u.default.createElement(g.Button,{onClick:this.generatePassword},u.default.createElement("i",{className:"link-operation-icon fas fa-magic"})))),u.default.createElement(g.Label,{className:"font-weight-bold"},(0,v.gettext)("Password again")),u.default.createElement(g.Input,{className:"passwd",type:this.state.isPasswordVisible?"text":"password",value:this.state.passwdnew||"",onChange:this.inputPasswordNew})),this.isExpireDaysNoLimit&&u.default.createElement(l.Fragment,null,u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{className:"expire-checkbox",type:"checkbox",onChange:this.onExpireChecked}),"  ",(0,v.gettext)("Add auto expiration"))),this.state.isExpireChecked&&u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{className:"expire-input expire-input-border",type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged,readOnly:!this.state.isExpireChecked}),u.default.createElement("span",{className:"expir-span"},(0,v.gettext)("days"))))),!this.isExpireDaysNoLimit&&u.default.createElement(l.Fragment,null,u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{className:"expire-checkbox",type:"checkbox",onChange:this.onExpireChecked,checked:!0,readOnly:!0,disabled:!0}),"  ",(0,v.gettext)("Add auto expiration"))),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{className:"expire-input expire-input-border",type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged}),u.default.createElement("span",{className:"expir-span"},(0,v.gettext)("days")),0!==parseInt(v.shareLinkExpireDaysMin)&&0!==parseInt(v.shareLinkExpireDaysMax)&&u.default.createElement("span",{className:"d-inline-block ml-7"},"(",v.shareLinkExpireDaysMin," - ",v.shareLinkExpireDaysMax," ",(0,v.gettext)("days"),")"),0!==parseInt(v.shareLinkExpireDaysMin)&&0===parseInt(v.shareLinkExpireDaysMax)&&u.default.createElement("span",{className:"d-inline-block ml-7"},"(",(0,v.gettext)("Greater than or equal to")," ",v.shareLinkExpireDaysMin," ",(0,v.gettext)("days"),")"),0===parseInt(v.shareLinkExpireDaysMin)&&0!==parseInt(v.shareLinkExpireDaysMax)&&u.default.createElement("span",{className:"d-inline-block ml-7"},"(",(0,v.gettext)("Less than or equal to")," ",v.shareLinkExpireDaysMax," ",(0,v.gettext)("days"),")")))),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement("span",null,"  ",(0,v.gettext)("Set permission")))),u.default.createElement(g.FormGroup,{check:!0,className:"permission"},u.default.createElement(g.Label,{className:"form-check-label"},u.default.createElement(g.Input,{type:"radio",name:"radio1",defaultChecked:!0,onChange:function(){return e.setPermission("previewAndDownload")}}),"  ",(0,v.gettext)("Preview and download"))),u.default.createElement(g.FormGroup,{check:!0,className:"permission"},u.default.createElement(g.Label,{className:"form-check-label"},u.default.createElement(g.Input,{type:"radio",name:"radio1",onChange:function(){return e.setPermission("preview")}}),"  ",(0,v.gettext)("Preview only"))),this.isOfficeFile&&a&&a.can_edit&&u.default.createElement(g.FormGroup,{check:!0,className:"permission"},u.default.createElement(g.Label,{className:"form-check-label"},u.default.createElement(g.Input,{type:"radio",name:"radio1",onChange:function(){return e.setPermission("editOnCloudAndDownload")}}),"  ",(0,v.gettext)("Edit on cloud and download"))),this.state.errorInfo&&u.default.createElement(g.Alert,{color:"danger",className:"mt-2"},(0,v.gettext)(this.state.errorInfo)),u.default.createElement(g.Button,{onClick:this.generateShareLink,className:"mt-2"},(0,v.gettext)("Generate")))}}]),t}(u.default.Component);M.propTypes=Y,t.default=M},194:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(169),f=a(p),h=n(9),m=a(h),g=n(6),v=n(2),y=n(4),b=n(3),C=n(171),S=a(C),w=n(5),D=a(w),E=n(114),P=a(E),L=n(172),T=a(L),Y={itemPath:d.default.string.isRequired,repoID:d.default.string.isRequired,closeShareDialog:d.default.func.isRequired},M=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getUploadLink=function(){var e=n.props.itemPath,t=n.props.repoID;y.seafileAPI.getUploadLinks(t,e).then(function(e){if(0!==e.data.length){var t=new S.default(e.data[0]);n.setState({sharedUploadInfo:t})}}).catch(function(e){403===e.response.status&&(D.default.danger(u.default.createElement(T.default,null),{id:"session_expired",duration:3600}),n.props.closeShareDialog())})},n.addPassword=function(){n.setState({showPasswordInput:!n.state.showPasswordInput,password:"",passwdnew:"",errorInfo:""})},n.togglePasswordVisible=function(){n.setState({passwordVisible:!n.state.passwordVisible})},n.generatePassword=function(){var e=b.Utils.generatePassword(v.shareLinkPasswordMinLength);n.setState({password:e,passwordnew:e})},n.inputPassword=function(e){n.setState({password:e.target.value})},n.inputPasswordNew=function(e){n.setState({passwordnew:e.target.value})},n.generateUploadLink=function(){var e=n.props.itemPath,t=n.props.repoID,a=n.state,r=a.password,o=a.expireDays;n.validateParamsInput()&&y.seafileAPI.createUploadLink(t,e,r,o).then(function(e){var t=new S.default(e.data);n.setState({sharedUploadInfo:t})}).catch(function(e){var t=b.Utils.getErrorMsg(e);D.default.danger(t)})},n.validateParamsInput=function(){var e=n.state,t=e.showPasswordInput,a=e.password,r=e.passwordnew,o=e.isExpireChecked,i=e.expireDays;if(t){if(0===a.length)return n.setState({errorInfo:(0,v.gettext)("Please enter password")}),!1;if(a.length<v.shareLinkPasswordMinLength)return n.setState({errorInfo:(0,v.gettext)("Password is too short")}),!1;if(a!==r)return n.setState({errorInfo:(0,v.gettext)("Passwords don't match")}),!1}var s=/^\d+$/;if(o){if(!i)return n.setState({errorInfo:(0,v.gettext)("Please enter days")}),!1;if(!s.test(i))return n.setState({errorInfo:(0,v.gettext)("Please enter a non-negative integer")}),!1;n.setState({expireDays:parseInt(i)})}return!0},n.onExpireChecked=function(e){n.setState({isExpireChecked:e.target.checked})},n.onExpireDaysChanged=function(e){var t=e.target.value.trim();n.setState({expireDays:t})},n.onCopyUploadLink=function(){var e=n.state.sharedUploadInfo.link;(0,f.default)(e),D.default.success((0,v.gettext)("Upload link is copied to the clipboard.")),n.props.closeShareDialog()},n.deleteUploadLink=function(){var e=n.state.sharedUploadInfo;y.seafileAPI.deleteUploadLink(e.token).then(function(){n.setState({showPasswordInput:!1,password:"",passwordnew:"",sharedUploadInfo:null})}).catch(function(e){var t=b.Utils.getErrorMsg(e);D.default.danger(t)})},n.toggleSendLink=function(){n.setState({isSendLinkShown:!n.state.isSendLinkShown})},n.state={showPasswordInput:!1,passwordVisible:!1,password:"",passwdnew:"",sharedUploadInfo:null,isSendLinkShown:!1,isExpireChecked:!1,expireDays:0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getUploadLink()}},{key:"render",value:function(){var e=this.state.isSendLinkShown,t=(0,v.gettext)("(at least {passwordLength} characters)");if(t=t.replace("{passwordLength}",v.shareLinkPasswordMinLength),this.state.sharedUploadInfo){var n=this.state.sharedUploadInfo;return u.default.createElement("div",null,u.default.createElement(g.Form,{className:"mb-4"},u.default.createElement(g.FormGroup,null,u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,v.gettext)("Upload Link:")),u.default.createElement("dd",{className:"d-flex"},u.default.createElement("span",null,n.link),u.default.createElement("span",{className:"far fa-copy action-icon",onClick:this.onCopyUploadLink}))),n.expire_date&&u.default.createElement(g.FormGroup,{className:"mb-0"},u.default.createElement("dt",{className:"text-secondary font-weight-normal"},(0,v.gettext)("Expiration Date:")),u.default.createElement("dd",null,(0,m.default)(n.expire_date).format("YYYY-MM-DD hh:mm:ss")))),v.canSendShareLinkEmail&&!e&&u.default.createElement(g.Button,{onClick:this.toggleSendLink,className:"mr-2"},(0,v.gettext)("Send")),!e&&u.default.createElement(g.Button,{onClick:this.deleteUploadLink},(0,v.gettext)("Delete")),e&&u.default.createElement(P.default,{linkType:"uploadLink",token:n.token,toggleSendLink:this.toggleSendLink,closeShareDialog:this.props.closeShareDialog}))}return u.default.createElement(g.Form,{className:"generate-upload-link"},u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{type:"checkbox",onChange:this.addPassword}),"  ",(0,v.gettext)("Add password protection"))),this.state.showPasswordInput&&u.default.createElement(g.FormGroup,{className:"link-operation-content"},u.default.createElement(g.Label,{className:"font-weight-bold"},(0,v.gettext)("Password"))," ",u.default.createElement("span",{className:"tip"},t),u.default.createElement(g.InputGroup,{className:"passwd"},u.default.createElement(g.Input,{type:this.state.passwordVisible?"text":"password",value:this.state.password||"",onChange:this.inputPassword}),u.default.createElement(g.InputGroupAddon,{addonType:"append"},u.default.createElement(g.Button,{onClick:this.togglePasswordVisible},u.default.createElement("i",{className:"link-operation-icon fas "+(this.state.passwordVisible?"fa-eye":"fa-eye-slash")})),u.default.createElement(g.Button,{onClick:this.generatePassword},u.default.createElement("i",{className:"link-operation-icon fas fa-magic"})))),u.default.createElement(g.Label,{className:"font-weight-bold"},(0,v.gettext)("Password again")),u.default.createElement(g.Input,{className:"passwd",type:this.state.passwordVisible?"text":"password",value:this.state.passwordnew||"",onChange:this.inputPasswordNew})),u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{className:"expire-checkbox",type:"checkbox",onChange:this.onExpireChecked}),"  ",(0,v.gettext)("Add auto expiration"))),this.state.isExpireChecked&&u.default.createElement(g.FormGroup,{check:!0},u.default.createElement(g.Label,{check:!0},u.default.createElement(g.Input,{className:"expire-input expire-input-border",type:"text",value:this.state.expireDays,onChange:this.onExpireDaysChanged,readOnly:!this.state.isExpireChecked}),u.default.createElement("span",{className:"expir-span"},(0,v.gettext)("days")))),this.state.errorInfo&&u.default.createElement(g.Alert,{color:"danger",className:"mt-2"},this.state.errorInfo),u.default.createElement(g.Button,{className:"generate-link-btn",onClick:this.generateUploadLink},(0,v.gettext)("Generate")))}}]),t}(u.default.Component);M.propTypes=Y,t.default=M},195:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(5),h=a(f),m=n(136),g=a(m),v=n(2),y=n(4),b=n(3),C=n(12),S=a(C),w={path:d.default.string.isRequired,repoID:d.default.string.isRequired,direntType:d.default.string},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.copyToClipBoard=function(){(0,g.default)(n.state.smartLink);var e=(0,v.gettext)("Internal link has been copied to clipboard");h.default.success(e)},n.state={smartLink:"",isInternalLoding:!0},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.repoID,a=t.path,r=t.direntType;y.seafileAPI.getInternalLink(n,a,r).then(function(t){e.setState({smartLink:t.data.smart_link,isInternalLoding:!1})}).catch(function(e){var t=b.Utils.getErrorMsg(e);h.default.danger(t)})}},{key:"render",value:function(){return this.state.isInternalLoding?u.default.createElement(S.default,null):u.default.createElement("div",null,u.default.createElement("p",{className:"tip mb-1"},(0,v.gettext)("An internal link is a link to a file or folder that can be accessed by users with read permission to the file or folder.")),u.default.createElement("p",null,u.default.createElement("a",{target:"_blank",href:this.state.smartLink},this.state.smartLink)),u.default.createElement(p.Button,{onClick:this.copyToClipBoard,color:"primary",className:"mt-2"},(0,v.gettext)("Copy")))}}]),t}(u.default.Component);D.propTypes=w,t.default=D},197:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.canUseDOM=void 0;var a=n(518),r=function(e){return e&&e.__esModule?e:{default:e}}(a),o=r.default,i=o.canUseDOM?window.HTMLElement:{};t.canUseDOM=o.canUseDOM;t.default=i},2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dirPath="/",t.gettext=window.gettext,t.siteRoot=window.app.config.siteRoot,t.loginUrl=window.app.config.loginUrl,t.avatarInfo=window.app.config.avatarInfo,t.logoPath=window.app.config.logoPath,t.mediaUrl=window.app.config.mediaUrl,t.siteTitle=window.app.config.siteTitle,t.siteName=window.app.config.siteName,t.logoWidth=window.app.config.logoWidth,t.logoHeight=window.app.config.logoHeight,t.isPro="True"===window.app.config.isPro,t.isDocs="True"===window.app.config.isDocs,t.lang=window.app.config.lang,t.fileServerRoot=window.app.config.fileServerRoot,t.seafileVersion=window.app.config.seafileVersion,t.serviceURL=window.app.config.serviceURL,t.appAvatarURL=window.app.config.avatarURL,t.seafileCollabServer=window.app.pageOptions.seafileCollabServer,t.name=window.app.pageOptions.name,t.contactEmail=window.app.pageOptions.contactEmail,t.username=window.app.pageOptions.username,t.canAddRepo=window.app.pageOptions.canAddRepo,t.canAddGroup=window.app.pageOptions.canAddGroup,t.canGenerateShareLink=window.app.pageOptions.canGenerateShareLink,t.canGenerateUploadLink=window.app.pageOptions.canGenerateUploadLink,t.canSendShareLinkEmail=window.app.pageOptions.canSendShareLinkEmail,t.canViewOrg="True"===window.app.pageOptions.canViewOrg,t.fileAuditEnabled=window.app.pageOptions.fileAuditEnabled,t.enableFileComment=!!window.app.pageOptions.enableFileComment,t.folderPermEnabled=window.app.pageOptions.folderPermEnabled,t.enableResetEncryptedRepoPassword="True"===window.app.pageOptions.enableResetEncryptedRepoPassword,t.isEmailConfigured="True"===window.app.pageOptions.isEmailConfigured,t.enableUploadFolder="True"===window.app.pageOptions.enableUploadFolder,t.enableResumableFileUpload="True"===window.app.pageOptions.enableResumableFileUpload,t.resumableUploadFileBlockSize=window.app.pageOptions.resumableUploadFileBlockSize,t.storages=window.app.pageOptions.storages,t.enableRepoSnapshotLabel=window.app.pageOptions.enableRepoSnapshotLabel,t.shareLinkPasswordMinLength=window.app.pageOptions.shareLinkPasswordMinLength,t.shareLinkExpireDaysMin=window.app.pageOptions.shareLinkExpireDaysMin,t.shareLinkExpireDaysMax=window.app.pageOptions.shareLinkExpireDaysMax,t.shareLinkExpireDaysDefault=window.app.pageOptions.shareLinkExpireDaysDefault,t.maxFileName=window.app.pageOptions.maxFileName,t.enableWiki=window.app.pageOptions.enableWiki,t.canPublishRepo=window.app.pageOptions.canPublishRepo,t.enableEncryptedLibrary=window.app.pageOptions.enableEncryptedLibrary,t.enableRepoHistorySetting=window.app.pageOptions.enableRepoHistorySetting,t.isSystemStaff=window.app.pageOptions.isSystemStaff,t.thumbnailSizeForOriginal=window.app.pageOptions.thumbnailSizeForOriginal,t.repoPasswordMinLength=window.app.pageOptions.repoPasswordMinLength,t.canAddPublicRepo=window.app.pageOptions.canAddPublicRepo,t.canInvitePeople=window.app.pageOptions.canInvitePeople,t.canLockUnlockFile=window.app.pageOptions.canLockUnlockFile,t.curNoteMsg=window.app.pageOptions.curNoteMsg,t.curNoteID=window.app.pageOptions.curNoteID,t.workspaceID=window.app.pageOptions.workspaceID,t.slug=window.wiki?window.wiki.config.slug:"",t.repoID=window.wiki?window.wiki.config.repoId:"",t.initialPath=window.wiki?window.wiki.config.initial_path:"",t.permission=window.wiki?"True"===window.wiki.config.permission:"",t.isDir=window.wiki?window.wiki.config.isDir:"",t.serviceUrl=window.wiki?window.wiki.config.serviceUrl:"",t.isPublicWiki=window.wiki?"True"===window.wiki.config.isPublicWiki:"",t.sharedToken=window.wiki?window.wiki.config.sharedToken:"",t.sharedType=window.wiki?window.wiki.config.sharedType:"",t.hasIndex=window.wiki?window.wiki.config.hasIndex:"",t.PER_PAGE=25,t.historyRepoID=window.fileHistory?window.fileHistory.pageOptions.repoID:"",t.repoName=window.fileHistory?window.fileHistory.pageOptions.repoName:"",t.filePath=window.fileHistory?window.fileHistory.pageOptions.filePath:"",t.fileName=window.fileHistory?window.fileHistory.pageOptions.fileName:"",t.useNewAPI=window.fileHistory?window.fileHistory.pageOptions.use_new_api:"",t.canDownload=window.fileHistory?window.fileHistory.pageOptions.can_download_file:"",t.canCompare=window.fileHistory?window.fileHistory.pageOptions.can_compare:"",t.draftFilePath=window.draft?window.draft.config.draftFilePath:"",t.draftOriginFilePath=window.draft?window.draft.config.draftOriginFilePath:"",t.draftFileName=window.draft?window.draft.config.draftFileName:"",t.draftID=window.draft?window.draft.config.draftID:"",t.draftRepoID=window.draft?window.draft.config.draftRepoID:"",t.author=window.draft?window.draft.config.author:"",t.authorAvatar=window.draft?window.draft.config.authorAvatar:"",t.originFileExists=window.draft?window.draft.config.originFileExists:"",t.draftFileExists=window.draft?window.draft.config.draftFileExists:"",t.draftStatus=window.draft?window.draft.config.draftStatus:"",t.draftPublishVersion=window.draft?window.draft.config.draftPublishVersion:"",t.originFileVersion=window.draft?window.draft.config.originFileVersion:"",t.filePermission=window.draft?window.draft.config.perm:"",t.orgID=window.org?window.org.pageOptions.orgID:"",t.invitationLink=window.org?window.org.pageOptions.invitationLink:"",t.orgMemberQuotaEnabled=window.org?window.org.pageOptions.orgMemberQuotaEnabled:"",t.constanceEnabled=window.sysadmin?window.sysadmin.pageOptions.constance_enabled:"",t.multiTenancy=window.sysadmin?window.sysadmin.pageOptions.multi_tenancy:"",t.multiInstitution=window.sysadmin?window.sysadmin.pageOptions.multi_institution:"",t.sysadminExtraEnabled=window.sysadmin?window.sysadmin.pageOptions.sysadmin_extra_enabled:"",t.enableGuestInvitation=window.sysadmin?window.sysadmin.pageOptions.enable_guest_invitation:"",t.enableTermsAndConditions=window.sysadmin?window.sysadmin.pageOptions.enable_terms_and_conditions:"",t.isDefaultAdmin=window.sysadmin?window.sysadmin.pageOptions.is_default_admin:"",t.enableFileScan=window.sysadmin?window.sysadmin.pageOptions.enable_file_scan:"",t.canViewSystemInfo=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_system_info:"",t.canViewStatistic=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_statistic:"",t.canConfigSystem=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_config_system:"",t.canManageLibrary=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_library:"",t.canManageUser=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_user:"",t.canManageGroup=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_manage_group:"",t.canViewUserLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_user_log:"",t.canViewAdminLog=window.sysadmin?window.sysadmin.pageOptions.admin_permissions.can_view_admin_log:"",t.enableWorkWeixin=window.sysadmin?window.sysadmin.pageOptions.enable_work_weixin:""},213:function(e,t,n){"use strict";function a(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,a=void 0;"function"===typeof window.CustomEvent?a=new window.CustomEvent(e,{detail:t}):(a=document.createEvent("CustomEvent"),a.initCustomEvent(e,!1,!0,t)),n&&(n.dispatchEvent(a),(0,s.default)(l.store,t))}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];a(u,(0,s.default)({},e,{type:u}),t)}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments[1];a(c,(0,s.default)({},e,{type:c}),t)}Object.defineProperty(t,"__esModule",{value:!0}),t.MENU_HIDE=t.MENU_SHOW=void 0,t.dispatchGlobalEvent=a,t.showMenu=r,t.hideMenu=o;var i=n(34),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=n(291),u=t.MENU_SHOW="REACT_CONTEXTMENU_SHOW",c=t.MENU_HIDE="REACT_CONTEXTMENU_HIDE"},224:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(57),g=a(m),v=n(5),y=a(v),b=n(3);n(137);var C={participant:d.default.object.isRequired,deleteFileParticipant:d.default.func.isRequired},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseOver=function(){n.setState({isOperationShow:!0})},n.onMouseLeave=function(){n.setState({isOperationShow:!1})},n.state={isOperationShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.participant;return u.default.createElement("div",{className:"participant-select-info",onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave},u.default.createElement("div",{className:"d-flex",style:{maxWidth:"90%"}},u.default.createElement("img",{className:"avatar participant-select-avatar",src:e.avatar_url,alt:""}),u.default.createElement("span",{className:"participant-select-name ellipsis"},e.name)),u.default.createElement("i",{className:"action-icon sf2-icon-x3 "+(!this.state.isOperationShow&&"o-hidden"),title:(0,f.gettext)("Delete"),onClick:this.props.deleteFileParticipant.bind(this,e.email)}))}}]),t}(l.Component);S.propTypes=C;var w={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleFileParticipantDialog:d.default.func.isRequired,fileParticipantList:d.default.array.isRequired,onParticipantsChange:d.default.func},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.setState({selectedOption:e})},n.deleteFileParticipant=function(e){var t=n.props,a=t.repoID,r=t.filePath;h.seafileAPI.deleteFileParticipant(a,r,e).then(function(e){n.props.onParticipantsChange(a,r)}).catch(function(e){var t=b.Utils.getErrorMsg(e);y.default.danger(t)}),n.refs.userSelect.clearSelect()},n.addFileParticipant=function(){var e=n.state.selectedOption,t=n.props,a=t.repoID,r=t.filePath;if(e&&0!==e.length){var o=e.map(function(e){return e.email});h.seafileAPI.addFileParticipants(a,r,o).then(function(e){n.props.onParticipantsChange(a,r)}).catch(function(e){y.default.danger(b.Utils.getErrorMsg(e))}),n.setState({selectedOption:null}),n.refs.userSelect.clearSelect()}},n.state={selectedOption:null},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props.fileParticipantList.map(function(t,n){return u.default.createElement(S,{key:n,participant:t,deleteFileParticipant:e.deleteFileParticipant})});return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleFileParticipantDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleFileParticipantDialog},(0,f.gettext)("Participants")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{className:"participant-add"},u.default.createElement(g.default,{ref:"userSelect",isMulti:!0,className:"participant-select",placeholder:(0,f.gettext)("Select users..."),onSelectChange:this.handleSelectChange}),u.default.createElement(p.Button,{className:"btn btn-secondary ml-2",onClick:this.addFileParticipant},(0,f.gettext)("Add"))),t),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleFileParticipantDialog},(0,f.gettext)("Close"))))}}]),t}(l.Component);D.propTypes=w,t.default=D},227:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f={onCloseSidePanel:d.default.func,showCloseSidePanelIcon:d.default.bool},h=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.closeSide=function(){a.props.onCloseSidePanel()},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"top-logo"},u.default.createElement("a",{href:p.siteRoot,id:"logo"},u.default.createElement("img",{src:p.mediaUrl+p.logoPath,height:p.logoHeight,width:p.logoWidth,title:p.siteTitle,alt:"logo"})),this.props.showCloseSidePanelIcon&&u.default.createElement("a",{className:"sf2-icon-x1 sf-popover-close side-panel-close action-icon d-md-none",onClick:this.closeSide,title:"Close","aria-label":"Close"}))}}]),t}(u.default.Component);h.propTypes=f,t.default=h},228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(2),r={NEW_FOLDER:{key:"New Folder",value:(0,a.gettext)("New Folder")},NEW_FILE:{key:"New File",value:(0,a.gettext)("New File")},SHARE:{key:"Share",value:(0,a.gettext)("Share")},DOWNLOAD:{key:"Download",value:(0,a.gettext)("Download")},DELETE:{key:"Delete",value:(0,a.gettext)("Delete")},RENAME:{key:"Rename",value:(0,a.gettext)("Rename")},MOVE:{key:"Move",value:(0,a.gettext)("Move")},COPY:{key:"Copy",value:(0,a.gettext)("Copy")},PERMISSION:{key:"Permission",value:(0,a.gettext)("Permission")},DETAILS:{key:"Details",value:(0,a.gettext)("Details")},OPEN_VIA_CLIENT:{key:"Open via Client",value:(0,a.gettext)("Open via Client")},LOCK:{key:"Lock",value:(0,a.gettext)("Lock")},UNLOCK:{key:"Unlock",value:(0,a.gettext)("Unlock")},COMMENT:{key:"Comment",value:(0,a.gettext)("Comment")},HISTORY:{key:"History",value:(0,a.gettext)("History")},ACCESS_LOG:{key:"Access Log",value:(0,a.gettext)("Access Log")},TAGS:{key:"Tags",value:(0,a.gettext)("Tags")},RELATED_FILES:{key:"Related Files",value:(0,a.gettext)("Related Files")}};t.default=r},2289:function(e,t,n){n(27),e.exports=n(2290)},229:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(24),h=a(f),m=n(224),g=a(m),v=n(2);n(137);var y={onParticipantsChange:d.default.func.isRequired,participants:d.default.array.isRequired,repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,showIconTip:d.default.bool.isRequired},b=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleDialog=function(){n.setState({showDialog:!n.state.showDialog})},n.tooltipToggle=function(){n.setState({tooltipOpen:!n.state.tooltipOpen})},n.state={showDialog:!1,tooltipOpen:!1},n.targetID="add-participant-icon",n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.targetID=this.targetID+Math.floor(1e3*Math.random())}},{key:"render",value:function(){var e=this.props,t=e.participants,n=e.repoID,a=e.filePath,r=e.showIconTip;return u.default.createElement("div",{className:"participants mb-2 position-relative"},t.map(function(e,t){return u.default.createElement(S,{item:e,index:t,key:t})}),u.default.createElement("span",{className:"add-participants",onClick:this.toggleDialog,id:this.targetID},u.default.createElement("i",{className:"fas fa-plus-circle"})),r&&u.default.createElement(p.Tooltip,{toggle:this.tooltipToggle,delay:{show:0,hide:0},target:this.targetID,placement:"bottom",isOpen:this.state.tooltipOpen},(0,v.gettext)("Add participants")),this.state.showDialog&&u.default.createElement(h.default,null,u.default.createElement(g.default,{repoID:n,filePath:a,toggleFileParticipantDialog:this.toggleDialog,fileParticipantList:t,onParticipantsChange:this.props.onParticipantsChange})))}}]),t}(u.default.Component);b.propTypes=y;var C={index:d.default.number.isRequired,item:d.default.object.isRequired},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggleAvatarTooltip=function(){n.setState({showAvatarTooltip:!n.state.showAvatarTooltip})},n.state={showAvatarTooltip:!1},n.targetID="participant-avatar-",n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.targetID=this.targetID+this.props.index+Math.floor(1e3*Math.random())}},{key:"render",value:function(){var e=this.props,t=e.item,n=e.index;return u.default.createElement("span",{className:"participant-avatar"},u.default.createElement("img",{src:t.avatar_url,className:"avatar",id:this.targetID,alt:"avatar",key:n}),u.default.createElement(p.Tooltip,{toggle:this.toggleAvatarTooltip,delay:{show:0,hide:0},target:this.targetID,placement:"bottom",isOpen:this.state.showAvatarTooltip},t.name))}}]),t}(u.default.Component);S.propTypes=C,t.default=b},2290:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var l=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),u=n(0),c=a(u),d=n(7),p=a(d),f=n(9),h=a(f),m=n(2),g=n(4),v=n(3),y=n(1058),b=a(y),C=n(2291),S=a(C),w=n(2292),D=a(w),E=n(37),P=a(E),L=n(82),T=a(L),Y=n(5),M=a(Y),_=n(1091),k=a(_),Z=n(24),N=a(Z),I=n(43),R=a(I),O=n(71),F=a(O),X=n(320),J=a(X),x=n(85),H=a(x);n(157),n(158),n(159),n(160),n(1056),n(1057),n(104),n(129);var B=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getGroupInfo=function(e){g.seafileAPI.getGroup(e).then(function(e){-1!=e.data.admins.indexOf(m.username)&&n.setState({isDepartmentAdmin:!0})})},n.onRepoUpdateEvent=function(){var e=new Date;if(!(parseFloat(e-n.lastModifyTime)/1e3<=5)){var t=n.state,a=t.path,r=t.dirID;g.seafileAPI.dirMetaData(m.repoID,a).then(function(e){e.data.id!==r&&M.default.notify(c.default.createElement("span",null,(0,m.gettext)("This folder has been updated. "),c.default.createElement("a",{href:""},(0,m.gettext)("Refresh"))),{id:"repo_updated",duration:3600})})}},n.loadWikiData=function(){b.default.watchRepo(m.repoID,n.onRepoUpdateEvent),n.updateUsedRepoTags(),m.isDocs&&g.seafileAPI.getRepoDraftCounts(m.repoID).then(function(e){n.setState({draftCounts:e.data.draft_counts})}),n.loadSidePanel(m.initialPath),"None"===m.isDir?n.setState({pathExist:!1}):"True"===m.isDir?n.showDir(m.initialPath):"False"===m.isDir&&n.showFile(m.initialPath)},n.loadSidePanel=function(e){"/"===e||"None"===m.isDir?g.seafileAPI.listDir(m.repoID,"/").then(function(e){var t=n.state.treeData;n.addResponseListToNode(e.data.dirent_list,t.root),n.setState({isTreeDataLoading:!1,treeData:t})}).catch(function(){n.setState({isLoadFailed:!0})}):n.loadNodeAndParentsByPath(e)},n.showDir=function(e){n.loadDirentList(e),n.setState({path:e,isViewFile:!1});var t=m.siteRoot+"wiki/lib/"+m.repoID+v.Utils.encodePath(e);window.history.pushState({url:t,path:e},e,t)},n.showFile=function(e){n.setState({path:e,isViewFile:!0}),n.setState({isFileLoading:!0}),g.seafileAPI.getFileInfo(m.repoID,e).then(function(t){var a=t.data,r=a.mtime,o=a.permission,i=a.last_modifier_name,s=a.is_draft,l=a.has_draft,u=a.draft_id;g.seafileAPI.getFileDownloadLink(m.repoID,e).then(function(e){g.seafileAPI.getFileContent(e.data).then(function(e){n.setState({content:e.data,permission:o,latestContributor:i,lastModified:h.default.unix(r).fromNow(),isFileLoading:!1,isDraft:s,hasDraft:l,draftID:u})})})});var t=m.siteRoot+"wiki/lib/"+m.repoID+v.Utils.encodePath(e);window.history.pushState({url:t,path:e},e,t)},n.updateReadmeMarkdown=function(e){n.setState({readmeMarkdown:null}),e.some(function(e){var t=e.name.toLowerCase();if("readme.md"===t||"readme.markdown"===t)return n.setState({readmeMarkdown:e}),!0})},n.loadDirentList=function(e){n.setState({isDirentListLoading:!0}),g.seafileAPI.listDir(m.repoID,e,{with_thumbnail:!0}).then(function(t){var a=[];t.data.dirent_list.forEach(function(e){var t=e.name.toLowerCase();"readme.md"!==t&&"readme.markdown"!==t||n.setState({readmeMarkdown:e});var r=new R.default(e);a.push(r)}),n.setState({userPerm:t.data.user_perm,direntList:v.Utils.sortDirents(a,n.state.sortBy,n.state.sortOrder),isDirentListLoading:!1,dirID:t.data.dir_id}),!n.state.repoEncrypted&&a.length&&n.getThumbnails(m.repoID,e,n.state.direntList)})},n.getThumbnails=function(e,t,a){var r=a.filter(function(e){return v.Utils.imageCheck(e.name)&&!e.encoded_thumbnail_src});if(0!=r.length){var o=n,i=r.length;!function n(s){var l=r[s],u=[t,l.name].join("/");g.seafileAPI.createThumbnail(e,u,48).then(function(e){l.encoded_thumbnail_src=e.data.encoded_thumbnail_src}).catch(function(e){}).then(function(){s<i-1?n(++s):o.setState({direntList:a})})}(0)}},n.onLinkClick=function(e){var t=e;if(v.Utils.isInternalMarkdownLink(t,m.repoID)){var a=v.Utils.getPathFromInternalMarkdownLink(t,m.repoID);n.showFile(a)}else if(v.Utils.isInternalDirLink(t,m.repoID)){var r=v.Utils.getPathFromInternalDirLink(t,m.repoID);n.showDir(r)}else window.open(t)},n.updateUsedRepoTags=function(){g.seafileAPI.listRepoTags(m.repoID).then(function(e){var t=[];e.data.repo_tags.forEach(function(e){var n=new J.default(e);n.fileCount>0&&t.push(n)}),n.setState({usedRepoTags:t})})},n.updateDirent=function(e,t,a){var r=n.state.direntList.map(function(n){return n.name===e.name&&(n[t]=a),n});n.setState({direntList:r})},n.onpopstate=function(e){if(e.state&&e.state.path){var t=e.state.path;v.Utils.isMarkdownFile(t)?n.showFile(t):(n.loadDirentList(t),n.setState({path:t,isViewFile:!1}))}},n.onSearchedClick=function(e){var t=e.is_dir?e.path.slice(0,e.path.length-1):e.path;if(n.state.currentPath!==t){for(var a=-1,r=v.Utils.getPaths(t),o=0;o<r.length;o++){var i=n.state.treeData.getNodeByPath(i);if(!i){a=o;break}}if(-1===a){var s=n.state.treeData.getNodeByPath(t);n.setState({currentNode:s})}else n.loadNodeAndParentsByPath(t);if(e.is_dir)n.showDir(t);else if(v.Utils.isMarkdownFile(t))n.showFile(t);else{var l=m.siteRoot+"lib/"+e.repo_id+"/file"+v.Utils.encodePath(t),u=window.open("about:blank");u.location.href=l}}},n.onMainNavBarClick=function(e){n.resetSelected();var t=n.state.treeData.clone(),a=t.getNodeByPath(e);t.expandNode(a),n.setState({treeData:t,currentNode:a}),n.showDir(a.path)},n.onAddFolder=function(e){g.seafileAPI.createDir(m.repoID,e).then(function(){var t=v.Utils.getFileName(e),a=v.Utils.getDirName(e);n.addNodeToTree(t,a,"dir"),a!==n.state.path||n.state.isViewFile||n.addDirent(t,"dir")}).catch(function(){})},n.onAddFile=function(e,t){g.seafileAPI.createFile(m.repoID,e,t).then(function(t){var a=v.Utils.getFileName(e),r=v.Utils.getDirName(e);n.addNodeToTree(a,r,"file"),r!==n.state.path||n.state.isViewFile||n.addDirent(a,"file",t.data.size)}).catch(function(){})},n.onRenameTreeNode=function(e,t){n.renameItem(e.path,e.object.isDir(),t)},n.onDeleteTreeNode=function(e){n.deleteItem(e.path,e.object.isDir())},n.onMainPanelItemRename=function(e,t){var a=v.Utils.joinPath(n.state.path,e.name);n.renameItem(a,e.isDir(),t)},n.onMainPanelItemDelete=function(e){var t=v.Utils.joinPath(n.state.path,e.name);n.deleteItem(t,e.isDir())},n.renameItem=function(e,t,a){t?g.seafileAPI.renameDir(m.repoID,e,a).then(function(){n.renameItemAjaxCallback(e,a)}).catch(function(){}):g.seafileAPI.renameFile(m.repoID,e,a).then(function(){n.renameItemAjaxCallback(e,a)}).catch(function(){})},n.onMoveItem=function(e,t,a){var r=t.name,o=v.Utils.joinPath(n.state.path,r);g.seafileAPI.moveDir(m.repoID,e.repo_id,a,n.state.path,r).then(function(t){var i=t.data[0].obj_name;n.moveTreeNode(o,a,e,i),n.moveDirent(o);var s=(0,m.gettext)("Successfully moved %(name)s.");s=s.replace("%(name)s",r),M.default.success(s)}).catch(function(){var e=(0,m.gettext)("Failed to move %(name)s");e=e.replace("%(name)s",r),M.default.danger(e)})},n.onCopyItem=function(e,t,a){var r=t.name,o=v.Utils.joinPath(n.state.path,r);g.seafileAPI.copyDir(m.repoID,e.repo_id,a,n.state.path,r).then(function(t){var i=t.data[0].obj_name;n.copyTreeNode(o,a,e,i);var s=(0,m.gettext)("Successfully copied %(name)s.");s=s.replace("%(name)s",r),M.default.success(s)}).catch(function(){var e=(0,m.gettext)("Failed to copy %(name)s");e=e.replace("%(name)s",r),M.default.danger(e)})},n.onMoveItems=function(e,t){var a=n.getSelectedDirentPaths(),r=n.getSelectedDirentNames();g.seafileAPI.moveDir(m.repoID,e.repo_id,t,n.state.path,r).then(function(o){var i=o.data.map(function(e){return e.obj_name});a.forEach(function(a,r){n.moveTreeNode(a,t,e,i[r]),n.moveDirent(a)});var s=v.Utils.getMoveSuccessMessage(r);M.default.success(s)}).catch(function(){var e=v.Utils.getMoveFailedMessage(r);M.default.danger(e)})},n.onCopyItems=function(e,t){var a=n.getSelectedDirentPaths(),r=n.getSelectedDirentNames();g.seafileAPI.copyDir(m.repoID,e.repo_id,t,n.state.path,r).then(function(o){var i=o.data.map(function(e){return e.obj_name});a.forEach(function(a,r){n.copyTreeNode(a,t,e,i[r])});var s=v.Utils.getCopySuccessfulMessage(r);M.default.success(s)}).catch(function(){var e=v.Utils.getCopyFailedMessage(r);M.default.danger(e)})},n.onDeleteItems=function(){var e=n.getSelectedDirentPaths(),t=n.getSelectedDirentNames();g.seafileAPI.deleteMutipleDirents(m.repoID,n.state.path,t).then(function(t){e.forEach(function(e){n.deleteTreeNode(e),n.deleteDirent(e)})})},n.onDirentClick=function(e){n.resetSelected();var t=v.Utils.joinPath(n.state.path,e.name);if(e.isDir())n.loadTreeNodeByPath(t),n.showDir(t);else if(v.Utils.isMarkdownFile(t))n.showFile(t);else{var a=window.open("about:blank"),r=m.siteRoot+"lib/"+m.repoID+"/file"+v.Utils.encodePath(t);a.location.href=r}},n.onDirentSelected=function(e){var t=n.state.direntList.map(function(t){return t.name===e.name&&(t.isSelected=!t.isSelected),t}),a=t.filter(function(e){return e.isSelected});a.length?(n.setState({isDirentSelected:!0}),a.length===t.length?n.setState({isAllDirentSelected:!0,direntList:t,selectedDirentList:a}):n.setState({isAllDirentSelected:!1,direntList:t,selectedDirentList:a})):n.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:t,selectedDirentList:[]})},n.onAllDirentSelected=function(){if(n.state.isAllDirentSelected){var e=n.state.direntList.map(function(e){return e.isSelected=!1,e});n.setState({isDirentSelected:!1,isAllDirentSelected:!1,direntList:e,selectedDirentList:[]})}else{var t=n.state.direntList.map(function(e){return e.isSelected=!0,e});n.setState({isDirentSelected:!0,isAllDirentSelected:!0,direntList:t,selectedDirentList:t})}},n.onFileTagChanged=function(e,t){g.seafileAPI.listFileTags(m.repoID,t).then(function(t){var a=t.data.file_tags.map(function(e){return new F.default(e)});n.updateDirent(e,"file_tags",a)}),n.updateUsedRepoTags()},n.onFileUploadSuccess=function(e){if(n.state.direntList.some(function(t){return t.name===e.name&&t.type===e.type}))for(var t=n.state.direntList,a=0;a<t.length;a++){var o=t[a];if(o.name===e.name&&o.type===e.type){var i=h.default.unix(e.mtime).fromNow();n.updateDirent(o,"mtime",i);break}}else{e.permission="rw";var s=new R.default(e);n.addNodeToTree(s.name,n.state.path,s.type),"dir"===e.type?n.setState({direntList:[s].concat(r(n.state.direntList))}):(n.setState({direntList:[].concat(r(n.state.direntList),[s])}),n.updateReadmeMarkdown(n.state.direntList))}},n.addDirent=function(e,t,a){var r=n.createDirent(e,t,a),o=n.state.direntList;if("dir"===t)o.unshift(r);else{var i=o.length;if(0===i||"dir"===o[i-1].type)o.push(r);else{for(var s=0,l=0;l<=i;l++)if("file"===o[l].type){s=l;break}o.splice(s,0,r)}}n.setState({direntList:o}),n.updateReadmeMarkdown(o)},n.renameDirent=function(e,t){var a=v.Utils.getDirName(e),r=v.Utils.joinPath(a,t);if(e===n.state.path){n.setState({path:r});var o=m.siteRoot+"wiki/lib/"+m.repoID+r;window.history.replaceState({url:o,path:r},r,o)}else if(v.Utils.isChildPath(e,n.state.path)){var i=v.Utils.getFileName(e),s=n.state.direntList.map(function(e){return e.name===i&&(e.name=t),e});n.setState({direntList:s}),n.updateReadmeMarkdown(s)}else if(v.Utils.isAncestorPath(e,n.state.path)){var l=v.Utils.renameAncestorPath(n.state.path,e,r);n.setState({path:l})}},n.moveDirent=function(e){var t=e.slice(e.lastIndexOf("/")+1),a=n.state.direntList.filter(function(e){return e.name!==t});n.setState({direntList:a}),n.updateReadmeMarkdown(a)},n.onSideNavMenuClick=function(){n.setState({closeSideBar:!n.state.closeSideBar})},n.onCloseSide=function(){n.setState({closeSideBar:!n.state.closeSideBar})},n.loadTreeNodeByPath=function(e){var t=n.state.treeData.clone(),a=t.getNodeByPath(e);if(a.isLoaded){t.getNodeByPath(a.parentNode.path).isExpanded=!0,n.setState({treeData:t,currentNode:a})}else g.seafileAPI.listDir(m.repoID,a.path).then(function(e){n.addResponseListToNode(e.data.dirent_list,a),t.getNodeByPath(a.parentNode.path).isExpanded=!0,n.setState({treeData:t,currentNode:a})})},n.loadNodeAndParentsByPath=function(e){var t=n.state.treeData.clone();v.Utils.isMarkdownFile(e)&&(e=v.Utils.getDirName(e)),g.seafileAPI.listDir(m.repoID,e,{with_parents:!0}).then(function(e){for(var a=e.data.dirent_list,r={},o=0;o<a.length;o++){var i=a[o],s=i.parent_dir;r[s]||(r[s]=[]),r[s].push(i)}for(var l in r){var u=t.getNodeByPath(l);u.isLoaded||n.addResponseListToNode(r[l],u)}n.setState({isTreeDataLoading:!1,treeData:t})}).catch(function(){n.setState({isLoadFailed:!0})})},n.onTreeNodeClick=function(e){if(n.resetSelected(),n.state.pathExist||n.setState({pathExist:!0}),e.object.isDir()){if(!e.isLoaded){var t=n.state.treeData.clone();e=t.getNodeByPath(e.path),g.seafileAPI.listDir(m.repoID,e.path).then(function(a){n.addResponseListToNode(a.data.dirent_list,e),t.collapseNode(e),n.setState({treeData:t})})}if(e.path===n.state.path)if(e.isExpanded){var a=T.default.collapseNode(n.state.treeData,e);n.setState({treeData:a})}else{var r=n.state.treeData.clone();e=r.getNodeByPath(e.path),r.expandNode(e),n.setState({treeData:r})}}if(e.path!==n.state.path)if(e.object.isDir())n.showDir(e.path);else if(v.Utils.isMarkdownFile(e.path))e.path!==n.state.path&&n.showFile(e.path);else{var o=window.open("about:blank"),i=m.siteRoot+"lib/"+m.repoID+"/file"+v.Utils.encodePath(e.path);o.location.href=i}},n.onTreeNodeCollapse=function(e){var t=T.default.collapseNode(n.state.treeData,e);n.setState({treeData:t})},n.onTreeNodeExpanded=function(e){var t=n.state.treeData.clone();e=t.getNodeByPath(e.path),e.isLoaded?(t.expandNode(e),n.setState({treeData:t})):g.seafileAPI.listDir(m.repoID,e.path).then(function(a){n.addResponseListToNode(a.data.dirent_list,e),n.setState({treeData:t})})},n.addNodeToTree=function(e,t,a){var r=n.createTreeNode(e,a),o=T.default.addNodeToParentByPath(n.state.treeData,r,t);n.setState({treeData:o})},n.renameTreeNode=function(e,t){var a=T.default.renameNodeByPath(n.state.treeData,e,t);n.setState({treeData:a})},n.deleteTreeNode=function(e){var t=T.default.deleteNodeByPath(n.state.treeData,e);n.setState({treeData:t})},n.moveTreeNode=function(e,t,a,r){if(m.repoID!==a.repo_id){var o=T.default.deleteNodeByPath(n.state.treeData,e);return void n.setState({treeData:o})}var i=T.default.moveNodeByPath(n.state.treeData,e,t,r);n.setState({treeData:i})},n.copyTreeNode=function(e,t,a,r){if(m.repoID===a.repo_id){var o=T.default.copyNodeByPath(n.state.treeData,e,t,r);n.setState({treeData:o})}},n.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map(function(e){return new R.default(e)});n=v.Utils.sortDirents(n,"name","asc");var a=n.map(function(e){return new P.default({object:e})});t.addChildren(a)},n.getSelectedDirentPaths=function(){var e=[];return n.state.selectedDirentList.forEach(function(t){e.push(v.Utils.joinPath(n.state.path,t.name))}),e},n.getSelectedDirentNames=function(){var e=[];return n.state.selectedDirentList.forEach(function(t){e.push(t.name)}),e},n.resetSelected=function(){n.setState({isDirentSelected:!1,isAllDirentSelected:!1})},n.onLibDecryptDialog=function(){n.setState({libNeedDecrypt:!1}),n.loadWikiData()},n.goDraftPage=function(){window.location.href=m.siteRoot+"drafts/"+n.state.draftID+"/"},n.sortItems=function(e,t){n.setState({sortBy:e,sortOrder:t,items:v.Utils.sortDirents(n.state.direntList,e,t)})},n.state={repoName:"",repoEncrypted:!1,isGroupOwnedRepo:!1,isAdmin:!1,ownerEmail:"",userPerm:"",path:"",pathExist:!0,treeData:T.default.buildTree(),closeSideBar:!1,currentNode:null,isTreeDataLoading:!0,isDirentListLoading:!0,isViewFile:!1,sortBy:"name",sortOrder:"asc",direntList:[],isFileLoading:!0,content:"",lastModified:"",latestContributor:"",permission:"",isDirentSelected:!1,isAllDirentSelected:!1,selectedDirentList:[],libNeedDecrypt:!1,isDraft:!1,hasDraft:!1,draftID:"",dirID:"",usedRepoTags:[],readmeMarkdown:null,draftCounts:0},window.onpopstate=n.onpopstate,n.hash="",n.lastModifyTime=new Date,n}return s(t,e),l(t,[{key:"componentWillMount",value:function(){var e=window.location.hash;"#"===e.slice(0,1)&&(this.hash=e)}},{key:"componentDidMount",value:function(){var e=this;g.seafileAPI.getRepoInfo(m.repoID).then(function(t){var n=new H.default(t.data);e.setState({libNeedDecrypt:t.data.lib_need_decrypt,repoName:n.repo_name,repoEncrypted:n.encrypted,isVirtual:n.is_virtual,isAdmin:n.is_admin,ownerEmail:n.owner_email});var a=n.owner_email;if(-1!=n.owner_email.indexOf("@seafile_group")){var r=a.substring(0,a.indexOf("@"));e.getGroupInfo(r),e.setState({isGroupOwnedRepo:!0})}t.data.lib_need_decrypt||e.loadWikiData()})}},{key:"componentWillUnmount",value:function(){b.default.unwatchRepo(m.repoID,this.onRepoUpdateEvent)}},{key:"componentDidUpdate",value:function(){this.lastModifyTime=new Date}},{key:"renameItemAjaxCallback",value:function(e,t){this.renameTreeNode(e,t),this.renameDirent(e,t)}},{key:"deleteItem",value:function(e,t){var n=this;t?g.seafileAPI.deleteDir(m.repoID,e).then(function(){n.deleteItemAjaxCallback(e,t)}).catch(function(){}):g.seafileAPI.deleteFile(m.repoID,e).then(function(){n.deleteItemAjaxCallback(e,t)}).catch(function(){})}},{key:"deleteItemAjaxCallback",value:function(e){this.deleteTreeNode(e),this.deleteDirent(e)}},{key:"deleteDirent",value:function(e){if(e===this.state.path){var t=v.Utils.getDirName(e);this.showDir(t)}else if(v.Utils.isChildPath(e,this.state.path)){var n=v.Utils.getFileName(e),a=this.state.direntList.filter(function(e){return e.name!==n});this.setState({direntList:a}),this.updateReadmeMarkdown(a)}else if(v.Utils.isAncestorPath(e,this.state.path)){var r=v.Utils.getDirName(e);this.showDir(r)}}},{key:"createTreeNode",value:function(e,t){var n=this.createDirent(e,t);return new P.default({object:n})}},{key:"createDirent",value:function(e,t,n){var a=(new Date).getTime()/1e3;return new R.default({name:e,type:t,mtime:a,size:n})}},{key:"render",value:function(){if(this.state.libNeedDecrypt)return c.default.createElement(N.default,null,c.default.createElement(k.default,{repoID:m.repoID,onLibDecryptDialog:this.onLibDecryptDialog}));var e=!1,t=!1,n=this.state,a=n.repoEncrypted,r=n.isAdmin,o=n.ownerEmail,i=n.userPerm,s=n.isVirtual,l=n.isDepartmentAdmin,u=o==m.username;return a||!(m.canGenerateShareLink||m.canGenerateUploadLink||u||r)||"rw"!=i&&"r"!=i||(e=!0,!s&&(u||r||l)&&(t=!0)),c.default.createElement("div",{id:"main",className:"wiki-main"},c.default.createElement(S.default,{isTreeDataLoading:this.state.isTreeDataLoading,onNodeClick:this.onTreeNodeClick,onNodeCollapse:this.onTreeNodeCollapse,onNodeExpanded:this.onTreeNodeExpanded,closeSideBar:this.state.closeSideBar,onCloseSide:this.onCloseSide,treeData:this.state.treeData,currentPath:this.state.path,currentNode:this.state.currentNode,onAddFolderNode:this.onAddFolder,onAddFileNode:this.onAddFile,onRenameNode:this.onRenameTreeNode,onDeleteNode:this.onDeleteTreeNode}),c.default.createElement(D.default,{path:this.state.path,repoName:this.state.repoName,repoEncrypted:this.state.repoEncrypted,isViewFile:this.state.isViewFile,pathExist:this.state.pathExist,isDirentListLoading:this.state.isDirentListLoading,isFileLoading:this.state.isFileLoading,permission:this.state.permission,content:this.state.content,lastModified:this.state.lastModified,latestContributor:this.state.latestContributor,showShareBtn:e,enableDirPrivateShare:t,userPerm:i,isRepoOwner:u,isAdmin:r,isGroupOwnedRepo:this.state.isGroupOwnedRepo,direntList:this.state.direntList,sortBy:this.state.sortBy,sortOrder:this.state.sortOrder,sortItems:this.sortItems,selectedDirentList:this.state.selectedDirentList,updateDirent:this.updateDirent,onSideNavMenuClick:this.onSideNavMenuClick,onSearchedClick:this.onSearchedClick,onMainNavBarClick:this.onMainNavBarClick,onItemClick:this.onDirentClick,onItemSelected:this.onDirentSelected,onItemDelete:this.onMainPanelItemDelete,onItemRename:this.onMainPanelItemRename,onLinkClick:this.onLinkClick,onItemMove:this.onMoveItem,onItemCopy:this.onCopyItem,onAddFile:this.onAddFile,onAddFolder:this.onAddFolder,onFileTagChanged:this.onFileTagChanged,isDirentSelected:this.state.isDirentSelected,isAllDirentSelected:this.state.isAllDirentSelected,onAllDirentSelected:this.onAllDirentSelected,onItemsMove:this.onMoveItems,onItemsCopy:this.onCopyItems,onItemsDelete:this.onDeleteItems,onFileUploadSuccess:this.onFileUploadSuccess,hash:this.hash,isDraft:this.state.isDraft,hasDraft:this.state.hasDraft,goDraftPage:this.goDraftPage,usedRepoTags:this.state.usedRepoTags,readmeMarkdown:this.state.readmeMarkdown,draftCounts:this.state.draftCounts,updateUsedRepoTags:this.updateUsedRepoTags}))}}]),t}(u.Component);p.default.render(c.default.createElement(B,null),document.getElementById("wrapper"))},2291:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(6),h=n(818),m=a(h),g=n(227),v=a(g),y=n(12),b=a(y),C=n(24),S=a(C),w=n(1059),D=a(w),E=n(1060),P=a(E),L=n(404),T=a(L),Y=n(323),M=a(Y),_={currentNode:d.default.object,isTreeDataLoading:d.default.bool.isRequired,treeData:d.default.object.isRequired,currentPath:d.default.string.isRequired,closeSideBar:d.default.bool.isRequired,onCloseSide:d.default.func.isRequired,onNodeClick:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onRenameNode:d.default.func.isRequired,onDeleteNode:d.default.func.isRequired,onAddFileNode:d.default.func.isRequired,onAddFolderNode:d.default.func.isRequired},k=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({isMenuIconShow:!0})},n.onMouseLeave=function(){n.setState({isMenuIconShow:!1})},n.onDropdownToggleClick=function(e){e.preventDefault(),n.toggleOperationMenu()},n.toggleOperationMenu=function(){n.setState({isHeaderMenuShow:!n.state.isHeaderMenuShow})},n.onNodeClick=function(e){n.setState({opNode:e}),n.props.onNodeClick(e)},n.onMenuItemClick=function(e,t){switch(n.setState({opNode:t}),e){case"New Folder":n.onAddFolderToggle();break;case"New File":n.onAddFileToggle();break;case"Rename":n.onRenameToggle();break;case"Delete":n.onDeleteToggle()}},n.onAddFileToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow,opNode:t})}else n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow})},n.onAddFolderToggle=function(e){if("root"===e){var t=n.props.treeData.root;n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow,opNode:t})}else n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow})},n.onRenameToggle=function(){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow})},n.onDeleteToggle=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow})},n.onAddFolderNode=function(e){n.setState({isAddFolderDialogShow:!n.state.isAddFolderDialogShow}),n.props.onAddFolderNode(e)},n.onAddFileNode=function(e,t){n.setState({isAddFileDialogShow:!n.state.isAddFileDialogShow}),n.props.onAddFileNode(e,t)},n.onRenameNode=function(e){n.setState({isRenameDialogShow:!n.state.isRenameDialogShow});var t=n.state.opNode;n.props.onRenameNode(t,e)},n.onDeleteNode=function(){n.setState({isDeleteDialogShow:!n.state.isDeleteDialogShow});var e=n.state.opNode;n.props.onDeleteNode(e)},n.checkDuplicatedName=function(e){var t=n.state.opNode;return(t.parentNode?t.parentNode:t).children.map(function(e){return e.object}).some(function(t){return t.name===e})},n.state={opNode:null,isLoadFailed:!1,isMenuIconShow:!1,isHeaderMenuShow:!1,isDeleteDialogShow:!1,isAddFileDialogShow:!1,isAddFolderDialogShow:!1,isRenameDialogShow:!1},n.isNodeMenuShow=!0,n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({opNode:e.currentNode})}},{key:"render",value:function(){return u.default.createElement("div",{className:"side-panel wiki-side-panel "+(this.props.closeSideBar?"":"left-zero")},u.default.createElement("div",{className:"side-panel-top panel-top"},u.default.createElement(v.default,{onCloseSidePanel:this.props.onCloseSide})),u.default.createElement("div",{id:"side-nav",className:"wiki-side-nav",role:"navigation"},u.default.createElement("h3",{className:"wiki-pages-heading",onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},(0,p.gettext)("Files"),u.default.createElement("div",{className:"heading-icon"},p.permission&&this.state.isMenuIconShow&&u.default.createElement(f.Dropdown,{isOpen:this.state.isHeaderMenuShow,toggle:this.toggleOperationMenu},u.default.createElement(f.DropdownToggle,{tag:"i",className:"fas fa-ellipsis-v",title:(0,p.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isHeaderMenuShow,onClick:this.onDropdownToggleClick}),u.default.createElement(f.DropdownMenu,{right:!0},u.default.createElement(f.DropdownItem,{onClick:this.onAddFolderToggle.bind(this,"root")},(0,p.gettext)("New Folder")),u.default.createElement(f.DropdownItem,{onClick:this.onAddFileToggle.bind(this,"root")},(0,p.gettext)("New File")))))),u.default.createElement("div",{className:"wiki-pages-container"},this.props.isTreeDataLoading?u.default.createElement(b.default,null):u.default.createElement(m.default,{isNodeMenuShow:this.isNodeMenuShow,treeData:this.props.treeData,currentPath:this.props.currentPath,onNodeClick:this.onNodeClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onMenuItemClick:this.onMenuItemClick,onFreezedItem:this.onFreezedItem,onUnFreezedItem:this.onUnFreezedItem}))),this.state.isAddFolderDialogShow&&u.default.createElement(S.default,null,u.default.createElement(T.default,{parentPath:this.state.opNode.path,onAddFolder:this.onAddFolderNode,checkDuplicatedName:this.checkDuplicatedName,addFolderCancel:this.onAddFolderToggle})),this.state.isAddFileDialogShow&&u.default.createElement(S.default,null,u.default.createElement(M.default,{fileType:".md",parentPath:this.state.opNode.path,onAddFile:this.onAddFileNode,checkDuplicatedName:this.checkDuplicatedName,addFileCancel:this.onAddFileToggle})),this.state.isRenameDialogShow&&u.default.createElement(S.default,null,u.default.createElement(P.default,{currentNode:this.state.opNode,onRename:this.onRenameNode,checkDuplicatedName:this.checkDuplicatedName,toggleCancel:this.onRenameToggle})),this.state.isDeleteDialogShow&&u.default.createElement(S.default,null,u.default.createElement(D.default,{currentNode:this.state.opNode,handleSubmit:this.onDeleteNode,toggleCancel:this.onDeleteToggle})))}}]),t}(l.Component);k.propTypes=_,t.default=k},2292:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(48),f=a(p),h=n(2),m=n(4),g=n(3),v=n(85),y=a(v),b=n(86),C=a(b),S=n(1061),w=a(S),D=n(1062),E=a(D),P=n(1063),L=a(P),T=n(1065),Y=a(T),M=n(820),_=a(M),k=n(1070),Z=a(k),N=n(1078),I=a(N),R=n(1081),O=a(R),F=n(926),X=a(F),J={content:d.default.string,lastModified:d.default.string,latestContributor:d.default.string,permission:d.default.string,hash:d.default.string,path:d.default.string.isRequired,repoName:d.default.string.isRequired,repoEncrypted:d.default.bool.isRequired,showShareBtn:d.default.bool.isRequired,enableDirPrivateShare:d.default.bool.isRequired,userPerm:d.default.string.isRequired,isAdmin:d.default.bool.isRequired,isGroupOwnedRepo:d.default.bool.isRequired,pathExist:d.default.bool.isRequired,isFileLoading:d.default.bool.isRequired,isViewFile:d.default.bool.isRequired,isDirentListLoading:d.default.bool.isRequired,isDirentSelected:d.default.bool.isRequired,isAllDirentSelected:d.default.bool.isRequired,direntList:d.default.array.isRequired,sortBy:d.default.string.isRequired,sortOrder:d.default.string.isRequired,sortItems:d.default.func.isRequired,selectedDirentList:d.default.array.isRequired,updateDirent:d.default.func.isRequired,onSideNavMenuClick:d.default.func.isRequired,onSearchedClick:d.default.func.isRequired,onMainNavBarClick:d.default.func.isRequired,onItemClick:d.default.func.isRequired,onAllDirentSelected:d.default.func.isRequired,onItemSelected:d.default.func.isRequired,onItemDelete:d.default.func.isRequired,onItemRename:d.default.func.isRequired,onItemMove:d.default.func.isRequired,onItemCopy:d.default.func.isRequired,onAddFile:d.default.func.isRequired,onAddFolder:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired,onItemsMove:d.default.func.isRequired,onItemsCopy:d.default.func.isRequired,onItemsDelete:d.default.func.isRequired,onLinkClick:d.default.func.isRequired,onFileUploadSuccess:d.default.func.isRequired,isDraft:d.default.bool,hasDraft:d.default.bool,goDraftPage:d.default.func,usedRepoTags:d.default.array.isRequired,readmeMarkdown:d.default.object,draftCounts:d.default.number,updateUsedRepoTags:d.default.func.isRequired},x=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.switchViewMode=function(e){f.default.save("view_mode",e,{path:"/"});var t=n.state.currentRepoInfo.repo_name,a=n.props.isViewFile?g.Utils.getDirName(n.props.path):n.props.path;window.location.href=h.siteRoot+"library/"+h.repoID+"/"+t+a},n.onSideNavMenuClick=function(){n.props.onSideNavMenuClick()},n.onItemClick=function(e){n.setState({isDirentDetailShow:!1}),n.props.onItemClick(e)},n.onMainNavBarClick=function(e){n.setState({isDirentDetailShow:!1}),n.props.onMainNavBarClick(e)},n.onDirentClick=function(e){n.state.isDirentDetailShow&&n.onItemDetails(e)},n.onItemDetails=function(e){n.setState({currentDirent:e,isDirentDetailShow:!0})},n.onItemDetailsClose=function(){n.setState({isDirentDetailShow:!1})},n.onFileTagChanged=function(e,t){n.props.onFileTagChanged(e,t)},n.onUploadFile=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFileUpload()},n.onUploadFolder=function(e){e.nativeEvent.stopImmediatePropagation(),n.uploader.onFolderUpload()},n.onFileUploadSuccess=function(e){n.props.onFileUploadSuccess(e)},n.state={currentMode:"wiki",isDirentDetailShow:!1,currentDirent:null,direntPath:"",currentRepoInfo:null},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;if(m.seafileAPI.getRepoInfo(h.repoID).then(function(t){var n=new y.default(t.data);e.setState({currentRepoInfo:n})}),this.props.hash){var t=this.props.hash;setTimeout(function(){window.location.hash=t},500)}}},{key:"render",value:function(){var e=this,t=u.default.createElement("div",{className:"message err-tip"},(0,h.gettext)("Folder does not exist.")),n="/"===this.props.path&&(0!=this.props.usedRepoTags.length||null!=this.props.readmeMarkdown||0!=this.props.draftCounts);return u.default.createElement("div",{className:"main-panel wiki-main-panel o-hidden"},u.default.createElement("div",{className:"main-panel-north border-left-show"},u.default.createElement("div",{className:"cur-view-toolbar"},u.default.createElement("span",{className:"sf2-icon-menu hidden-md-up d-md-none side-nav-toggle",title:(0,h.gettext)("Side Nav Menu"),onClick:this.onSideNavMenuClick}),u.default.createElement("div",{className:"dir-operation"},this.props.isDirentSelected?u.default.createElement(L.default,{repoID:h.repoID,path:this.props.path,selectedDirentList:this.props.selectedDirentList,onItemsMove:this.props.onItemsMove,onItemsCopy:this.props.onItemsCopy,onItemsDelete:this.props.onItemsDelete}):u.default.createElement(E.default,{path:this.props.path,repoID:h.repoID,repoName:this.props.repoName,repoEncrypted:this.props.repoEncrypted,isDraft:this.props.isDraft,hasDraft:this.props.hasDraft,direntList:this.props.direntList,permission:this.props.permission,isViewFile:this.props.isViewFile,showShareBtn:this.props.showShareBtn,enableDirPrivateShare:this.props.enableDirPrivateShare,userPerm:this.props.userPerm,isAdmin:this.props.isAdmin,isGroupOwnedRepo:this.props.isGroupOwnedRepo,onAddFile:this.props.onAddFile,onAddFolder:this.props.onAddFolder,onUploadFile:this.onUploadFile,onUploadFolder:this.onUploadFolder})),u.default.createElement(w.default,{currentMode:this.state.currentMode,switchViewMode:this.switchViewMode})),u.default.createElement(C.default,{repoID:h.repoID,onSearchedClick:this.props.onSearchedClick,searchPlaceholder:(0,h.gettext)("Search files in this library")})),u.default.createElement("div",{className:"main-panel-center flex-row"},u.default.createElement("div",{className:"cur-view-container"},u.default.createElement("div",{className:"cur-view-path"},this.state.currentRepoInfo&&u.default.createElement(Y.default,{repoID:h.repoID,repoName:this.state.currentRepoInfo.repo_name,currentPath:this.props.path,permission:h.permission,onPathClick:this.onMainNavBarClick,isViewFile:this.props.isViewFile,updateUsedRepoTags:this.props.updateUsedRepoTags})),u.default.createElement("div",{className:"cur-view-content"},!this.props.pathExist&&t,this.props.pathExist&&this.props.isViewFile&&u.default.createElement(_.default,{isFileLoading:this.props.isFileLoading,markdownContent:this.props.content,latestContributor:this.props.latestContributor,lastModified:this.props.lastModified,onLinkClick:this.props.onLinkClick},u.default.createElement(l.Fragment,null,!this.props.isDraft&&this.props.hasDraft&&u.default.createElement("div",{className:"seafile-btn-view-review text-center"},u.default.createElement("div",{className:"tag tag-green"},(0,h.gettext)("This file is in draft stage."),u.default.createElement("a",{className:"ml-2",onMouseDown:this.props.goDraftPage},(0,h.gettext)("View Draft")))))),this.props.pathExist&&!this.props.isViewFile&&u.default.createElement(l.Fragment,null,n&&u.default.createElement(X.default,{repoID:h.repoID,currentPath:this.props.path,usedRepoTags:this.props.usedRepoTags,readmeMarkdown:this.props.readmeMarkdown,draftCounts:this.props.draftCounts,updateUsedRepoTags:this.props.updateUsedRepoTags}),u.default.createElement(Z.default,{path:this.props.path,repoID:h.repoID,repoEncrypted:this.props.repoEncrypted,isRepoOwner:this.props.isRepoOwner,isAdmin:this.props.isAdmin,isGroupOwnedRepo:this.props.isGroupOwnedRepo,enableDirPrivateShare:this.props.enableDirPrivateShare,direntList:this.props.direntList,sortBy:this.props.sortBy,sortOrder:this.props.sortOrder,sortItems:this.props.sortItems,onAddFile:this.props.onAddFile,onItemClick:this.onItemClick,onItemDelete:this.props.onItemDelete,onItemRename:this.props.onItemRename,onItemMove:this.props.onItemMove,onItemCopy:this.props.onItemCopy,onDirentClick:this.onDirentClick,onItemDetails:this.onItemDetails,isDirentListLoading:this.props.isDirentListLoading,updateDirent:this.props.updateDirent,currentRepoInfo:this.state.currentRepoInfo,isAllItemSelected:this.props.isAllDirentSelected,onAllItemSelected:this.props.onAllDirentSelected,onItemSelected:this.props.onItemSelected}),u.default.createElement(O.default,{ref:function(t){return e.uploader=t},dragAndDrop:!0,path:this.props.path,repoID:h.repoID,direntList:this.props.direntList,onFileUploadSuccess:this.onFileUploadSuccess})))),this.state.isDirentDetailShow&&u.default.createElement("div",{className:"cur-view-detail"},u.default.createElement(I.default,{repoID:h.repoID,path:this.props.path,dirent:this.state.currentDirent,direntPath:this.state.direntPath,onItemDetailsClose:this.onItemDetailsClose,onFileTagChanged:this.onFileTagChanged}))))}}]),t}(l.Component);x.propTypes=J,t.default=x},24:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(7),d=a(c),p=n(1),f=a(p),h={children:f.default.object.isRequired},m=document.getElementById("modal-wrapper"),g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.el=document.createElement("div"),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){m.appendChild(this.el)}},{key:"componentWillUnmount",value:function(){m.removeChild(this.el)}},{key:"render",value:function(){return d.default.createPortal(this.props.children,this.el)}}]),t}(u.default.Component);g.propTypes=h,t.default=g},240:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n(2),i=n(3),s=function(){function e(){a(this,e)}return r(e,null,[{key:"getUrl",value:function(e){var t="",n="";switch(e.type){case"download_historic_file":n="p="+e.filePath,t=o.siteRoot+"repo/"+o.historyRepoID+"/"+e.objID+"/download?"+n;break;case"download_file_url":t=o.siteRoot+"lib/"+e.repoID+"/file"+i.Utils.encodePath(e.filePath)+"?dl=1";break;case"file_revisions":n="p="+i.Utils.encodePath(e.filePath),t=o.siteRoot+"repo/file_revisions/"+e.repoID+"/?"+n;break;case"open_via_client":t="seafile://openfile?repo_id="+e.repoID+"&path="+i.Utils.encodePath(e.filePath);break;case"draft_view":t=o.siteRoot+"lib/"+e.repoID+"/file"+e.filePath+"?mode=edit&draft_id="+e.draftId;break;default:t=""}return t}}]),e}();t.default=s},27:function(e,t,n){"use strict";n(58),n(61),"undefined"===typeof Promise&&(n(62).enable(),window.Promise=n(50)),n(56),Object.assign=n(34)},29:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.strChineseFirstPY="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY"},290:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(320),v=a(g),y=n(506),b=a(y),C=n(5),S=a(C);n(507);var w={repoID:d.default.string.isRequired,repoTag:d.default.object.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({showSelectedTag:!0})},n.onMouseLeave=function(){n.setState({showSelectedTag:!1})},n.getRepoTagIdList=function(){var e=[];return n.props.fileTagList.map(function(t){e.push(t.repo_tag_id)}),e},n.onEditFileTag=function(){var e=n.props,t=e.repoID,a=e.repoTag,r=e.filePath,o=n.getRepoTagIdList();if(-1===o.indexOf(a.id)){var i=a.id;h.seafileAPI.addFileTag(t,r,i).then(function(){o=n.getRepoTagIdList(),n.props.onFileTagChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);S.default.danger(t)})}else{for(var s=null,l=n.props.fileTagList,u=0;u<l.length;u++)if(l[u].repo_tag_id===a.id){s=l[u];break}h.seafileAPI.deleteFileTag(t,s.id).then(function(){o=n.getRepoTagIdList(),n.props.onFileTagChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);S.default.danger(t)})}},n.state={showSelectedTag:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.repoTag,t=this.getRepoTagIdList(),n=m.Utils.getDarkColor(e.color);return u.default.createElement("li",{key:e.id,className:"tag-list-item",onClick:this.onEditFileTag,onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("div",{className:"tag-demo",style:{backgroundColor:e.color}},u.default.createElement("span",{className:this.state.showSelectedTag?"show-tag-selected":"",style:{backgroundColor:n}}),u.default.createElement("span",{className:"tag-name"},e.name),t.indexOf(e.id)>-1&&u.default.createElement("i",{className:"fas fa-check tag-operation"})))}}]),t}(u.default.Component);D.propTypes=w;var E={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,onFileTagChanged:d.default.func.isRequired,toggleCancel:d.default.func.isRequired,createNewTag:d.default.func.isRequired},P=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getRepoTagList=function(){var e=n.props.repoID;h.seafileAPI.listRepoTags(e).then(function(e){var t=[];e.data.repo_tags.forEach(function(e){var n=new v.default(e);t.push(n)}),n.setState({repotagList:t})}).catch(function(e){var t=m.Utils.getErrorMsg(e);S.default.danger(t)})},n.state={repotagList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getRepoTagList()}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.props.toggleCancel},(0,f.gettext)("Select Tags")),u.default.createElement(p.ModalBody,null,u.default.createElement("ul",{className:"tag-list tag-list-container"},this.state.repotagList.map(function(t){return u.default.createElement(D,{key:t.id,repoTag:t,repoID:e.props.repoID,filePath:e.props.filePath,fileTagList:e.props.fileTagList,onFileTagChanged:e.props.onFileTagChanged})})),u.default.createElement("a",{href:"#",className:"add-tag-link",onClick:this.props.createNewTag},(0,f.gettext)("Create a new tag"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{onClick:this.props.toggleCancel},(0,f.gettext)("Close"))))}}]),t}(u.default.Component);P.propTypes=E;var L={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,fileTagList:d.default.array.isRequired,toggleCancel:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired},T=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.createNewTag=function(){n.setState({isCreateRepoTagShow:!n.state.isCreateRepoTagShow,isListRepoTagShow:!n.state.isListRepoTagShow})},n.onRepoTagCreated=function(e){var t=n.props,a=t.repoID,r=t.filePath;h.seafileAPI.addFileTag(a,r,e).then(function(){n.props.onFileTagChanged()}).catch(function(e){var t=m.Utils.getErrorMsg(e);S.default.danger(t)})},n.state={isCreateRepoTagShow:!1,isListRepoTagShow:!0},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleCancel},this.state.isListRepoTagShow&&u.default.createElement(P,{repoID:this.props.repoID,filePath:this.props.filePath,fileTagList:this.props.fileTagList,onFileTagChanged:this.props.onFileTagChanged,toggleCancel:this.props.toggleCancel,createNewTag:this.createNewTag}),this.state.isCreateRepoTagShow&&u.default.createElement(b.default,{repoID:this.props.repoID,onClose:this.props.toggleCancel,toggleCancel:this.createNewTag,onRepoTagCreated:this.onRepoTagCreated}))}}]),t}(u.default.Component);T.propTypes=L,t.default=T},291:function(e,t,n){"use strict";function a(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return"function"===typeof e&&e.apply(void 0,n)}function r(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function o(){return Math.random().toString(36).substring(7)}Object.defineProperty(t,"__esModule",{value:!0}),t.callIfExists=a,t.hasOwnProp=r,t.uniqueId=o;t.store={},t.canUseDOM=Boolean("undefined"!==typeof window&&window.document&&window.document.createElement)},292:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(6),d=n(1),p=a(d),f=n(5),h=a(f),m=n(136),g=a(m),v=n(2),y=n(4),b=n(3);n(293);var C={path:p.default.string.isRequired,repoID:p.default.string.isRequired},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={isOpen:!1,smartLink:""},n.toggle=n.toggle.bind(n),n.getInternalLink=n.getInternalLink.bind(n),n.copyToClipBoard=n.copyToClipBoard.bind(n),n}return i(t,e),s(t,[{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"getInternalLink",value:function(){var e=this,t=this.props.repoID,n=this.props.path;y.seafileAPI.getInternalLink(t,n).then(function(t){e.setState({isOpen:!0,smartLink:t.data.smart_link})}).catch(function(e){var t=b.Utils.getErrorMsg(e);h.default.danger(t)})}},{key:"copyToClipBoard",value:function(){(0,g.default)(this.state.smartLink),this.setState({isOpen:!1});var e=(0,v.gettext)("Internal link has been copied to clipboard");h.default.success(e)}},{key:"render",value:function(){return u.default.createElement("span",{className:"file-internal-link",title:(0,v.gettext)("Internal Link")},u.default.createElement("i",{className:"fa fa-link",onClick:this.getInternalLink}),u.default.createElement(c.Modal,{isOpen:this.state.isOpen,toggle:this.toggle},u.default.createElement(c.ModalHeader,{toggle:this.toggle},(0,v.gettext)("Internal Link")),u.default.createElement(c.ModalBody,null,u.default.createElement("p",{className:"tip mb-1"},(0,v.gettext)("An internal link is a link to a file or folder that can be accessed by users with read permission to the file or folder.")),u.default.createElement("p",null,u.default.createElement("a",{target:"_blank",href:this.state.smartLink},this.state.smartLink))),u.default.createElement(c.ModalFooter,null,u.default.createElement(c.Button,{color:"secondary",onClick:this.toggle},(0,v.gettext)("Cancel")),u.default.createElement(c.Button,{color:"primary",onClick:this.copyToClipBoard},(0,v.gettext)("Copy")))))}}]),t}(u.default.Component);S.propTypes=C,t.default=S},293:function(e,t){},294:function(e,t,n){"use strict";function a(e){var t=e.offsetWidth<=0&&e.offsetHeight<=0;if(t&&!e.innerHTML)return!0;var n=window.getComputedStyle(e);return t?"visible"!==n.getPropertyValue("overflow"):"none"==n.getPropertyValue("display")}function r(e){for(var t=e;t&&t!==document.body;){if(a(t))return!1;t=t.parentNode}return!0}function o(e,t){var n=e.nodeName.toLowerCase();return(l.test(n)&&!e.disabled||("a"===n?e.href||t:t))&&r(e)}function i(e){var t=e.getAttribute("tabindex");null===t&&(t=void 0);var n=isNaN(t);return(n||t>=0)&&o(e,!n)}function s(e){return[].slice.call(e.querySelectorAll("*"),0).filter(i)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var l=/input|select|textarea|button|object/;e.exports=t.default},295:function(e,t,n){"use strict";function a(e,t){if(!e||!e.length)throw new Error("react-modal: No elements were found for selector "+t+".")}function r(e){var t=e;if("string"===typeof t&&p.canUseDOM){var n=document.querySelectorAll(t);a(n,t),t="length"in n?n[0]:n}return f=t||f}function o(e){return!(!e&&!f)||((0,d.default)(!1,["react-modal: App element is not defined.","Please use `Modal.setAppElement(el)` or set `appElement={el}`.","This is needed so screen readers don't see main content","when modal is opened. It is not recommended, but you can opt-out","by setting `ariaHideApp={false}`."].join(" ")),!1)}function i(e){o(e)&&(e||f).setAttribute("aria-hidden","true")}function s(e){o(e)&&(e||f).removeAttribute("aria-hidden")}function l(){f=null}function u(){f=null}Object.defineProperty(t,"__esModule",{value:!0}),t.assertNodeList=a,t.setElement=r,t.validateElement=o,t.hide=i,t.show=s,t.documentNotReadyOrSSRTesting=l,t.resetForTesting=u;var c=n(823),d=function(e){return e&&e.__esModule?e:{default:e}}(c),p=n(197),f=null},296:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={control:{backgroundColor:"#fff",fontSize:14,fontWeight:"normal"},highlighter:{overflow:"hidden"},input:{margin:0},"&singleLine":{control:{display:"inline-block",width:130},highlighter:{padding:1,border:"2px inset transparent"},input:{padding:1,border:"2px inset"}},"&multiLine":{control:{},highlighter:{padding:9},input:{padding:"8px 6px",minHeight:90,height:90,border:"1px solid #e6e6dd",borderRadius:"5px",overfflowY:"auto","&focused":{backgroundColor:"#cee4e5",outlineOffset:"-2px",outlineColor:"-webkit-focus-ring-color",outlineStyle:"auto",outlineWidth:"5px"}}},suggestions:{list:{backgroundColor:"white",border:"1px solid rgba(0,0,0,0.15)",fontSize:14,maxHeight:200,overflow:"auto",position:"absolute",bottom:14,width:"150px"},item:{width:"auto",padding:"5px 15px",overflowX:"auto",borderBottom:"1px solid rgba(0,0,0,0.15)","&focused":{backgroundColor:"#f19654",color:"#fff",fontWeight:"400"}}}},r={};t.defaultStyle=a,t.defaultMentionStyle=r},297:function(e,t){},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Utils=void 0;var a=n(2),r=n(29),o=t.Utils={keyCodes:{esc:27,space:32,tab:9,up:38,down:40},bytesToSize:function(e){if("undefined"==typeof e)return" ";if(e<0)return"--";var t=["bytes","KB","MB","GB","TB","PB"];if(0===e)return e+" "+t[0];var n=parseInt(Math.floor(Math.log(e)/Math.log(1e3)),10);return 0===n?e+" "+t[n]:(e/Math.pow(1e3,n)).toFixed(1)+" "+t[n]},isHiDPI:function(){return(window.devicePixelRatio?window.devicePixelRatio:1)>1},isDesktop:function(){return window.innerWidth>=768},FILEEXT_ICON_MAP:{md:"txt.png",txt:"txt.png",pdf:"pdf.png",doc:"word.png",docx:"word.png",odt:"word.png",fodt:"word.png",ppt:"ppt.png",pptx:"ppt.png",odp:"ppt.png",fodp:"ppt.png",xls:"excel.png",xlsx:"excel.png",ods:"excel.png",fods:"excel.png",mp4:"video.png",ogv:"video.png",webm:"video.png",mov:"video.png",flv:"video.png",wmv:"video.png",rmvb:"video.png",mp3:"music.png",oga:"music.png",ogg:"music.png",flac:"music.png",aac:"music.png",ac3:"music.png",wma:"music.png",jpg:"pic.png",jpeg:"pic.png",png:"pic.png",svg:"pic.png",gif:"pic.png",bmp:"pic.png",ico:"pic.png",default:"file.png"},imageCheck:function(e){return-1!=e.lastIndexOf(".")&&-1!=["gif","jpeg","jpg","png","ico","bmp","tif","tiff"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},isOfficeFile:function(e){return-1!=e.lastIndexOf(".")&&-1!=["doc","ppt","xls","docx","pptx","xlsx"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},videoCheck:function(e){return-1!=e.lastIndexOf(".")&&-1!=["mp4","ogv","webm","mov"].indexOf(e.substr(e.lastIndexOf(".")+1).toLowerCase())},encodePath:function(e){if(!e)return"";for(var t=e.split("/"),n=[],a=0,r=t.length;a<r;a++)n.push(encodeURIComponent(t[a]));return n.join("/")},HTMLescape:function(e){return document.createElement("div").appendChild(document.createTextNode(e)).parentNode.innerHTML},generateDialogTitle:function(e,t){var n=this.HTMLescape(t),a='<span class="op-target ellipsis ellipsis-op-target" title='+n+">"+n+"</span>";return e.replace("{placeholder}",a)},getFileName:function(e){var t=e.lastIndexOf("/");return e.slice(t+1)},getPaths:function(e){for(var t=e.split("/").slice(1),n=[];t.length;)n.push("/"+t.join("/")),t.pop();return n.reverse()},getFolderName:function(e){return"/"===e?e:(e="/"!==e[e.length-1]?e:e.slice(0,e.length-2),e.slice(e.lastIndexOf("/")+1))},getDirName:function(e){var t=e.slice(0,e.lastIndexOf("/"));return""===t?"/":t},isChildPath:function(e,t){return this.getDirName(e)===t},isAncestorPath:function(e,t){return t.indexOf(e)>-1},renameAncestorPath:function(e,t,n){return e.replace(t,n)},joinPath:function(e,t){return"/"===e[e.length-1]?e+t:e+"/"+t},isSupportUploadFolder:function(){return-1!=navigator.userAgent.indexOf("Firefox")||navigator.userAgent.indexOf("Chrome")>-1||navigator.userAgent.indexOf("Safari")>-1},isIEBrower:function(){var e=navigator.userAgent,t=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1,n=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1;return t||n},getDefaultLibIconUrl:function(e){var t=o.isHiDPI()?48:24;t=e?256:t;return a.mediaUrl+"img/lib/"+t+"/lib.png"},getLibIconUrl:function(e,t){var n=e.permission||e.share_permission,r=o.isHiDPI()?48:24;r=t?256:r;var i="lib.png";switch(e.encrypted&&(i="lib-encrypted.png"),n){case"r":i="lib-readonly.png";break;case"preview":i="lib-cloud-preview.png";break;case"cloud-edit":i="lib-cloud-preview-edit.png"}return"read-only"==e.status&&(i="lib-readonly.png"),a.mediaUrl+"img/lib/"+r+"/"+i},getDirentIcon:function(e,t){var n=this.isHiDPI()?48:24;if(n=t?192:n,e.isDir()){var a=!1;return!e.permission||"r"!==e.permission&&"preview"!==e.permission||(a=!0),this.getFolderIconUrl(a,n)}return this.getFileIconUrl(e.name,n)},getFolderIconUrl:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];return t||(t=o.isHiDPI()?48:24),t=t>24?192:24,a.mediaUrl+"img/folder"+(e?"-read-only-":"-")+t+".png"},getFileIconUrl:function(e,t){t||(t=o.isHiDPI()?48:24),t=t>24?192:24;var n="";return-1==e.lastIndexOf(".")?a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP.default:(n=e.substr(e.lastIndexOf(".")+1).toLowerCase(),this.FILEEXT_ICON_MAP[n]?a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP[n]:a.mediaUrl+"img/file/"+t+"/"+this.FILEEXT_ICON_MAP.default)},getLibIconTitle:function(e){var t,n=e.permission||e.share_permission;if(e.encrypted)t=(0,a.gettext)("Encrypted library");else if(e.is_admin)t=(0,a.gettext)("Admin access");else switch(n){case"rw":t=(0,a.gettext)("Read-Write library");break;case"r":t=(0,a.gettext)("Read-Only library");break;case"cloud-edit":t=(0,a.gettext)("Online Read-Write library");break;case"preview":t=(0,a.gettext)("Online Read-Only library")}return t},getFolderIconTitle:function(e){var t;switch(e.permission){case"rw":t=(0,a.gettext)("Read-Write folder");break;case"r":t=(0,a.gettext)("Read-Only folder");break;case"cloud-edit":t=(0,a.gettext)("Online Read-Write folder");break;case"preview":t=(0,a.gettext)("Online Read-Only folder")}return t},sharePerms:function(e){var t;switch(e){case"rw":t=(0,a.gettext)("Read-Write");break;case"r":t=(0,a.gettext)("Read-Only");break;case"admin":t=(0,a.gettext)("Admin");break;case"cloud-edit":t=(0,a.gettext)("Online Read-Write");break;case"preview":t=(0,a.gettext)("Online Read-Only")}return t},sharePermsExplanation:function(e){var t;switch(e){case"rw":t=(0,a.gettext)("User can read, write, upload, download and sync files.");break;case"r":t=(0,a.gettext)("User can read, download and sync files.");break;case"admin":t=(0,a.gettext)("Besides Write permission, user can also share the library.");break;case"cloud-edit":t=(0,a.gettext)("User can view and edit file online via browser. Files can't be downloaded.");break;case"preview":t=(0,a.gettext)("User can only view files online via browser. Files can't be downloaded.")}return t},formatSize:function(e){var t=e.bytes,n=e.precision||0;return t>=0&&t<1e3?t+" B":t>=1e3&&t<1e6?(t/1e3).toFixed(n)+" KB":t>=1e6&&t<1e9?(t/1e6).toFixed(n)+" MB":t>=1e9&&t<1e12?(t/1e9).toFixed(n)+" GB":t>=1e12?(t/1e12).toFixed(n)+" TB":t+" B"},formatBitRate:function(e){var t;return"number"!==typeof e?"":(t=e/8,t>=1e9?(t/1e9).toFixed(2)+" GB/s":t>=1e6?(t/1e6).toFixed(2)+" MB/s":t>=1e3?(t/1e3).toFixed(2)+" kB/s":t.toFixed(2)+" B/s")},isMarkdownFile:function(e){var t=e.lastIndexOf(".");if(-1===t)return!1;var n=e.substring(t).toLowerCase();return".md"===n||".markdown"===n},isInternalMarkdownLink:function(e,t){return new RegExp(a.serviceURL+"/lib/"+t+".*.md$").test(e)},isInternalDirLink:function(e,t){return new RegExp(a.serviceURL+"/library/"+t+".*").test(e)},getPathFromInternalMarkdownLink:function(e,t){var n=new RegExp(a.serviceURL+"/lib/"+t+"/file(.*.md)"),r=n.exec(e);return decodeURIComponent(r[1])},getPathFromInternalDirLink:function(e,t){var n=new RegExp(a.serviceURL+"/library/"+t+"(/.*)"),r=n.exec(e),o=decodeURIComponent(r[1]);return o=o.slice(1),o=o.slice(o.indexOf("/"))},isWikiInternalMarkdownLink:function(e,t){return t=encodeURIComponent(t),new RegExp(a.serviceURL+"/published/"+t+".*.md$").test(e)},isWikiInternalDirLink:function(e,t){return t=encodeURIComponent(t),new RegExp(a.serviceURL+"/published/"+t+".*").test(e)},getPathFromWikiInternalMarkdownLink:function(e,t){t=encodeURIComponent(t);var n=new RegExp(a.serviceURL+"/published/"+t+"(.*.md)"),r=n.exec(e),o=r[1];try{o=decodeURIComponent(o)}catch(e){o=o.replace(/%/g,"%25"),o=decodeURIComponent(o)}return o},getPathFromWikiInternalDirLink:function(e,t){t=encodeURIComponent(t);var n=new RegExp(a.serviceURL+"/published/"+t+"(/.*)"),r=n.exec(e),o=r[1];try{o=decodeURIComponent(o)}catch(e){o=o.replace(/%/g,"%25"),o=decodeURIComponent(o)}return o},compareTwoWord:function(e,t){var n,a,o=e.charCodeAt(0),i=t.charCodeAt(0);return 19968<o&&o<40869&&19968<i&&i<40869?(n=r.strChineseFirstPY.charAt(o-19968).toLowerCase(),a=r.strChineseFirstPY.charAt(i-19968).toLowerCase(),n>=a?1:-1):19968<o&&o<40869&&!(19968<i&&i<40869)?1:!(19968<o&&o<40869)&&19968<i&&i<40869?-1:(n=e.toLowerCase(),a=t.toLowerCase(),this.compareStrWithNumbersIn(n,a))},compareStrWithNumbersIn:function(e,t){var n,a,r,o=/\d+|\D+/g,i=/\d/,s=e.match(o),l=t.match(o),u=Math.min(s.length,l.length);if(s&&l&&(n=i.test(s[0]))==i.test(l[0]))for(var c=0;c<u;c++){if(a=s[c],r=l[c],n&&(a=parseInt(a,10),r=parseInt(r,10)),a!=r)return a<r?-1:1;n=!n}return(e>=t)-(e<=t)},sortRepos:function(e,t,n){var a=this,r=void 0;switch(t+"-"+n){case"name-asc":r=function(e,t){return e.repo_name?t.repo_name?a.compareTwoWord(e.repo_name,t.repo_name):-1:1};break;case"name-desc":r=function(e,t){return e.repo_name?t.repo_name?-a.compareTwoWord(e.repo_name,t.repo_name):1:-1};break;case"time-asc":r=function(e,t){return e.last_modified<t.last_modified?-1:1};break;case"time-desc":r=function(e,t){return e.last_modified<t.last_modified?1:-1};break;case"size-asc":r=function(e,t){if(e.size===t.size){return a.compareTwoWord(e.repo_name,t.repo_name)}return e.size_original<t.size_original?-1:1};break;case"size-desc":r=function(e,t){if(e.size===t.size){return-a.compareTwoWord(e.repo_name,t.repo_name)}return e.size_original<t.size_original?1:-1}}return e.sort(r),e},sortDirents:function(e,t,n){var a=this,r=void 0;switch(t+"-"+n){case"name-asc":r=function(e,t){return a.compareTwoWord(e.name,t.name)};break;case"name-desc":r=function(e,t){return-a.compareTwoWord(e.name,t.name)};break;case"time-asc":r=function(e,t){return e.mtime<t.mtime?-1:1};break;case"time-desc":r=function(e,t){return e.mtime<t.mtime?1:-1};break;case"size-asc":r=function(e,t){if("dir"==e.type&&"dir"==t.type){return a.compareTwoWord(e.name,t.name)}return e.size_original<t.size_original?-1:1};break;case"size-desc":r=function(e,t){if("dir"==e.type&&"dir"==t.type){return-a.compareTwoWord(e.name,t.name)}return e.size_original<t.size_original?1:-1}}return e.sort(function(e,t){return"dir"==e.type&&"file"==t.type?-1:"file"==e.type&&"dir"==t.type?1:r(e,t)}),e},getErrorMsg:function(e){return e.response?e.response.data&&e.response.data.error_msg?e.response.data.error_msg:(0,a.gettext)("Error"):(0,a.gettext)("Please check the network.")},changeMarkdownNodes:function(e,t){return e.map(function(e){t(e),e.nodes&&e.nodes.length>0&&o.changeMarkdownNodes(e.nodes,t)}),e},chooseLanguage:function(e){var t=void 0;switch(e){case"py":t="python";break;case"js":t="javascript";break;case"c":t="text/x-csrc";break;case"cpp":t="text/x-c++src";break;case"java":t="text/x-java";break;case"cs":t="text/x-csharp";break;case"mdf":t="text/x-sql";break;case"html":t="htmlmixed";break;default:t=e}return t},DARK_COLOR_MAP:{red:"#D11507",orange:"#FF8C00",yellow:"#EDEF00",green:"#006400",cyan:"#00E0E1",blue:"#2510A3",indigo:"#350C56",purple:"#551054",pink:"#E3A5B0",azure:"#C4D0D0",lime:"#00E100",teal:"#006A6B",gray:"#545454","#FFA8A8":"#E49090","#FFA94D":"#E39136","#FFD43B":"#E0B815","#A0EC50":"#83CF32","#A9E34B":"#8DC72E","#63E6BE":"#43CAA4","#4FD2C9":"#2DB9B0","#72C3FC":"#57ABE3","#91A7FF":"#7A91E7","#E599F7":"#CC82DE","#B197FC":"#9B82E5","#F783AC":"#DF6D97","#CED4DA":"#A8ADB2"},getDarkColor:function(e){return this.DARK_COLOR_MAP[e]},getCopySuccessfulMessage:function(e){var t=void 0,n=e.length;return 1===n?t=(0,a.gettext)("Successfully copied %(name)s."):2===n?t=(0,a.gettext)("Successfully copied %(name)s and 1 other item."):(t=(0,a.gettext)("Successfully copied %(name)s and %(amount)s other items."),t=t.replace("%(amount)s",n-1)),t=t.replace("%(name)s",e[0])},getMoveSuccessMessage:function(e){var t=void 0,n=e.length;return 1===n?t=(0,a.gettext)("Successfully moved %(name)s."):2===n?t=(0,a.gettext)("Successfully moved %(name)s and 1 other item."):(t=(0,a.gettext)("Successfully moved %(name)s and %(amount)s other items."),t=t.replace("%(amount)s",n-1)),t=t.replace("%(name)s",e[0])},getCopyFailedMessage:function(e){var t=void 0,n=e.length;return n>1?(t=(0,a.gettext)("Failed to copy %(name)s and %(amount)s other item(s)."),t=t.replace("%(amount)s",n-1)):t=(0,a.gettext)("Failed to copy %(name)s."),t=t.replace("%(name)s",e[0])},getMoveFailedMessage:function(e){var t=void 0,n=e.length;return n>1?(t=(0,a.gettext)("Failed to move %(name)s and %(amount)s other item(s)."),t=t.replace("%(amount)s",n-1)):t=(0,a.gettext)("Failed to move %(name)s."),t=t.replace("%(name)s",e[0])},handleSearchedItemClick:function(e){if(!0===e.is_dir){var t=a.siteRoot+"library/"+e.repo_id+"/"+e.repo_name+e.path;window.open("about:blank").location.href=t}else{var n=a.siteRoot+"lib/"+e.repo_id+"/file"+o.encodePath(e.path);window.open("about:blank").location.href=n}},generatePassword:function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz0123456789",n="",a=0;a<e;a++)n+=t.charAt(Math.floor(Math.random()*t.length));return n},pathNormalize:function(e){for(var t=e.split("/"),n=[],a=0;a<t.length;a++)"."!==t[a]&&""!==t[a]&&(".."===t[a]?n.pop():n.push(t[a]));return n.join("/")},getEventData:function(e,t){return e.target.dataset?e.target.dataset[t]:e.target.getAttribute("data-"+t)},isHasPermissionToShare:function(e,t,n){var r=e.is_admin,o=e.is_virtual,i=e.encrypted,s=e.owner_email,l=s===a.username;if(i)return!1;if(n&&"file"===n.type){var u=!1;return!a.canGenerateShareLink||"rw"!=t&&"r"!=t||(u=!0),u}if(a.canGenerateShareLink&&("rw"==t||"r"==t))return!0;if(a.canGenerateUploadLink&&"rw"==t)return!0;return!(o||!l&&!r)&&!0},registerGlobalVariable:function(e,t,n){window[e]||(window[e]={}),window[e][t]=n},formatTime:function(e){var t=parseInt(e),n=0,a=0;t>60&&(n=parseInt(t/60),t=parseInt(t%60)),n>60&&(a=parseInt(n/60),n=parseInt(n%60));var r=("00"+parseInt(t)).slice(-2);return r=n>0?("00"+parseInt(n)).slice(-2)+":"+r:"00:"+r,r=a>0?("00"+parseInt(a)).slice(-2)+":"+r:"00:"+r}}},30:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},i=n(0),s=a(i),l=n(7),u=a(l),c=n(31),d=a(c),p="undefined"!==typeof window&&"undefined"!==typeof window.document,f=function e(){var t=this;if(r(this,e),this._bindNotify=function(e){t.notifyHandler=e},this._bindGetToasts=function(e){t.getToastsHandler=e},this._bindCloseAll=function(e){t.closeAllHandler=e},this.getToasts=function(){return t.getToastsHandler()},this.closeAll=function(){return t.closeAllHandler()},this.notify=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"none"}))},this.success=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"success"}))},this.warning=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"warning"}))},this.danger=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t.notifyHandler(e,o({},n,{intent:"danger"}))},p){var n=document.createElement("div");n.setAttribute("data-evergreen-toaster-container",""),document.body.appendChild(n),u.default.render(s.default.createElement(d.default,{bindNotify:this._bindNotify,bindGetToasts:this._bindGetToasts,bindCloseAll:this._bindCloseAll}),n)}};t.default=f},31:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function o(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function l(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(0),p=a(d),f=n(17),h=n(1),m=a(h),g=n(32),v=a(g),y=(0,f.css)({maxWidth:560,margin:"0 auto",top:0,left:0,right:0,position:"fixed",zIndex:999999}),b=function(e){return Object.hasOwnProperty.call(e,"id")},C=function(e){function t(e,n){i(this,t);var a=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return a.getToasts=function(){return a.state.toasts},a.closeAll=function(){a.getToasts().forEach(function(e){return e.close()})},a.notify=function(e,t){if(b(t)){var n=!0,r=!1,i=void 0;try{for(var s,l=a.state.toasts[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;String(u.id).startsWith(t.id)&&a.closeToast(u.id)}}catch(e){r=!0,i=e}finally{try{!n&&l.return&&l.return()}finally{if(r)throw i}}}var c=a.createToastInstance(e,t);return a.setState(function(e){return{toasts:[c].concat(o(e.toasts))}}),c},a.createToastInstance=function(e,n){var r=++t.idCounter,o=b(n)?n.id+"-"+r:r;return{id:o,title:e,description:n.description,hasCloseButton:n.hasCloseButton||!0,duration:n.duration||2,close:function(){return a.closeToast(o)},intent:n.intent}},a.closeToast=function(e){a.setState(function(t){return{toasts:t.toasts.map(function(t){return t.id===e?u({},t,{isShown:!1}):t})}})},a.removeToast=function(e){a.setState(function(t){return{toasts:t.toasts.filter(function(t){return t.id!==e})}})},e.bindNotify(a.notify),e.bindGetToasts(a.getToasts),e.bindCloseAll(a.closeAll),a.state={toasts:[]},a}return l(t,e),c(t,[{key:"render",value:function(){var e=this;return p.default.createElement("span",{className:y},this.state.toasts.map(function(t){var n=t.id,a=t.description,o=r(t,["id","description"]);return p.default.createElement(v.default,u({key:n,onRemove:function(){return e.removeToast(n)}},o),a)}))}}]),t}(p.default.PureComponent);C.propTypes={bindNotify:m.default.func.isRequired,bindGetToasts:m.default.func.isRequired,bindCloseAll:m.default.func.isRequired},C.idCounter=0,t.default=C},313:function(e,t){},314:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(12),v=a(g),y={token:d.default.string,path:d.default.string.isRequired,repoID:d.default.string,target:d.default.oneOfType([d.default.string,d.default.array]),toggleDialog:d.default.func.isRequired},b=void 0,C=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.queryZipProgress=function(){var e=n.state.zipToken;h.seafileAPI.queryZipProgress(e).then(function(t){var a=t.data;n.setState({zipProgress:0==a.total?"100%":(a.zipped/a.total*100).toFixed(2)+"%"}),a.total==a.zipped&&(clearInterval(b),n.props.toggleDialog(),location.href=f.fileServerRoot+"zip/"+e)}).catch(function(e){clearInterval(b);var t=m.Utils.getErrorMsg(e);n.setState({isLoading:!1,errorMsg:t})})},n.cancelZipTask=function(){var e=n.state.zipToken;h.seafileAPI.cancelZipTask(e).then(function(e){}).catch(function(e){})},n.toggleDialog=function(){var e=n.state.zipProgress;e&&"100%"!=e&&(clearInterval(b),n.cancelZipTask()),n.props.toggleDialog()},n.state={isLoading:!0,errorMsg:"",zipProgress:null},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.token,a=t.path,r=t.repoID,o=t.target;(n?h.seafileAPI.getShareLinkZipTask(n,a):h.seafileAPI.zipDownload(r,a,o)).then(function(t){var n=t.data.zip_token;e.setState({isLoading:!1,errorMsg:"",zipToken:n}),e.queryZipProgress(),b=setInterval(e.queryZipProgress,1e3)}).catch(function(t){var n=m.Utils.getErrorMsg(t);e.setState({isLoading:!1,errorMsg:n})})}},{key:"render",value:function(){return u.default.createElement(p.Modal,{isOpen:!0,centered:!0,toggle:this.toggleDialog},u.default.createElement(p.ModalHeader,{toggle:this.toggleDialog},(0,f.gettext)("Download")),u.default.createElement(p.ModalBody,null,u.default.createElement(S,{data:this.state})))}}]),t}(u.default.Component),S=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.data,t=e.isLoading,n=e.errorMsg,a=e.zipProgress;return t?u.default.createElement(v.default,null):n?u.default.createElement("p",{className:"error mt-4 text-center"},n):u.default.createElement("p",{className:"mt-4 text-center"},(0,f.gettext)("Packaging...")+" "+a)}}]),t}(u.default.Component);C.propTypes=y,t.default=C},32:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(17),d=n(1),p=a(d),f=n(49),h=a(f),m=n(33),g=a(m),v={deceleration:"cubic-bezier(0.0, 0.0, 0.2, 1)",acceleration:"cubic-bezier(0.4, 0.0, 1, 1)",spring:"cubic-bezier(0.175, 0.885, 0.320, 1.175)"},y=c.css.keyframes("openAnimation",{from:{opacity:0,transform:"translateY(-120%)"},to:{transform:"translateY(0)"}}),b=c.css.keyframes("closeAnimation",{from:{transform:"scale(1)",opacity:1},to:{transform:"scale(0.9)",opacity:0}}),C=(0,c.css)({display:"flex",flexDirection:"column",alignItems:"center",height:0,transition:"all 240ms "+v.deceleration,'&[data-state="entering"], &[data-state="entered"]':{animation:y+" 240ms "+v.spring+" both"},'&[data-state="exiting"]':{animation:b+" 120ms "+v.acceleration+" both"}}),S=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.state={isShown:!0,height:0},a.close=function(){a.clearCloseTimer(),a.setState({isShown:!1})},a.startCloseTimer=function(){a.props.duration&&(a.closeTimer=setTimeout(function(){a.close()},1e3*a.props.duration))},a.clearCloseTimer=function(){a.closeTimer&&(clearTimeout(a.closeTimer),a.closeTimer=null)},a.handleMouseEnter=function(){a.clearCloseTimer()},a.handleMouseLeave=function(){a.startCloseTimer()},a.onRef=function(e){if(null!==e){var t=e.getBoundingClientRect(),n=t.height;a.setState({height:n})}},i=n,o(a,i)}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(e){e.isShown!==this.props.isShown&&this.setState({isShown:this.props.isShown})}},{key:"componentDidMount",value:function(){this.startCloseTimer()}},{key:"componentWillUnmount",value:function(){this.clearCloseTimer()}},{key:"render",value:function(){var e=this;return u.default.createElement(h.default,{appear:!0,unmountOnExit:!0,timeout:240,in:this.state.isShown,onExited:this.props.onRemove},function(t){return u.default.createElement("div",{"data-state":t,className:C,onMouseEnter:e.handleMouseEnter,onMouseLeave:e.handleMouseLeave,style:{height:e.state.height,zIndex:e.props.zIndex,marginBottom:e.state.isShown?0:-e.state.height}},u.default.createElement("div",{ref:e.onRef,style:{padding:8}},u.default.createElement(g.default,{intent:e.props.intent,title:e.props.title,children:e.props.children,isRemoveable:e.props.hasCloseButton,onRemove:function(){return e.close()}})))})}}]),t}(u.default.PureComponent);S.propTypes={zIndex:p.default.number,duration:p.default.number,onRemove:p.default.func,intent:p.default.oneOf(["none","success","warning","danger"]).isRequired,title:p.default.node,children:p.default.node,hasCloseButton:p.default.bool,isShown:p.default.bool},S.defaultProps={intent:"none"},t.default=S},320:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){a(this,e),this.id=t.repo_tag_id,this.fileCount=t.files_count,this.name=t.tag_name,this.color=t.tag_color};t.default=r},322:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(402),f=a(p),h=n(6),m=n(2),g=n(3),v={tagName:d.default.string,item:d.default.object.isRequired,toggleClass:d.default.string,isHandleContextMenuEvent:d.default.bool,getMenuList:d.default.func.isRequired,onMenuItemClick:d.default.func.isRequired,freezeItem:d.default.func,unfreezeItem:d.default.func},y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onShowMenu=function(){},n.onHideMenu=function(){n.state.isItemMenuShow&&(n.setState({isItemMenuShow:!1}),"function"===typeof n.props.unfreezeItem&&n.props.unfreezeItem())},n.onDropdownToggleClick=function(e){e.preventDefault(),e.stopPropagation(),n.toggleOperationMenu()},n.toggleOperationMenu=function(){n.setState({isItemMenuShow:!n.state.isItemMenuShow},function(){n.state.isItemMenuShow&&"function"===typeof n.props.freezeItem?n.props.freezeItem():n.state.isItemMenuShow||"function"!==typeof n.props.unfreezeItem||n.props.unfreezeItem()})},n.onMenuItemClick=function(e){var t=g.Utils.getEventData(e,"toggle"),a=n.props.item;n.props.onMenuItemClick(t,e,a)},n.state={menuList:[],isItemMenuShow:!1},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.props.isHandleContextMenuEvent&&(this.listenerId=f.default.register(this.onShowMenu,this.onHideMenu));var e=this.props.item,t=this.props.getMenuList(e);this.setState({menuList:t})}},{key:"componentWillReceiveProps",value:function(e){var t=e.item;if(t.name!==this.props.item.name){var n=this.props.getMenuList(t);this.setState({menuList:n})}}},{key:"componentWillUnmount",value:function(){this.props.isHandleContextMenuEvent&&this.listenerId&&f.default.unregister(this.listenerId)}},{key:"render",value:function(){var e=this,t=this.state.menuList,n=this.props,a=n.toggleClass,r=n.tagName;return a="sf-dropdown-toggle "+a,t.length?r&&"button"===r?u.default.createElement(h.ButtonDropdown,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick,title:(0,m.gettext)("More Operations")},u.default.createElement(h.DropdownToggle,{className:a,"data-toggle":"dropdown",title:(0,m.gettext)("More Operations"),"aria-expanded":this.state.isItemMenuShow}),u.default.createElement(h.DropdownMenu,null,t.map(function(t,n){return"Divider"===t?u.default.createElement(h.DropdownItem,{key:n,divider:!0}):u.default.createElement(h.DropdownItem,{key:n,"data-toggle":t.key,onClick:e.onMenuItemClick},t.value)}))):u.default.createElement(h.Dropdown,{isOpen:this.state.isItemMenuShow,toggle:this.onDropdownToggleClick},u.default.createElement(h.DropdownToggle,{tag:r||"i",className:a,title:(0,m.gettext)("More Operations"),"data-toggle":"dropdown","aria-expanded":this.state.isItemMenuShow}),u.default.createElement(h.DropdownMenu,null,t.map(function(t,n){return"Divider"===t?u.default.createElement(h.DropdownItem,{key:n,divider:!0}):u.default.createElement(h.DropdownItem,{key:n,"data-toggle":t.key,onClick:e.onMenuItemClick},t.value)}))):""}}]),t}(u.default.Component);y.defaultProps={isHandleContextMenuEvent:!0,toggleClass:"sf2-icon-caret-down"},y.propTypes=v,t.default=y},323:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(3),m={fileType:d.default.string,parentPath:d.default.string.isRequired,onAddFile:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired,addFileCancel:d.default.func.isRequired},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.checkDuplicatedName(),t=n.state.childName;if(e){var a=(0,f.gettext)('The name "{name}" is already taken. Please choose a different name.');a=a.replace("{name}",h.Utils.HTMLescape(t)),n.setState({errMessage:a})}else{var r=n.state.parentPath+t,o=n.state.isDraft;n.props.onAddFile(r,o)}}},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.handleCheck=function(){var e=n.state.childName.lastIndexOf(".");if(n.state.isDraft){var t=n.state.childName.substring(e-7,e),a=n.state.childName.substring(0,e-7),r=n.state.childName.substring(e);"(draft)"===t?n.setState({childName:a+r,isDraft:!n.state.isDraft}):n.setState({isDraft:!n.state.isDraft})}if(!n.state.isDraft)if(e>0){var o=n.state.childName.substring(0,e),i=n.state.childName.substring(e);n.setState({childName:o+"(draft)"+i,isDraft:!n.state.isDraft})}else 0===e?n.setState({childName:"(draft)"+n.state.childName,isDraft:!n.state.isdraft}):n.setState({isDraft:!n.state.isdraft})},n.toggle=function(){n.props.addFileCancel()},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.childName)},n.state={parentPath:"",childName:e.fileType||"",isDraft:!1,errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"}),this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("New File")),u.default.createElement(p.ModalBody,null,u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{for:"fileName"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{id:"fileName",onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.childName,onChange:this.handleChange})),".md"==this.props.fileType&&f.isDocs&&u.default.createElement(p.FormGroup,{check:!0},u.default.createElement(p.Label,{check:!0},u.default.createElement(p.Input,{type:"checkbox",onChange:this.handleCheck}),"  ",(0,f.gettext)("This is a draft")))),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},324:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(3),m=n(52),g=a(m),v={path:d.default.string.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object,selectedDirentList:d.default.array,isMutipleOperation:d.default.bool.isRequired,onItemMove:d.default.func,onItemsMove:d.default.func,onCancelMove:d.default.func.isRequired,repoEncrypted:d.default.bool.isRequired},y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.props.isMutipleOperation?n.moveItems():n.moveItem()},n.moveItems=function(){var e=n.props.repoID,t=n.state,a=t.repo,r=t.selectedPath,o=(0,f.gettext)("Invalid destination path");if(!a||""===r)return void n.setState({errMessage:o});var i=n.props.selectedDirentList,s=[];if(i.forEach(function(e){var t=h.Utils.joinPath(n.props.path,e.name);s.push(t)}),s.some(function(e){return e===r}))return void n.setState({errMessage:o});if(r&&r===n.props.path&&a.repo_id===e)return void n.setState({errMessage:o});var l="";if(s.some(function(e){var t=r.length>e.length&&r.indexOf(e)>-1;return t&&(l=e),t}))return o=(0,f.gettext)("Can not move directory %(src)s to its subdirectory %(des)s"),o=o.replace("%(src)s",l),o=o.replace("%(des)s",r),void n.setState({errMessage:o});n.props.onItemsMove(a,r),n.toggle()},n.moveItem=function(){var e=n.props.repoID,t=n.state,a=t.repo,r=t.selectedPath,o=h.Utils.joinPath(n.props.path,n.props.dirent.name),i=(0,f.gettext)("Invalid destination path");return!a||a.repo_id===e&&""===r?void n.setState({errMessage:i}):r&&o===r?void n.setState({errMessage:i}):r&&n.props.path===r&&a.repo_id===e?void n.setState({errMessage:i}):r&&r.length>o.length&&r.indexOf(o)>-1?(i=(0,f.gettext)("Can not move directory %(src)s to its subdirectory %(des)s"),i=i.replace("%(src)s",o),i=i.replace("%(des)s",r),void n.setState({errMessage:i})):(n.props.onItemMove(a,n.props.dirent,r,n.props.path),void n.toggle())},n.toggle=function(){n.props.onCancelMove()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.state={repo:null,selectedPath:"",errMessage:""},n}return i(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.errMessage!==t.errMessage}},{key:"render",value:function(){var e=(0,f.gettext)("Move {placeholder} to");e=this.props.isMutipleOperation?(0,f.gettext)("Move selected item(s) to:"):e.replace("{placeholder}",'<span class="op-target">'+h.Utils.HTMLescape(this.props.dirent.name)+"</span>");var t=this.props.repoEncrypted?"only_current_library":"current_repo_and_other_repos";return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:e}})),u.default.createElement(p.ModalBody,null,u.default.createElement(g.default,{repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:t}),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",style:{margin:"0.5rem"}},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);y.propTypes=v,t.default=y},325:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(3),m=n(52),g=a(m),v={path:d.default.string.isRequired,repoID:d.default.string.isRequired,dirent:d.default.object,selectedDirentList:d.default.array,isMutipleOperation:d.default.bool.isRequired,onItemCopy:d.default.func,onItemsCopy:d.default.func,onCancelCopy:d.default.func.isRequired,repoEncrypted:d.default.bool.isRequired},y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.props.isMutipleOperation?n.copyItems():n.copyItem()},n.copyItems=function(){var e=(n.props.repoID,n.state),t=e.repo,a=e.selectedPath,r=(0,f.gettext)("Invalid destination path");if(!t||""===a)return void n.setState({errMessage:r});var o=n.props.selectedDirentList,i=[];if(o.forEach(function(e){var t=h.Utils.joinPath(n.props.path,e.name);i.push(t)}),i.some(function(e){return e===a}))return void n.setState({errMessage:r});var s="";if(i.some(function(e){var t=a.length>e.length&&a.indexOf(e)>-1;return t&&(s=e),t}))return r=(0,f.gettext)("Can not move directory %(src)s to its subdirectory %(des)s"),r=r.replace("%(src)s",s),r=r.replace("%(des)s",a),void n.setState({errMessage:r});n.props.onItemsCopy(t,a),n.toggle()},n.copyItem=function(){var e=n.state,t=e.repo,a=e.repoID,r=e.selectedPath,o=h.Utils.joinPath(n.props.path,n.props.dirent.name),i="Invalid destination path";return!t||t.repo_id===a&&""===r?void n.setState({errMessage:i}):r&&o===r?void n.setState({errMessage:i}):r&&n.props.path===r&&t.repo_id===a?void n.setState({errMessage:i}):r&&r.length>o.length&&r.indexOf(o)>-1?(i=(0,f.gettext)("Can not copy directory %(src)s to its subdirectory %(des)s"),i=i.replace("%(src)s",o),i=i.replace("%(des)s",r),void n.setState({errMessage:i})):(n.props.onItemCopy(t,n.props.dirent,r,n.props.path),void n.toggle())},n.toggle=function(){n.props.onCancelCopy()},n.onDirentItemClick=function(e,t){n.setState({repo:e,selectedPath:t,errMessage:""})},n.onRepoItemClick=function(e){n.setState({repo:e,selectedPath:"/",errMessage:""})},n.state={repo:null,selectedPath:"",errMessage:""},n}return i(t,e),s(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.state.errMessage!==t.errMessage}},{key:"render",value:function(){var e=(0,f.gettext)("Copy {placeholder} to");e=this.props.isMutipleOperation?(0,f.gettext)("Copy selected item(s) to:"):e.replace("{placeholder}",'<span class="op-target">'+h.Utils.HTMLescape(this.props.dirent.name)+"</span>");var t=this.props.repoEncrypted?"only_current_library":"current_repo_and_other_repos";return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},u.default.createElement("div",{dangerouslySetInnerHTML:{__html:e}})),u.default.createElement(p.ModalBody,null,u.default.createElement(g.default,{repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:t}),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",style:{margin:"0.5rem"}},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);y.propTypes=v,t.default=y},33:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function o(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=function(e){return e&&e.__esModule?e:{default:e}}(l),c=n(17),d=function(e){function t(e){a(this,t);var n=r(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.containerStyle=(0,c.css)({borderRadius:"3px",backgroundColor:"#fff",padding:"10px 16px",display:"flex",boxSizing:"border-box",boxShadow:"rgba(67, 90, 111, 0.3) 0px 0px 1px, rgba(67, 90, 111, 0.47) 0px 8px 10px -4px",justifyContent:"space-between",flexDirection:"row"}),n.containerBorderSuccess=(0,c.css)({borderLeft:"3px solid rgb(71, 184, 129)"}),n.containerBorderWarn=(0,c.css)({borderLeft:"3px solid rgb(217, 130, 43)"}),n.containerBorderDanger=(0,c.css)({borderLeft:"3px solid rgb(236, 76, 71)"}),n.containerBorderNotify=(0,c.css)({borderLeft:"3px solid rgb(16, 112, 202)"}),n.toastTextTitle=(0,c.css)({fontWeight:"600",fontSize:"14px",color:"#435a6f",margin:"0"}),n.toastTextChild=(0,c.css)({fontSize:"14px",color:"#999",margin:"0"}),n.toastClose=(0,c.css)({marginLeft:"15px",height:"24px",width:"24px",lineHeight:"22px",fontWeight:"700",textAlign:"center",fontSize:"20px",color:"#000",cursor:"pointer",opacity:"0.5",":hover":{opacity:1}}),n.toastIcon=(0,c.css)({marginRight:"10px",width:"14px",height:"20px",lineHeight:"20px"}),n}return o(t,e),s(t,[{key:"getContainerStyle",value:function(e){switch(e){case"success":return{borderStyle:this.containerBorderSuccess,iconColor:(0,c.css)({color:"rgb(71, 184, 129)"}),iconClass:"fa fa-check-circle"};case"warning":return{borderStyle:this.containerBorderWarn,iconColor:(0,c.css)({color:"rgb(217, 130, 43)"}),iconClass:"fa fa-exclamation-triangle"};case"none":return{borderStyle:this.containerBorderNotify,iconColor:(0,c.css)({color:"rgb(16, 112, 202)"}),iconClass:"fa fa-exclamation-circle"};case"danger":return{borderStyle:this.containerBorderDanger,iconColor:(0,c.css)({color:"rgb(236, 76, 71)"}),iconClass:"fa fa-exclamation-circle"}}}},{key:"render",value:function(){var e=this.getContainerStyle(this.props.intent);return u.default.createElement("div",(0,c.css)(e.borderStyle,this.containerStyle),u.default.createElement("div",{className:this.toastIcon},u.default.createElement("i",i({className:e.iconClass},e.iconColor))),u.default.createElement("div",{className:this.toastTextContainer},u.default.createElement("p",{className:this.toastTextTitle},this.props.title),this.props.children?u.default.createElement("p",{className:this.toastTextChild},this.props.children):null),u.default.createElement("div",{onClick:this.props.onRemove,className:this.toastClose},u.default.createElement("span",null,"\xd7")))}}]),t}(u.default.PureComponent);t.default=d},37:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=function(){function e(t){var n=t.path,r=t.object,o=t.isLoaded,i=t.isPreload,s=t.isExpanded,l=t.parentNode;a(this,e),this.path=n||r.name,this.object=r,this.isLoaded=o||!1,this.isPreload=i||!1,this.isExpanded=s||!1,this.children=[],this.parentNode=l||null}return r(e,[{key:"clone",value:function(t){var n=new e({path:this.path,object:this.object.clone(),isLoaded:this.isLoaded,isPreload:this.isPreload,isExpanded:this.isExpanded,parentNode:t||null});return n.children=this.children.map(function(e){return e.clone(n)}),n}},{key:"setParent",value:function(e){this.path=this.generatePath(e),this.parentNode=e,this.isLoaded=!1}},{key:"hasChildren",value:function(){return 0!==this.children.length}},{key:"addChild",value:function(e){e.setParent(this);var t=this.children;if(e.object.isDir())this.children.unshift(e);else{for(var n=-1,a=0;a<t.length;a++)if(!t[a].object.isDir()){n=a;break}-1===n?this.children.push(e):0===n?this.children.unshift(e):this.children.splice(n,0,e)}}},{key:"addChildren",value:function(e){var t=this;e.forEach(function(e){e.setParent(t)}),this.children=e}},{key:"deleteChild",value:function(e){var t=this.children.filter(function(t){return t!==e});this.children=t}},{key:"rename",value:function(e){this.object.name=e,this.path=this.generatePath(this.parentNode),this.isExpanded?this.updateChildrenPath(this):this.isLoaded=!1}},{key:"updateChildrenPath",value:function(e){e.children.forEach(function(e){e.path=e.generatePath(e.parentNode),e.isExpanded?e.updateChildrenPath(e):e.isLoaded=!1})}},{key:"updateObjectProperties",value:function(e,t){var n=this;Array.isArray(e)&&Array.isArray(t)?e.forEach(function(e,a){n.object[e]=t[a]}):this.object[e]=t}},{key:"generatePath",value:function(e){return"/"===e.path?e.path+this.object.name:e.path+"/"+this.object.name}},{key:"serializeToJson",value:function(){var e=[];return this.hasChildren&&(e=this.children.map(function(e){return e.serializeToJson()})),{path:this.path,object:this.object.clone(),isLoaded:this.isLoaded,isPreload:this.isPreload,isExpanded:this.isExpanded,parentNode:this.parentNode,children:e}}}],[{key:"deserializefromJson",value:function(t){var n=t.path,a=t.object,r=t.isLoaded,o=t.isPreload,i=t.isExpanded,s=t.parentNode,l=t.children,u=void 0===l?[]:l;return a=a.clone(),new e({path:n,object:a,isLoaded:r,isPreload:o,isExpanded:i,parentNode:s,children:u.map(function(t){return e.deserializefromJson(t)})})}}]),e}();t.default=o},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.seafileAPI=void 0;var a=n(48),r=function(e){return e&&e.__esModule?e:{default:e}}(a),o=n(64),i=n(2),s=new o.SeafileAPI,l=r.default.load("sfcsrftoken");s.initForSeahubUsage({siteRoot:i.siteRoot,xcsrfHeaders:l}),t.seafileAPI=s},401:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(813),h=a(f),m=n(814),g=a(m),v=n(24),y=a(v),b={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,dirent:d.default.object.isRequired,relatedFiles:d.default.array,viewMode:d.default.oneOf(["list_related_file","add_related_file"]).isRequired},C=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onAddRelatedFileToggle=function(){n.setState({showListRelatedFileDialog:!1})},n.onCloseAddRelatedFileDialog=function(){n.setState({showListRelatedFileDialog:!0})},n.state={showListRelatedFileDialog:"list_related_file"===e.viewMode},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(y.default,null,u.default.createElement(p.Modal,{isOpen:!0,toggle:this.props.toggleCancel,size:"lg",style:{width:"650px"}},this.state.showListRelatedFileDialog&&u.default.createElement(g.default,{filePath:this.props.filePath,relatedFiles:this.props.relatedFiles,repoID:this.props.repoID,toggleCancel:this.props.toggleCancel,addRelatedFileToggle:this.onAddRelatedFileToggle,onRelatedFileChange:this.props.onRelatedFileChange}),!this.state.showListRelatedFileDialog&&u.default.createElement(h.default,{filePath:this.props.filePath,repoID:this.props.repoID,toggleCancel:this.onCloseAddRelatedFileDialog,onRelatedFileChange:this.props.onRelatedFileChange,dirent:this.props.dirent,onClose:this.props.toggleCancel})))}}]),t}(u.default.Component);C.propTypes=b,t.default=C},402:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(213),o=n(291),i=function e(){var t=this;a(this,e),this.handleShowEvent=function(e){for(var n in t.callbacks)(0,o.hasOwnProp)(t.callbacks,n)&&t.callbacks[n].show(e)},this.handleHideEvent=function(e){for(var n in t.callbacks)(0,o.hasOwnProp)(t.callbacks,n)&&t.callbacks[n].hide(e)},this.register=function(e,n){var a=(0,o.uniqueId)();return t.callbacks[a]={show:e,hide:n},a},this.unregister=function(e){e&&t.callbacks[e]&&delete t.callbacks[e]},this.callbacks={},o.canUseDOM&&(window.addEventListener(r.MENU_SHOW,this.handleShowEvent),window.addEventListener(r.MENU_HIDE,this.handleHideEvent))};t.default=new i},403:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(402),f=a(p),h=n(213),m=n(291),g=n(3),v={id:d.default.string.isRequired,rtl:d.default.bool,onMenuItemClick:d.default.func.isRequired,onShowMenu:d.default.func,onHideMenu:d.default.func},y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.registerHandlers=function(){document.addEventListener("mousedown",n.handleOutsideClick),document.addEventListener("touchstart",n.handleOutsideClick),document.addEventListener("scroll",n.handleHide),document.addEventListener("contextmenu",n.handleHide),document.addEventListener("keydown",n.handleKeyNavigation),window.addEventListener("resize",n.handleHide)},n.unregisterHandlers=function(){document.removeEventListener("mousedown",n.handleOutsideClick),document.removeEventListener("touchstart",n.handleOutsideClick),document.removeEventListener("scroll",n.handleHide),document.removeEventListener("contextmenu",n.handleHide),document.removeEventListener("keydown",n.handleKeyNavigation),window.removeEventListener("resize",n.handleHide)},n.handleShow=function(e){if(e.detail.id===n.props.id&&!n.state.isVisible){var t=e.detail.position,a=t.x,r=t.y,o=e.detail,i=o.currentObject,s=o.menuList;n.setState({isVisible:!0,x:a,y:r,currentObject:i,menuList:s}),n.registerHandlers(),(0,m.callIfExists)(n.props.onShowMenu,e)}},n.handleHide=function(e){!n.state.isVisible||e.detail&&e.detail.id&&e.detail.id!==n.props.id||(n.unregisterHandlers(),n.setState({isVisible:!1}),(0,m.callIfExists)(n.props.onHideMenu,e))},n.handleOutsideClick=function(e){n.menu.contains(e.target)||(0,h.hideMenu)()},n.handleMouseLeave=function(e){e.preventDefault(),n.props.hideOnLeave&&(0,h.hideMenu)()},n.handleContextMenu=function(e){n.handleHide(e)},n.handleKeyNavigation=function(e){!1!==n.state.isVisible&&(e.preventDefault(),n.hideMenu(e))},n.hideMenu=function(e){27!==e.keyCode&&13!==e.keyCode||(0,h.hideMenu)()},n.getMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a={top:t,left:e};if(!n.menu)return a;var r=window,o=r.innerWidth,i=r.innerHeight,s=n.menu.getBoundingClientRect();return t+s.height>i&&(a.top-=s.height),e+s.width>o&&(a.left-=s.width),a.top<0&&(a.top=s.height<i?(i-s.height)/2:0),a.left<0&&(a.left=s.width<o?(o-s.width)/2:0),a},n.getRTLMenuPosition=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a={top:t,left:e};if(!n.menu)return a;var r=window,o=r.innerWidth,i=r.innerHeight,s=n.menu.getBoundingClientRect();return a.left=e-s.width,t+s.height>i&&(a.top-=s.height),a.left<0&&(a.left+=s.width),a.top<0&&(a.top=s.height<i?(i-s.height)/2:0),a.left+s.width>o&&(a.left=s.width<o?(o-s.width)/2:0),a},n.onMenuItemClick=function(e){e.stopPropagation();var t=g.Utils.getEventData(e,"operation"),a=n.state.currentObject;n.props.onMenuItemClick(t,a,e)},n.state={x:0,y:0,isVisible:!1,currentObject:null,menuList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.listenId=f.default.register(this.handleShow,this.handleHide)}},{key:"componentDidUpdate",value:function(){var e=this;if(this.state.isVisible){var t=window.requestAnimationFrame||setTimeout;t(function(){var n=e.state,a=n.x,r=n.y,o=e.props.rtl?e.getRTLMenuPosition(a,r):e.getMenuPosition(a,r),i=o.top,s=o.left;t(function(){e.menu&&(e.menu.style.top=i+"px",e.menu.style.left=s+"px",e.menu.style.opacity=1,e.menu.style.pointerEvents="auto")})})}else{if(!this.menu)return;this.menu.style.opacity=0,this.menu.style.pointerEvents="none"}}},{key:"componentWillUnmount",value:function(){this.listenId&&f.default.unregister(this.listenId),this.unregisterHandlers()}},{key:"render",value:function(){var e=this,t={position:"fixed",opacity:0,pointerEvents:"none",display:"block"};return u.default.createElement("div",{role:"menu",className:"seafile-contextmenu dropdown-menu",style:t,ref:function(t){e.menu=t}},this.state.menuList.map(function(t,n){return"Divider"===t?u.default.createElement("div",{key:n,className:"seafile-divider dropdown-divider"}):u.default.createElement("button",{key:n,className:"seafile-contextmenu-item dropdown-item","data-operation":t.key,onClick:e.onMenuItemClick},t.value)}))}}]),t}(u.default.Component);y.propTypes=v,t.default=y},404:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(3),m={fileType:d.default.string,parentPath:d.default.string.isRequired,onAddFolder:d.default.func.isRequired,checkDuplicatedName:d.default.func.isRequired,addFolderCancel:d.default.func.isRequired},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=function(e){e.target.value.trim()?n.setState({isSubmitBtnActive:!0}):n.setState({isSubmitBtnActive:!1}),n.setState({childName:e.target.value})},n.handleSubmit=function(){if(n.state.isSubmitBtnActive){var e=n.state.childName;if(n.checkDuplicatedName()){var t=(0,f.gettext)('The name "{name}" is already taken. Please choose a different name.');t=t.replace("{name}",h.Utils.HTMLescape(e)),n.setState({errMessage:t})}else{var a=n.state.parentPath+e;n.props.onAddFolder(a)}}},n.handleKeyPress=function(e){"Enter"===e.key&&(n.handleSubmit(),e.preventDefault())},n.toggle=function(){n.props.addFolderCancel()},n.checkDuplicatedName=function(){return n.props.checkDuplicatedName(n.state.childName)},n.state={parentPath:"",childName:"",errMessage:"",isSubmitBtnActive:!1},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this.props.parentPath;"/"===e[e.length-1]?this.setState({parentPath:e}):this.setState({parentPath:e+"/"}),this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this;return u.default.createElement(p.Modal,{isOpen:!0,toggle:this.toggle},u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,f.gettext)("New Folder")),u.default.createElement(p.ModalBody,null,u.default.createElement(p.Form,null,u.default.createElement(p.FormGroup,null,u.default.createElement(p.Label,{for:"folderName"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{id:"folderName",value:this.state.childName,innerRef:function(t){e.newInput=t},onKeyPress:this.handleKeyPress,onChange:this.handleChange}))),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger",className:"mt-2"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit,disabled:!this.state.isSubmitBtnActive},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},43:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(9),s=a(i),l=n(3),u=n(71),c=a(u),d=function(){function e(t){if(r(this,e),this.id=t.id||"0000000000000000",this.name=t.name,this.type=t.type,this.mtime=t.mtime,this.mtime_relative=s.default.unix(t.mtime).fromNow(),this.permission=t.permission||"rw",this.isSelected=!1,this.starred=t.starred||!1,"file"===t.type){this.size_original=t.size,this.size=l.Utils.bytesToSize(t.size),this.is_locked=t.is_locked||!1,this.lock_time=t.lock_time||"",this.lock_owner=t.lock_owner||null,this.lock_owner_name=t.lock_owner_name||null,this.locked_by_me=t.locked_by_me||!1,this.modifier_name=t.modifier_name||"",this.modifier_email=t.modifier_email||"",this.modifier_contact_email=t.modifier_contact_email||"";var n=[];t.file_tags&&(n=t.file_tags.map(function(e){return new c.default(e)})),this.file_tags=n,t.encoded_thumbnail_src&&(this.encoded_thumbnail_src=t.encoded_thumbnail_src)}}return o(e,[{key:"clone",value:function(){return new e(this)}},{key:"isDir",value:function(){return"file"!==this.type}}]),e}();t.default=d},44:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(7),f=a(p),h=n(3),m=n(4),g=n(2),v=n(5),y=a(v),b={isAdminPanel:d.default.bool},C=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.getContainer=function(){return f.default.findDOMNode(n)},n.handleProps=function(){n.state.showInfo?n.addEvents():n.removeEvents()},n.addEvents=function(){["click","touchstart","keyup"].forEach(function(e){return document.addEventListener(e,n.handleDocumentClick,!0)})},n.removeEvents=function(){["click","touchstart","keyup"].forEach(function(e){return document.removeEventListener(e,n.handleDocumentClick,!0)})},n.handleDocumentClick=function(e){if(!e||3!==e.which&&("keyup"!==e.type||e.which===h.Utils.keyCodes.tab)){var t=n.getContainer();(!t.contains(e.target)||t===e.target||"keyup"===e.type&&e.which!==h.Utils.keyCodes.tab)&&n.setState({showInfo:!n.state.showInfo})}},n.onClickAccount=function(){n.isFirstMounted?(m.seafileAPI.getAccountInfo().then(function(e){n.setState({userName:e.data.name,contactEmail:e.data.email,usageRate:e.data.space_usage,quotaUsage:h.Utils.bytesToSize(e.data.usage),quotaTotal:h.Utils.bytesToSize(e.data.total),isStaff:e.data.is_staff,isOrgStaff:1===e.data.is_org_staff,showInfo:!n.state.showInfo})}).catch(function(e){var t=h.Utils.getErrorMsg(e);y.default.danger(t)}),n.isFirstMounted=!1):n.setState({showInfo:!n.state.showInfo})},n.renderMenu=function(){return n.state.isStaff&&n.props.isAdminPanel?u.default.createElement("a",{href:g.siteRoot,title:(0,g.gettext)("Exit Admin Panel"),className:"item"},(0,g.gettext)("Exit Admin Panel")):n.state.isOrgStaff&&n.props.isAdminPanel?u.default.createElement("a",{href:g.siteRoot,title:(0,g.gettext)("Exit Organization Admin"),className:"item"},(0,g.gettext)("Exit Organization Admin")):n.state.isStaff?u.default.createElement("a",{href:g.siteRoot+"sys/useradmin/",title:(0,g.gettext)("System Admin"),className:"item"},(0,g.gettext)("System Admin")):n.state.isOrgStaff?u.default.createElement("a",{href:g.siteRoot+"org/useradmin/",title:(0,g.gettext)("Organization Admin"),className:"item"},(0,g.gettext)("Organization Admin")):void 0},n.renderAvatar=function(){return u.default.createElement("img",{src:g.appAvatarURL,width:"36",height:"36",className:"avatar",alt:(0,g.gettext)("Avatar")})},n.state={showInfo:!1,userName:"",contactEmail:"",quotaUsage:"",quotaTotal:"",isStaff:!1,isOrgStaff:!1,usageRate:""},n.isFirstMounted=!0,n}return i(t,e),s(t,[{key:"componentDidUpdate",value:function(e){this.handleProps()}},{key:"render",value:function(){return u.default.createElement("div",{id:"account"},u.default.createElement("a",{id:"my-info",onClick:this.onClickAccount,className:"account-toggle no-deco d-none d-md-block","aria-label":"View profile and more"},u.default.createElement("span",null,this.renderAvatar()),u.default.createElement("span",{className:"fas fa-caret-down vam"})),u.default.createElement("span",{className:"account-toggle sf2-icon-more mobile-icon d-md-none","aria-label":"View profile and more",onClick:this.onClickAccount}),u.default.createElement("div",{id:"user-info-popup",className:"account-popup sf-popover "+(this.state.showInfo?"":"hide")},u.default.createElement("div",{className:"outer-caret up-outer-caret"},u.default.createElement("div",{className:"inner-caret"})),u.default.createElement("div",{className:"sf-popover-con"},u.default.createElement("div",{className:"item o-hidden"},this.renderAvatar(),u.default.createElement("div",{className:"txt"},this.state.userName)),u.default.createElement("div",{id:"space-traffic"},u.default.createElement("div",{className:"item"},u.default.createElement("p",null,(0,g.gettext)("Used:")," ",this.state.quotaUsage," / ",this.state.quotaTotal),u.default.createElement("div",{id:"quota-bar"},u.default.createElement("span",{id:"quota-usage",className:"usage",style:{width:this.state.usageRate}})))),u.default.createElement("a",{href:g.siteRoot+"profile/",className:"item"},(0,g.gettext)("Settings")),this.renderMenu(),u.default.createElement("a",{href:g.siteRoot+"accounts/logout/",className:"item"},(0,g.gettext)("Log out")))))}}]),t}(l.Component);C.defaultProps={isAdminPanel:!1},C.propTypes=b,t.default=C},5:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(30),r=function(e){return e&&e.__esModule?e:{default:e}}(a),o=new r.default;t.default=o},506:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(3),g={repoID:d.default.string.isRequired,onRepoTagCreated:d.default.func,toggleCancel:d.default.func.isRequired,onClose:d.default.func.isRequired},v=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputNewName=function(e){n.setState({tagName:e.target.value}),n.state.errorMsg&&n.setState({errorMsg:""})},n.selectTagcolor=function(e){n.setState({tagColor:e.target.value})},n.createTag=function(){var e=n.state.tagName,t=n.state.tagColor,a=n.props.repoID;h.seafileAPI.createRepoTag(a,e,t).then(function(e){var t=e.data.repo_tag.repo_tag_id;n.props.onRepoTagCreated&&n.props.onRepoTagCreated(t),n.props.toggleCancel()}).catch(function(t){var a=void 0;500===t.response.status?a=(0,f.gettext)("Internal Server Error"):400===t.response.status&&(a=(0,f.gettext)('Tag "{name}" already exists.'),a=a.replace("{name}",m.Utils.HTMLescape(e))),n.setState({errorMsg:a})})},n.handleKeyPress=function(e){"Enter"===e.key&&n.createTag()},n.state={tagName:"",tagColor:"",newTag:{},errorMsg:"",colorList:["#FFA8A8","#FFA94D","#FFD43B","#A0EC50","#A9E34B","#63E6BE","#4FD2C9","#72C3FC","#91A7FF","#E599F7","#B197FC","#F783AC","#CED4DA"]},n.newInput=u.default.createRef(),n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.setState({tagColor:this.state.colorList[0]}),this.newInput.focus(),this.newInput.setSelectionRange(0,0)}},{key:"render",value:function(){var e=this,t=this.state.colorList,n=!!this.state.tagName.trim();return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.props.toggleCancel,"aria-label":(0,f.gettext)("Back")}),(0,f.gettext)("New Tag")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{role:"form",className:"tag-create"},u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Name")),u.default.createElement(p.Input,{onKeyPress:this.handleKeyPress,innerRef:function(t){e.newInput=t},value:this.state.tagName,onChange:this.inputNewName}),u.default.createElement("div",{className:"mt-2"},u.default.createElement("span",{className:"error"},this.state.errorMsg))),u.default.createElement("div",{className:"form-group"},u.default.createElement("label",{className:"form-label"},(0,f.gettext)("Select a color")),u.default.createElement("div",{className:"row gutters-xs"},t.map(function(t,n){return u.default.createElement("div",{key:n,className:"col-auto",onChange:e.selectTagcolor},u.default.createElement("label",{className:"colorinput"},0===n?u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",defaultChecked:!0,onClick:e.selectTagcolor}):u.default.createElement("input",{name:"color",type:"radio",value:t,className:"colorinput-input",onClick:e.selectTagcolor}),u.default.createElement("span",{className:"colorinput-color",style:{backgroundColor:t}})))}))))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleCancel},(0,f.gettext)("Cancel")),n?u.default.createElement(p.Button,{color:"primary",onClick:this.createTag},(0,f.gettext)("Save")):u.default.createElement(p.Button,{color:"primary",disabled:!0},(0,f.gettext)("Save"))))}}]),t}(u.default.Component);v.propTypes=g,t.default=v},507:function(e,t){},511:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(512),h=a(f);n(520);var m={imageItems:d.default.array.isRequired,imageIndex:d.default.number.isRequired,closeImagePopup:d.default.func.isRequired,moveToPrevImage:d.default.func.isRequired,moveToNextImage:d.default.func.isRequired},g=function(e){function t(e){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.imageItems,t=this.props.imageIndex,n=e.length,a=n&&u.default.createElement(l.Fragment,null,u.default.createElement("span",null,(0,p.gettext)("%curr% of %total%").replace("%curr%",t+1).replace("%total%",n)),u.default.createElement("br",null),u.default.createElement("a",{href:e[t].url,target:"_blank"},(0,p.gettext)("Open in New Tab")));return u.default.createElement(h.default,{mainSrc:e[t].src,imageTitle:e[t].name,imageCaption:a,nextSrc:e[(t+1)%n].src,prevSrc:e[(t+n-1)%n].src,onCloseRequest:this.props.closeImagePopup,onMovePrevRequest:this.props.moveToPrevImage,onMoveNextRequest:this.props.moveToNextImage,imagePadding:70,imageLoadErrorMessage:(0,p.gettext)("The image could not be loaded."),prevLabel:(0,p.gettext)("Previous (Left arrow key)"),nextLabel:(0,p.gettext)("Next (Right arrow key)"),closeLabel:(0,p.gettext)("Close (Esc)"),zoomInLabel:(0,p.gettext)("Zoom in"),zoomOutLabel:(0,p.gettext)("Zoom out")})}}]),t}(u.default.Component);g.propTypes=m,t.default=g},512:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function o(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(){return s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},s.apply(this,arguments)}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){i(e,t,n[t])})}return e}function u(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function f(e,t){return!t||"object"!==typeof t&&"function"!==typeof t?p(e):t}function h(e,t){return v(e)||b(e,t)||S()}function m(e){return g(e)||y(e)||C()}function g(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}function v(e){if(Array.isArray(e))return e}function y(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function b(e,t){var n=[],a=!0,r=!1,o=void 0;try{for(var i,s=e[Symbol.iterator]();!(a=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);a=!0);}catch(e){r=!0,o=e}finally{try{a||null==s.return||s.return()}finally{if(r)throw o}}return n}function C(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function S(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return"";var n=e;return t&&Object.keys(t).forEach(function(e){n=n.replace(e,t[e])}),n}function D(){return"undefined"!==typeof e.window?e.window.innerWidth:0}function E(){return"undefined"!==typeof e.window?e.window.innerHeight:0}function P(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e.window.self;if(t===e.window.top)return t;var n=function(e){return e.match(/(.*\/\/.*?)(\/|$)/)[1]};return n(t.location.href)===n(t.document.referrer)?P(t.parent):t}var L=n(0),T=n.n(L),Y=n(1),M=n.n(Y),_=n(513),k=n.n(_),Z=0,N={ESC:27,LEFT_ARROW:37,RIGHT_ARROW:39},I=function(t){function n(e){var t;return a(this,n),t=f(this,c(n).call(this,e)),t.state={isClosing:!e.animationDisabled,shouldAnimate:!1,zoomLevel:Z,offsetX:0,offsetY:0,loadErrorStatus:{}},t.outerEl=T.a.createRef(),t.zoomInBtn=T.a.createRef(),t.zoomOutBtn=T.a.createRef(),t.caption=T.a.createRef(),t.closeIfClickInner=t.closeIfClickInner.bind(p(p(t))),t.handleImageDoubleClick=t.handleImageDoubleClick.bind(p(p(t))),t.handleImageMouseWheel=t.handleImageMouseWheel.bind(p(p(t))),t.handleKeyInput=t.handleKeyInput.bind(p(p(t))),t.handleMouseUp=t.handleMouseUp.bind(p(p(t))),t.handleMouseDown=t.handleMouseDown.bind(p(p(t))),t.handleMouseMove=t.handleMouseMove.bind(p(p(t))),t.handleOuterMousewheel=t.handleOuterMousewheel.bind(p(p(t))),t.handleTouchStart=t.handleTouchStart.bind(p(p(t))),t.handleTouchMove=t.handleTouchMove.bind(p(p(t))),t.handleTouchEnd=t.handleTouchEnd.bind(p(p(t))),t.handlePointerEvent=t.handlePointerEvent.bind(p(p(t))),t.handleCaptionMousewheel=t.handleCaptionMousewheel.bind(p(p(t))),t.handleWindowResize=t.handleWindowResize.bind(p(p(t))),t.handleZoomInButtonClick=t.handleZoomInButtonClick.bind(p(p(t))),t.handleZoomOutButtonClick=t.handleZoomOutButtonClick.bind(p(p(t))),t.requestClose=t.requestClose.bind(p(p(t))),t.requestMoveNext=t.requestMoveNext.bind(p(p(t))),t.requestMovePrev=t.requestMovePrev.bind(p(p(t))),t}return u(n,t),o(n,null,[{key:"isTargetMatchImage",value:function(e){return e&&/ril-image-current/.test(e.className)}},{key:"parseMouseEvent",value:function(e){return{id:"mouse",source:1,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parseTouchPointer",value:function(e){return{id:e.identifier,source:2,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"parsePointerEvent",value:function(e){return{id:e.pointerId,source:3,x:parseInt(e.clientX,10),y:parseInt(e.clientY,10)}}},{key:"getTransform",value:function(e){var t=e.x,n=void 0===t?0:t,a=e.y,r=void 0===a?0:a,o=e.zoom,i=void 0===o?1:o,s=e.width,l=e.targetWidth,u=n,c=D();s>c&&(u+=(c-s)/2);var d=i*(l/s);return{transform:"translate3d(".concat(u,"px,").concat(r,"px,0) scale3d(").concat(d,",").concat(d,",1)")}}}]),o(n,[{key:"componentWillMount",value:function(){this.timeouts=[],this.currentAction=0,this.eventsSource=0,this.pointerList=[],this.preventInnerClose=!1,this.preventInnerCloseTimeout=null,this.keyPressed=!1,this.imageCache={},this.lastKeyDownTime=0,this.resizeTimeout=null,this.wheelActionTimeout=null,this.resetScrollTimeout=null,this.scrollX=0,this.scrollY=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,this.pinchTouchList=null,this.pinchDistance=0,this.keyCounter=0,this.moveRequested=!1,this.props.animationDisabled||this.setState({isClosing:!1})}},{key:"componentDidMount",value:function(){var e=this;this.windowContext=P(),this.listeners={resize:this.handleWindowResize,mouseup:this.handleMouseUp,touchend:this.handleTouchEnd,touchcancel:this.handleTouchEnd,pointerdown:this.handlePointerEvent,pointermove:this.handlePointerEvent,pointerup:this.handlePointerEvent,pointercancel:this.handlePointerEvent},Object.keys(this.listeners).forEach(function(t){e.windowContext.addEventListener(t,e.listeners[t])}),this.loadAllImages()}},{key:"componentWillReceiveProps",value:function(e){var t=this,n=!1,a={},r={};this.getSrcTypes().forEach(function(o){t.props[o.name]!==e[o.name]&&(n=!0,a[t.props[o.name]]=!0,r[e[o.name]]=!0)}),(n||this.moveRequested)&&(Object.keys(a).forEach(function(e){!(e in r)&&e in t.imageCache&&(t.imageCache[e].loaded=!1)}),this.moveRequested=!1,this.loadAllImages(e))}},{key:"shouldComponentUpdate",value:function(){return!this.moveRequested}},{key:"componentWillUnmount",value:function(){var e=this;this.didUnmount=!0,Object.keys(this.listeners).forEach(function(t){e.windowContext.removeEventListener(t,e.listeners[t])}),this.timeouts.forEach(function(e){return clearTimeout(e)})}},{key:"setTimeout",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this,a=setTimeout(function(){n.timeouts=n.timeouts.filter(function(e){return e!==a}),e()},t);return this.timeouts.push(a),a})},{key:"setPreventInnerClose",value:function(){var e=this;this.preventInnerCloseTimeout&&this.clearTimeout(this.preventInnerCloseTimeout),this.preventInnerClose=!0,this.preventInnerCloseTimeout=this.setTimeout(function(){e.preventInnerClose=!1,e.preventInnerCloseTimeout=null},100)}},{key:"getBestImageForType",value:function(e){var t=this.props[e],n={};if(this.isImageLoaded(t))n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height);else{if(!this.isImageLoaded(this.props["".concat(e,"Thumbnail")]))return null;t=this.props["".concat(e,"Thumbnail")],n=this.getFitSizes(this.imageCache[t].width,this.imageCache[t].height,!0)}return{src:t,height:this.imageCache[t].height,width:this.imageCache[t].width,targetHeight:n.height,targetWidth:n.width}}},{key:"getFitSizes",value:function(e,t,n){var a=this.getLightboxRect(),r=a.height-2*this.props.imagePadding,o=a.width-2*this.props.imagePadding;return n||(r=Math.min(r,t),o=Math.min(o,e)),o/r>e/t?{width:e*r/t,height:r}:{width:o,height:t*o/e}}},{key:"getMaxOffsets",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel,t=this.getBestImageForType("mainSrc");if(null===t)return{maxX:0,minX:0,maxY:0,minY:0};var n=this.getLightboxRect(),a=this.getZoomMultiplier(e),r=0;r=a*t.width-n.width<0?(n.width-a*t.width)/2:(a*t.width-n.width)/2;var o=0;return o=a*t.height-n.height<0?(n.height-a*t.height)/2:(a*t.height-n.height)/2,{maxX:r,maxY:o,minX:-1*r,minY:-1*o}}},{key:"getSrcTypes",value:function(){return[{name:"mainSrc",keyEnding:"i".concat(this.keyCounter)},{name:"mainSrcThumbnail",keyEnding:"t".concat(this.keyCounter)},{name:"nextSrc",keyEnding:"i".concat(this.keyCounter+1)},{name:"nextSrcThumbnail",keyEnding:"t".concat(this.keyCounter+1)},{name:"prevSrc",keyEnding:"i".concat(this.keyCounter-1)},{name:"prevSrcThumbnail",keyEnding:"t".concat(this.keyCounter-1)}]}},{key:"getZoomMultiplier",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.state.zoomLevel;return Math.pow(1.007,e)}},{key:"getLightboxRect",value:function(){return this.outerEl.current?this.outerEl.current.getBoundingClientRect():{width:D(),height:E(),top:0,right:0,bottom:0,left:0}}},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e){this.timeouts=this.timeouts.filter(function(t){return t!==e}),clearTimeout(e)})},{key:"changeZoom",value:function(e,t,n){if(this.props.enableZoom){var a=Math.max(Z,Math.min(300,e));if(a!==this.state.zoomLevel){if(a===Z)return void this.setState({zoomLevel:a,offsetX:0,offsetY:0});var r=this.getBestImageForType("mainSrc");if(null!==r){var o=this.getZoomMultiplier(),i=this.getZoomMultiplier(a),s=this.getLightboxRect(),l="undefined"!==typeof t?t-s.left:s.width/2,u="undefined"!==typeof n?n-s.top:s.height/2,c=(s.width-r.width*o)/2,d=(s.height-r.height*o)/2,p=c-this.state.offsetX,f=d-this.state.offsetY,h=(l-p)/o,m=(u-f)/o,g=l-h*i,v=u-m*i,y=(s.width-r.width*i)/2,b=(s.height-r.height*i)/2,C=y-g,S=b-v;if(3!==this.currentAction){var w=this.getMaxOffsets();this.state.zoomLevel>a&&(C=Math.max(w.minX,Math.min(w.maxX,C)),S=Math.max(w.minY,Math.min(w.maxY,S)))}this.setState({zoomLevel:a,offsetX:C,offsetY:S})}}}}},{key:"closeIfClickInner",value:function(e){!this.preventInnerClose&&e.target.className.search(/\bril-inner\b/)>-1&&this.requestClose(e)}},{key:"handleKeyInput",value:function(e){if(e.stopPropagation(),!this.isAnimating()){if("keyup"===e.type)return void(this.lastKeyDownTime-=this.props.keyRepeatKeyupBonus);var t=e.which||e.keyCode,n=new Date;if(!(n.getTime()-this.lastKeyDownTime<this.props.keyRepeatLimit&&t!==N.ESC))switch(this.lastKeyDownTime=n.getTime(),t){case N.ESC:e.preventDefault(),this.requestClose(e);break;case N.LEFT_ARROW:if(!this.props.prevSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMovePrev(e);break;case N.RIGHT_ARROW:if(!this.props.nextSrc)return;e.preventDefault(),this.keyPressed=!0,this.requestMoveNext(e)}}}},{key:"handleOuterMousewheel",value:function(e){var t=this;e.preventDefault(),e.stopPropagation();var n=0;if(this.clearTimeout(this.resetScrollTimeout),this.resetScrollTimeout=this.setTimeout(function(){t.scrollX=0,t.scrollY=0},300),null===this.wheelActionTimeout&&!this.isAnimating()){if(Math.abs(e.deltaY)<Math.abs(e.deltaX)){this.scrollY=0,this.scrollX+=e.deltaX;this.scrollX>=200||e.deltaX>=100?(this.requestMoveNext(e),n=500,this.scrollX=0):(this.scrollX<=-200||e.deltaX<=-100)&&(this.requestMovePrev(e),n=500,this.scrollX=0)}0!==n&&(this.wheelActionTimeout=this.setTimeout(function(){t.wheelActionTimeout=null},n))}}},{key:"handleImageMouseWheel",value:function(e){e.preventDefault();if(Math.abs(e.deltaY)>=Math.abs(e.deltaX)){if(e.stopPropagation(),Math.abs(e.deltaY)<1)return;this.scrollX=0,this.scrollY+=e.deltaY,this.changeZoom(this.state.zoomLevel-e.deltaY,e.clientX,e.clientY)}}},{key:"handleImageDoubleClick",value:function(e){this.state.zoomLevel>Z?this.changeZoom(Z,e.clientX,e.clientY):this.changeZoom(this.state.zoomLevel+100,e.clientX,e.clientY)}},{key:"shouldHandleEvent",value:function(e){if(this.eventsSource===e)return!0;if(0===this.eventsSource)return this.eventsSource=e,!0;switch(e){case 1:return!1;case 2:return this.eventsSource=2,this.filterPointersBySource(),!0;case 3:return 1===this.eventsSource&&(this.eventsSource=3,this.filterPointersBySource(),!0);default:return!1}}},{key:"addPointer",value:function(e){this.pointerList.push(e)}},{key:"removePointer",value:function(e){this.pointerList=this.pointerList.filter(function(t){return t.id!==e.id})}},{key:"filterPointersBySource",value:function(){var e=this;this.pointerList=this.pointerList.filter(function(t){return t.source===e.eventsSource})}},{key:"handleMouseDown",value:function(e){this.shouldHandleEvent(1)&&n.isTargetMatchImage(e.target)&&(this.addPointer(n.parseMouseEvent(e)),this.multiPointerStart(e))}},{key:"handleMouseMove",value:function(e){this.shouldHandleEvent(1)&&this.multiPointerMove(e,[n.parseMouseEvent(e)])}},{key:"handleMouseUp",value:function(e){this.shouldHandleEvent(1)&&(this.removePointer(n.parseMouseEvent(e)),this.multiPointerEnd(e))}},{key:"handlePointerEvent",value:function(e){if(this.shouldHandleEvent(3))switch(e.type){case"pointerdown":n.isTargetMatchImage(e.target)&&(this.addPointer(n.parsePointerEvent(e)),this.multiPointerStart(e));break;case"pointermove":this.multiPointerMove(e,[n.parsePointerEvent(e)]);break;case"pointerup":case"pointercancel":this.removePointer(n.parsePointerEvent(e)),this.multiPointerEnd(e)}}},{key:"handleTouchStart",value:function(e){var t=this;this.shouldHandleEvent(2)&&n.isTargetMatchImage(e.target)&&([].forEach.call(e.changedTouches,function(e){return t.addPointer(n.parseTouchPointer(e))}),this.multiPointerStart(e))}},{key:"handleTouchMove",value:function(e){this.shouldHandleEvent(2)&&this.multiPointerMove(e,[].map.call(e.changedTouches,function(e){return n.parseTouchPointer(e)}))}},{key:"handleTouchEnd",value:function(e){var t=this;this.shouldHandleEvent(2)&&([].map.call(e.changedTouches,function(e){return t.removePointer(n.parseTouchPointer(e))}),this.multiPointerEnd(e))}},{key:"decideMoveOrSwipe",value:function(e){this.state.zoomLevel<=Z?this.handleSwipeStart(e):this.handleMoveStart(e)}},{key:"multiPointerStart",value:function(e){switch(this.handleEnd(null),this.pointerList.length){case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"multiPointerMove",value:function(e,t){switch(this.currentAction){case 1:e.preventDefault(),this.handleMove(t[0]);break;case 2:e.preventDefault(),this.handleSwipe(t[0]);break;case 3:e.preventDefault(),this.handlePinch(t)}}},{key:"multiPointerEnd",value:function(e){switch(0!==this.currentAction&&(this.setPreventInnerClose(),this.handleEnd(e)),this.pointerList.length){case 0:this.eventsSource=0;break;case 1:e.preventDefault(),this.decideMoveOrSwipe(this.pointerList[0]);break;case 2:e.preventDefault(),this.handlePinchStart(this.pointerList)}}},{key:"handleEnd",value:function(e){switch(this.currentAction){case 1:this.handleMoveEnd(e);break;case 2:this.handleSwipeEnd(e);break;case 3:this.handlePinchEnd(e)}}},{key:"handleMoveStart",value:function(e){var t=e.x,n=e.y;this.props.enableZoom&&(this.currentAction=1,this.moveStartX=t,this.moveStartY=n,this.moveStartOffsetX=this.state.offsetX,this.moveStartOffsetY=this.state.offsetY)}},{key:"handleMove",value:function(e){var t=e.x,n=e.y,a=this.moveStartX-t+this.moveStartOffsetX,r=this.moveStartY-n+this.moveStartOffsetY;this.state.offsetX===a&&this.state.offsetY===r||this.setState({offsetX:a,offsetY:r})}},{key:"handleMoveEnd",value:function(){var e=this;this.currentAction=0,this.moveStartX=0,this.moveStartY=0,this.moveStartOffsetX=0,this.moveStartOffsetY=0;var t=this.getMaxOffsets(),n=Math.max(t.minX,Math.min(t.maxX,this.state.offsetX)),a=Math.max(t.minY,Math.min(t.maxY,this.state.offsetY));n===this.state.offsetX&&a===this.state.offsetY||(this.setState({offsetX:n,offsetY:a,shouldAnimate:!0}),this.setTimeout(function(){e.setState({shouldAnimate:!1})},this.props.animationDuration))}},{key:"handleSwipeStart",value:function(e){var t=e.x,n=e.y;this.currentAction=2,this.swipeStartX=t,this.swipeStartY=n,this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipe",value:function(e){var t=e.x,n=e.y;this.swipeEndX=t,this.swipeEndY=n}},{key:"handleSwipeEnd",value:function(e){var t=this.swipeEndX-this.swipeStartX,n=Math.abs(t),a=Math.abs(this.swipeEndY-this.swipeStartY);if(this.currentAction=0,this.swipeStartX=0,this.swipeStartY=0,this.swipeEndX=0,this.swipeEndY=0,!(!e||this.isAnimating()||n<1.5*a)){if(n<200){if(n<this.getLightboxRect().width/4)return}t>0&&this.props.prevSrc?(e.preventDefault(),this.requestMovePrev()):t<0&&this.props.nextSrc&&(e.preventDefault(),this.requestMoveNext())}}},{key:"calculatePinchDistance",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=h(e,2),n=t[0],a=t[1];return Math.sqrt(Math.pow(n.x-a.x,2)+Math.pow(n.y-a.y,2))}},{key:"calculatePinchCenter",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.pinchTouchList,t=h(e,2),n=t[0],a=t[1];return{x:n.x-(n.x-a.x)/2,y:n.y-(n.y-a.y)/2}}},{key:"handlePinchStart",value:function(e){this.props.enableZoom&&(this.currentAction=3,this.pinchTouchList=e.map(function(e){return{id:e.id,x:e.x,y:e.y}}),this.pinchDistance=this.calculatePinchDistance())}},{key:"handlePinch",value:function(e){this.pinchTouchList=this.pinchTouchList.map(function(t){for(var n=0;n<e.length;n+=1)if(e[n].id===t.id)return e[n];return t});var t=this.calculatePinchDistance(),n=this.state.zoomLevel+t-this.pinchDistance;this.pinchDistance=t;var a=this.calculatePinchCenter(this.pinchTouchList),r=a.x,o=a.y;this.changeZoom(n,r,o)}},{key:"handlePinchEnd",value:function(){this.currentAction=0,this.pinchTouchList=null,this.pinchDistance=0}},{key:"handleWindowResize",value:function(){this.clearTimeout(this.resizeTimeout),this.resizeTimeout=this.setTimeout(this.forceUpdate.bind(this),100)}},{key:"handleZoomInButtonClick",value:function(){var e=this.state.zoomLevel+100;this.changeZoom(e),300===e&&this.zoomOutBtn.current.focus()}},{key:"handleZoomOutButtonClick",value:function(){var e=this.state.zoomLevel-100;this.changeZoom(e),e===Z&&this.zoomInBtn.current.focus()}},{key:"handleCaptionMousewheel",value:function(e){if(e.stopPropagation(),this.caption.current){var t=this.caption.current.getBoundingClientRect(),n=t.height,a=this.caption.current,r=a.scrollHeight,o=a.scrollTop;(e.deltaY>0&&n+o>=r||e.deltaY<0&&o<=0)&&e.preventDefault()}}},{key:"isAnimating",value:function(){return this.state.shouldAnimate||this.state.isClosing}},{key:"isImageLoaded",value:function(e){return e&&e in this.imageCache&&this.imageCache[e].loaded}},{key:"loadImage",value:function(t,n,a){var r=this;if(this.isImageLoaded(n))return void this.setTimeout(function(){a()},1);var o=new e.Image;this.props.imageCrossOrigin&&(o.crossOrigin=this.props.imageCrossOrigin),o.onerror=function(e){r.props.onImageLoadError(n,t,e),r.setState(function(e){return{loadErrorStatus:l({},e.loadErrorStatus,i({},t,!0))}}),a(e)},o.onload=function(){r.props.onImageLoad(n,t,o),r.imageCache[n]={loaded:!0,width:o.width,height:o.height},a()},o.src=n}},{key:"loadAllImages",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.props,n=function(t,n){return function(a){a||e.props[t]!==n||e.didUnmount||e.forceUpdate()}};this.getSrcTypes().forEach(function(a){var r=a.name;t[r]&&e.state.loadErrorStatus[r]&&e.setState(function(e){return{loadErrorStatus:l({},e.loadErrorStatus,i({},r,!1))}}),t[r]&&!e.isImageLoaded(t[r])&&e.loadImage(r,t[r],n(r,t[r]))})}},{key:"requestClose",value:function(e){var t=this,n=function(){return t.props.onCloseRequest(e)};if(this.props.animationDisabled||"keydown"===e.type&&!this.props.animationOnKeyInput)return void n();this.setState({isClosing:!0}),this.setTimeout(n,this.props.animationDuration)}},{key:"requestMove",value:function(e,t){var n=this,a={zoomLevel:Z,offsetX:0,offsetY:0};this.props.animationDisabled||this.keyPressed&&!this.props.animationOnKeyInput||(a.shouldAnimate=!0,this.setTimeout(function(){return n.setState({shouldAnimate:!1})},this.props.animationDuration)),this.keyPressed=!1,this.moveRequested=!0,"prev"===e?(this.keyCounter-=1,this.setState(a),this.props.onMovePrevRequest(t)):(this.keyCounter+=1,this.setState(a),this.props.onMoveNextRequest(t))}},{key:"requestMoveNext",value:function(e){this.requestMove("next",e)}},{key:"requestMovePrev",value:function(e){this.requestMove("prev",e)}},{key:"render",value:function(){var t=this,a=this.props,r=a.animationDisabled,o=a.animationDuration,i=a.clickOutsideToClose,u=a.discourageDownloads,c=a.enableZoom,d=a.imageTitle,p=a.nextSrc,f=a.prevSrc,h=a.toolbarButtons,g=a.reactModalStyle,v=a.onAfterOpen,y=a.imageCrossOrigin,b=a.reactModalProps,C=this.state,S=C.zoomLevel,D=C.offsetX,E=C.offsetY,P=C.isClosing,L=C.loadErrorStatus,Y=this.getLightboxRect(),M={};!r&&this.isAnimating()&&(M=l({},M,{transition:"transform ".concat(o,"ms")}));var _={};this.getSrcTypes().forEach(function(e){var t=e.name,n=e.keyEnding;_[t]=n});var N=[],I=function(e,a,r){if(t.props[e]){var o=t.getBestImageForType(e),i=l({},M,n.getTransform(l({},r,o)));S>Z&&(i.cursor="move");if(null===o&&function(e){return Object.keys(e).some(function(t){return e[t]})}(L))return void N.push(T.a.createElement("div",{className:"".concat(a," ril__image ril-errored"),style:i,key:t.props[e]+_[e]},T.a.createElement("div",{className:"ril__errorContainer"},t.props.imageLoadErrorMessage)));if(null===o){var c=T.a.createElement("div",{className:"ril-loading-circle ril__loadingCircle ril__loadingContainer__icon"},m(new Array(12)).map(function(e,t){return T.a.createElement("div",{key:t,className:"ril-loading-circle-point ril__loadingCirclePoint"})}));return void N.push(T.a.createElement("div",{className:"".concat(a," ril__image ril-not-loaded"),style:i,key:t.props[e]+_[e]},T.a.createElement("div",{className:"ril__loadingContainer"},c)))}var p=o.src;u?(i.backgroundImage="url('".concat(p,"')"),N.push(T.a.createElement("div",{className:"".concat(a," ril__image ril__imageDiscourager"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,style:i,key:p+_[e]},T.a.createElement("div",{className:"ril-download-blocker ril__downloadBlocker"})))):N.push(T.a.createElement("img",s({},y?{crossOrigin:y}:{},{className:"".concat(a," ril__image"),onDoubleClick:t.handleImageDoubleClick,onWheel:t.handleImageMouseWheel,onDragStart:function(e){return e.preventDefault()},style:i,src:p,key:p+_[e],alt:"string"===typeof d?d:w("Image"),draggable:!1})))}},R=this.getZoomMultiplier();I("nextSrc","ril-image-next ril__imageNext",{x:Y.width}),I("mainSrc","ril-image-current",{x:-1*D,y:-1*E,zoom:R}),I("prevSrc","ril-image-prev ril__imagePrev",{x:-1*Y.width});var O={overlay:l({zIndex:1e3,backgroundColor:"transparent"},g.overlay),content:l({backgroundColor:"transparent",overflow:"hidden",border:"none",borderRadius:0,padding:0,top:0,left:0,right:0,bottom:0},g.content)};return T.a.createElement(k.a,s({isOpen:!0,onRequestClose:i?this.requestClose:void 0,onAfterOpen:function(){t.outerEl.current&&t.outerEl.current.focus(),v()},style:O,contentLabel:w("Lightbox"),appElement:"undefined"!==typeof e.window?e.window.document.body:void 0},b),T.a.createElement("div",{className:"ril-outer ril__outer ril__outerAnimating ".concat(this.props.wrapperClassName," ").concat(P?"ril-closing ril__outerClosing":""),style:{transition:"opacity ".concat(o,"ms"),animationDuration:"".concat(o,"ms"),animationDirection:P?"normal":"reverse"},ref:this.outerEl,onWheel:this.handleOuterMousewheel,onMouseMove:this.handleMouseMove,onMouseDown:this.handleMouseDown,onTouchStart:this.handleTouchStart,onTouchMove:this.handleTouchMove,tabIndex:"-1",onKeyDown:this.handleKeyInput,onKeyUp:this.handleKeyInput},T.a.createElement("div",{className:"ril-inner ril__inner",onClick:i?this.closeIfClickInner:void 0},N),f&&T.a.createElement("button",{type:"button",className:"ril-prev-button ril__navButtons ril__navButtonPrev",key:"prev","aria-label":this.props.prevLabel,onClick:this.isAnimating()?void 0:this.requestMovePrev}),p&&T.a.createElement("button",{type:"button",className:"ril-next-button ril__navButtons ril__navButtonNext",key:"next","aria-label":this.props.nextLabel,onClick:this.isAnimating()?void 0:this.requestMoveNext}),T.a.createElement("div",{className:"ril-toolbar ril__toolbar"},T.a.createElement("ul",{className:"ril-toolbar-left ril__toolbarSide ril__toolbarLeftSide"},T.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},T.a.createElement("span",{className:"ril-toolbar__item__child ril__toolbarItemChild"},d))),T.a.createElement("ul",{className:"ril-toolbar-right ril__toolbarSide ril__toolbarRightSide"},h&&h.map(function(e,t){return T.a.createElement("li",{key:"button_".concat(t+1),className:"ril-toolbar__item ril__toolbarItem"},e)}),c&&T.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},T.a.createElement("button",{type:"button",key:"zoom-in","aria-label":this.props.zoomInLabel,className:["ril-zoom-in","ril__toolbarItemChild","ril__builtinButton","ril__zoomInButton"].concat(m(300===S?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomInBtn,disabled:this.isAnimating()||300===S,onClick:this.isAnimating()||300===S?void 0:this.handleZoomInButtonClick})),c&&T.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},T.a.createElement("button",{type:"button",key:"zoom-out","aria-label":this.props.zoomOutLabel,className:["ril-zoom-out","ril__toolbarItemChild","ril__builtinButton","ril__zoomOutButton"].concat(m(S===Z?["ril__builtinButtonDisabled"]:[])).join(" "),ref:this.zoomOutBtn,disabled:this.isAnimating()||S===Z,onClick:this.isAnimating()||S===Z?void 0:this.handleZoomOutButtonClick})),T.a.createElement("li",{className:"ril-toolbar__item ril__toolbarItem"},T.a.createElement("button",{type:"button",key:"close","aria-label":this.props.closeLabel,className:"ril-close ril-toolbar__item__child ril__toolbarItemChild ril__builtinButton ril__closeButton",onClick:this.isAnimating()?void 0:this.requestClose})))),this.props.imageCaption&&T.a.createElement("div",{onWheel:this.handleCaptionMousewheel,onMouseDown:function(e){return e.stopPropagation()},className:"ril-caption ril__caption",ref:this.caption},T.a.createElement("div",{className:"ril-caption-content ril__captionContent"},this.props.imageCaption))))}}]),n}(L.Component);I.propTypes={mainSrc:M.a.string.isRequired,prevSrc:M.a.string,nextSrc:M.a.string,mainSrcThumbnail:M.a.string,prevSrcThumbnail:M.a.string,nextSrcThumbnail:M.a.string,onCloseRequest:M.a.func.isRequired,onMovePrevRequest:M.a.func,onMoveNextRequest:M.a.func,onImageLoadError:M.a.func,onImageLoad:M.a.func,onAfterOpen:M.a.func,discourageDownloads:M.a.bool,animationDisabled:M.a.bool,animationOnKeyInput:M.a.bool,animationDuration:M.a.number,keyRepeatLimit:M.a.number,keyRepeatKeyupBonus:M.a.number,imageTitle:M.a.node,imageCaption:M.a.node,imageCrossOrigin:M.a.string,reactModalStyle:M.a.shape({}),imagePadding:M.a.number,wrapperClassName:M.a.string,toolbarButtons:M.a.arrayOf(M.a.node),clickOutsideToClose:M.a.bool,enableZoom:M.a.bool,reactModalProps:M.a.shape({}),nextLabel:M.a.string,prevLabel:M.a.string,zoomInLabel:M.a.string,zoomOutLabel:M.a.string,closeLabel:M.a.string,imageLoadErrorMessage:M.a.node},I.defaultProps={imageTitle:null,imageCaption:null,toolbarButtons:null,reactModalProps:{},animationDisabled:!1,animationDuration:300,animationOnKeyInput:!1,clickOutsideToClose:!0,closeLabel:"Close lightbox",discourageDownloads:!1,enableZoom:!0,imagePadding:10,imageCrossOrigin:null,keyRepeatKeyupBonus:40,keyRepeatLimit:180,mainSrcThumbnail:null,nextLabel:"Next image",nextSrc:null,nextSrcThumbnail:null,onAfterOpen:function(){},onImageLoadError:function(){},onImageLoad:function(){},onMoveNextRequest:function(){},onMovePrevRequest:function(){},prevLabel:"Previous image",prevSrc:null,prevSrcThumbnail:null,reactModalStyle:{},wrapperClassName:"",zoomInLabel:"Zoom in",zoomOutLabel:"Zoom out",imageLoadErrorMessage:"This image failed to load"},t.default=I}.call(t,n(38))},513:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(514),r=function(e){return e&&e.__esModule?e:{default:e}}(a);t.default=r.default,e.exports=t.default},514:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e){return e()}Object.defineProperty(t,"__esModule",{value:!0}),t.bodyOpenClassName=t.portalClassName=void 0;var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),c=n(0),d=a(c),p=n(7),f=a(p),h=n(1),m=a(h),g=n(515),v=a(g),y=n(295),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(y),C=n(197),S=a(C),w=n(79),D=t.portalClassName="ReactModalPortal",E=t.bodyOpenClassName="ReactModal__Body--open",P=void 0!==f.default.createPortal,L=function(){return P?f.default.createPortal:f.default.unstable_renderSubtreeIntoContainer},T=function(e){function t(){var e,n,a,i;r(this,t);for(var u=arguments.length,c=Array(u),p=0;p<u;p++)c[p]=arguments[p];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.removePortal=function(){!P&&f.default.unmountComponentAtNode(a.node),s(a.props.parentSelector).removeChild(a.node)},a.portalRef=function(e){a.portal=e},a.renderPortal=function(e){var n=L(),r=n(a,d.default.createElement(v.default,l({defaultStyles:t.defaultStyles},e)),a.node);a.portalRef(r)},i=n,o(a,i)}return i(t,e),u(t,[{key:"componentDidMount",value:function(){if(C.canUseDOM){P||(this.node=document.createElement("div")),this.node.className=this.props.portalClassName;s(this.props.parentSelector).appendChild(this.node),!P&&this.renderPortal(this.props)}}},{key:"getSnapshotBeforeUpdate",value:function(e){return{prevParent:s(e.parentSelector),nextParent:s(this.props.parentSelector)}}},{key:"componentDidUpdate",value:function(e,t,n){if(C.canUseDOM){var a=this.props,r=a.isOpen,o=a.portalClassName;e.portalClassName!==o&&(this.node.className=o);var i=n.prevParent,s=n.nextParent;s!==i&&(i.removeChild(this.node),s.appendChild(this.node)),(e.isOpen||r)&&!P&&this.renderPortal(this.props)}}},{key:"componentWillUnmount",value:function(){if(C.canUseDOM&&this.node&&this.portal){var e=this.portal.state,t=Date.now(),n=e.isOpen&&this.props.closeTimeoutMS&&(e.closesAt||t+this.props.closeTimeoutMS);n?(e.beforeClose||this.portal.closeWithTimeout(),setTimeout(this.removePortal,n-t)):this.removePortal()}}},{key:"render",value:function(){return C.canUseDOM&&P?(!this.node&&P&&(this.node=document.createElement("div")),L()(d.default.createElement(v.default,l({ref:this.portalRef,defaultStyles:t.defaultStyles},this.props)),this.node)):null}}],[{key:"setAppElement",value:function(e){b.setElement(e)}}]),t}(c.Component);T.propTypes={isOpen:m.default.bool.isRequired,style:m.default.shape({content:m.default.object,overlay:m.default.object}),portalClassName:m.default.string,bodyOpenClassName:m.default.string,htmlOpenClassName:m.default.string,className:m.default.oneOfType([m.default.string,m.default.shape({base:m.default.string.isRequired,afterOpen:m.default.string.isRequired,beforeClose:m.default.string.isRequired})]),overlayClassName:m.default.oneOfType([m.default.string,m.default.shape({base:m.default.string.isRequired,afterOpen:m.default.string.isRequired,beforeClose:m.default.string.isRequired})]),appElement:m.default.instanceOf(S.default),onAfterOpen:m.default.func,onRequestClose:m.default.func,closeTimeoutMS:m.default.number,ariaHideApp:m.default.bool,shouldFocusAfterRender:m.default.bool,shouldCloseOnOverlayClick:m.default.bool,shouldReturnFocusAfterClose:m.default.bool,parentSelector:m.default.func,aria:m.default.object,data:m.default.object,role:m.default.string,contentLabel:m.default.string,shouldCloseOnEsc:m.default.bool,overlayRef:m.default.func,contentRef:m.default.func},T.defaultProps={isOpen:!1,portalClassName:D,bodyOpenClassName:E,role:"dialog",ariaHideApp:!0,closeTimeoutMS:0,shouldFocusAfterRender:!0,shouldCloseOnEsc:!0,shouldCloseOnOverlayClick:!0,shouldReturnFocusAfterClose:!0,parentSelector:function(){return document.body}},T.defaultStyles={overlay:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"rgba(255, 255, 255, 0.75)"},content:{position:"absolute",top:"40px",left:"40px",right:"40px",bottom:"40px",border:"1px solid #ccc",background:"#fff",overflow:"auto",WebkitOverflowScrolling:"touch",borderRadius:"4px",outline:"none",padding:"20px"}},(0,w.polyfill)(T),t.default=T},515:function(e,t,n){"use strict";function a(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function r(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),d=n(0),p=r(d),f=n(1),h=r(f),m=n(516),g=a(m),v=n(517),y=r(v),b=n(295),C=a(b),S=n(519),w=a(S),D=n(197),E=r(D),P={overlay:"ReactModal__Overlay",content:"ReactModal__Content"},L=9,T=27,Y=0,M=function(e){function t(e){o(this,t);var n=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.setOverlayRef=function(e){n.overlay=e,n.props.overlayRef&&n.props.overlayRef(e)},n.setContentRef=function(e){n.content=e,n.props.contentRef&&n.props.contentRef(e)},n.afterClose=function(){var e=n.props,t=e.appElement,a=e.ariaHideApp,r=e.htmlOpenClassName,o=e.bodyOpenClassName;o&&w.remove(document.body,o),r&&w.remove(document.getElementsByTagName("html")[0],r),a&&Y>0&&0===(Y-=1)&&C.show(t),n.props.shouldFocusAfterRender&&(n.props.shouldReturnFocusAfterClose?(g.returnFocus(),g.teardownScopedFocus()):g.popWithoutFocus()),n.props.onAfterClose&&n.props.onAfterClose()},n.open=function(){n.beforeOpen(),n.state.afterOpen&&n.state.beforeClose?(clearTimeout(n.closeTimer),n.setState({beforeClose:!1})):(n.props.shouldFocusAfterRender&&(g.setupScopedFocus(n.node),g.markForFocusLater()),n.setState({isOpen:!0},function(){n.setState({afterOpen:!0}),n.props.isOpen&&n.props.onAfterOpen&&n.props.onAfterOpen()}))},n.close=function(){n.props.closeTimeoutMS>0?n.closeWithTimeout():n.closeWithoutTimeout()},n.focusContent=function(){return n.content&&!n.contentHasFocus()&&n.content.focus()},n.closeWithTimeout=function(){var e=Date.now()+n.props.closeTimeoutMS;n.setState({beforeClose:!0,closesAt:e},function(){n.closeTimer=setTimeout(n.closeWithoutTimeout,n.state.closesAt-Date.now())})},n.closeWithoutTimeout=function(){n.setState({beforeClose:!1,isOpen:!1,afterOpen:!1,closesAt:null},n.afterClose)},n.handleKeyDown=function(e){e.keyCode===L&&(0,y.default)(n.content,e),n.props.shouldCloseOnEsc&&e.keyCode===T&&(e.stopPropagation(),n.requestClose(e))},n.handleOverlayOnClick=function(e){null===n.shouldClose&&(n.shouldClose=!0),n.shouldClose&&n.props.shouldCloseOnOverlayClick&&(n.ownerHandlesClose()?n.requestClose(e):n.focusContent()),n.shouldClose=null},n.handleContentOnMouseUp=function(){n.shouldClose=!1},n.handleOverlayOnMouseDown=function(e){n.props.shouldCloseOnOverlayClick||e.target!=n.overlay||e.preventDefault()},n.handleContentOnClick=function(){n.shouldClose=!1},n.handleContentOnMouseDown=function(){n.shouldClose=!1},n.requestClose=function(e){return n.ownerHandlesClose()&&n.props.onRequestClose(e)},n.ownerHandlesClose=function(){return n.props.onRequestClose},n.shouldBeClosed=function(){return!n.state.isOpen&&!n.state.beforeClose},n.contentHasFocus=function(){return document.activeElement===n.content||n.content.contains(document.activeElement)},n.buildClassName=function(e,t){var a="object"===("undefined"===typeof t?"undefined":u(t))?t:{base:P[e],afterOpen:P[e]+"--after-open",beforeClose:P[e]+"--before-close"},r=a.base;return n.state.afterOpen&&(r=r+" "+a.afterOpen),n.state.beforeClose&&(r=r+" "+a.beforeClose),"string"===typeof t&&t?r+" "+t:r},n.attributesFromObject=function(e,t){return Object.keys(t).reduce(function(n,a){return n[e+"-"+a]=t[a],n},{})},n.state={afterOpen:!1,beforeClose:!1},n.shouldClose=null,n.moveFromContentToOverlay=null,n}return s(t,e),c(t,[{key:"componentDidMount",value:function(){this.props.isOpen&&this.open()}},{key:"componentDidUpdate",value:function(e,t){this.props.isOpen&&!e.isOpen?this.open():!this.props.isOpen&&e.isOpen&&this.close(),this.props.shouldFocusAfterRender&&this.state.isOpen&&!t.isOpen&&this.focusContent()}},{key:"componentWillUnmount",value:function(){this.afterClose(),clearTimeout(this.closeTimer)}},{key:"beforeOpen",value:function(){var e=this.props,t=e.appElement,n=e.ariaHideApp,a=e.htmlOpenClassName,r=e.bodyOpenClassName;r&&w.add(document.body,r),a&&w.add(document.getElementsByTagName("html")[0],a),n&&(Y+=1,C.hide(t))}},{key:"render",value:function(){var e=this.props,t=e.className,n=e.overlayClassName,a=e.defaultStyles,r=t?{}:a.content,o=n?{}:a.overlay;return this.shouldBeClosed()?null:p.default.createElement("div",{ref:this.setOverlayRef,className:this.buildClassName("overlay",n),style:l({},o,this.props.style.overlay),onClick:this.handleOverlayOnClick,onMouseDown:this.handleOverlayOnMouseDown},p.default.createElement("div",l({ref:this.setContentRef,style:l({},r,this.props.style.content),className:this.buildClassName("content",t),tabIndex:"-1",onKeyDown:this.handleKeyDown,onMouseDown:this.handleContentOnMouseDown,onMouseUp:this.handleContentOnMouseUp,onClick:this.handleContentOnClick,role:this.props.role,"aria-label":this.props.contentLabel},this.attributesFromObject("aria",this.props.aria||{}),this.attributesFromObject("data",this.props.data||{}),{"data-testid":this.props.testId}),this.props.children))}}]),t}(d.Component);M.defaultProps={style:{overlay:{},content:{}},defaultStyles:{}},M.propTypes={isOpen:h.default.bool.isRequired,defaultStyles:h.default.shape({content:h.default.object,overlay:h.default.object}),style:h.default.shape({content:h.default.object,overlay:h.default.object}),className:h.default.oneOfType([h.default.string,h.default.object]),overlayClassName:h.default.oneOfType([h.default.string,h.default.object]),bodyOpenClassName:h.default.string,htmlOpenClassName:h.default.string,ariaHideApp:h.default.bool,appElement:h.default.instanceOf(E.default),onAfterOpen:h.default.func,onAfterClose:h.default.func,onRequestClose:h.default.func,closeTimeoutMS:h.default.number,shouldFocusAfterRender:h.default.bool,shouldCloseOnOverlayClick:h.default.bool,shouldReturnFocusAfterClose:h.default.bool,role:h.default.string,contentLabel:h.default.string,aria:h.default.object,data:h.default.object,children:h.default.node,shouldCloseOnEsc:h.default.bool,overlayRef:h.default.func,contentRef:h.default.func,testId:h.default.string},t.default=M,e.exports=t.default},516:function(e,t,n){"use strict";function a(){h=!0}function r(){if(h){if(h=!1,!f)return;setTimeout(function(){if(!f.contains(document.activeElement)){((0,d.default)(f)[0]||f).focus()}},0)}}function o(){p.push(document.activeElement)}function i(){var e=null;try{return void(0!==p.length&&(e=p.pop(),e.focus()))}catch(t){console.warn(["You tried to return focus to",e,"but it is not in the DOM anymore"].join(" "))}}function s(){p.length>0&&p.pop()}function l(e){f=e,window.addEventListener?(window.addEventListener("blur",a,!1),document.addEventListener("focus",r,!0)):(window.attachEvent("onBlur",a),document.attachEvent("onFocus",r))}function u(){f=null,window.addEventListener?(window.removeEventListener("blur",a),document.removeEventListener("focus",r)):(window.detachEvent("onBlur",a),document.detachEvent("onFocus",r))}Object.defineProperty(t,"__esModule",{value:!0}),t.handleBlur=a,t.handleFocus=r,t.markForFocusLater=o,t.returnFocus=i,t.popWithoutFocus=s,t.setupScopedFocus=l,t.teardownScopedFocus=u;var c=n(294),d=function(e){return e&&e.__esModule?e:{default:e}}(c),p=[],f=null,h=!1},517:function(e,t,n){"use strict";function a(e,t){var n=(0,o.default)(e);if(!n.length)return void t.preventDefault();var a=t.shiftKey,r=n[0],i=n[n.length-1];if(e===document.activeElement){if(!a)return;s=i}var s;if(i!==document.activeElement||a||(s=r),r===document.activeElement&&a&&(s=i),s)return t.preventDefault(),void s.focus();var l=/(\bChrome\b|\bSafari\b)\//.exec(navigator.userAgent);if(null!=l&&"Chrome"!=l[1]&&null==/\biPod\b|\biPad\b/g.exec(navigator.userAgent)){var u=n.indexOf(document.activeElement);if(u>-1&&(u+=a?-1:1),"undefined"===typeof n[u])return t.preventDefault(),s=a?i:r,void s.focus();t.preventDefault(),n[u].focus()}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=n(294),o=function(e){return e&&e.__esModule?e:{default:e}}(r);e.exports=t.default},518:function(e,t,n){var a;!function(){"use strict";var r=!("undefined"===typeof window||!window.document||!window.document.createElement),o={canUseDOM:r,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen};void 0!==(a=function(){return o}.call(t,n,t,e))&&(e.exports=a)}()},519:function(e,t,n){"use strict";function a(){}Object.defineProperty(t,"__esModule",{value:!0}),t.dumpClassLists=a;var r={},o={},i=function(e,t){return e[t]||(e[t]=0),e[t]+=1,t},s=function(e,t){return e[t]&&(e[t]-=1),t},l=function(e,t,n){n.forEach(function(n){i(t,n),e.add(n)})},u=function(e,t,n){n.forEach(function(n){s(t,n),0===t[n]&&e.remove(n)})};t.add=function(e,t){return l(e.classList,"html"==e.nodeName.toLowerCase()?r:o,t.split(" "))},t.remove=function(e,t){return u(e.classList,"html"==e.nodeName.toLowerCase()?r:o,t.split(" "))}},52:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(4),h=n(2),m=n(3),g=n(5),v=a(g),y=n(85),b=a(y),C=n(97),S=a(C),w=n(12),D=a(w),E=n(101),P=a(E);n(103);var L={isShowFile:d.default.bool,repoID:d.default.string,onDirentItemClick:d.default.func,onRepoItemClick:d.default.func,mode:d.default.oneOf(["current_repo_and_other_repos","only_all_repos","only_current_library"]),fileSuffixes:d.default.array},T=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onOtherRepoToggle=function(){if(n.state.hasRequest)n.setState({isOtherRepoShow:!n.state.isOtherRepoShow});else{var e=n;f.seafileAPI.listRepos().then(function(t){for(var a=t.data.repos,r=[],o=[],i=0;i<a.length;i++)"rw"===a[i].permission&&(e.props.repoID&&a[i].repo_name===e.state.currentRepoInfo.repo_name||o.indexOf(a[i].repo_id)>-1||(r.push(a[i]),o.push(a[i].repo_id)));r=m.Utils.sortRepos(r,"name","asc"),n.setState({repoList:r,isOtherRepoShow:!n.state.isOtherRepoShow,selectedItemInfo:{}})})}},n.onCurrentRepoToggle=function(){n.setState({isCurrentRepoShow:!n.state.isCurrentRepoShow})},n.onDirentItemClick=function(e,t,a){n.props.onDirentItemClick(e,t,a),n.setState({selectedRepo:e,selectedPath:t})},n.onRepoItemClick=function(e){n.props.onRepoItemClick&&n.props.onRepoItemClick(e),n.setState({selectedRepo:e,selectedPath:""})},n.onCloseSearching=function(){n.setState({isSearching:!1,isResultGot:!1,searchInfo:"",searchResults:[]}),n.inputValue="",n.timer=null,n.source=null},n.onSearchInfoChanged=function(e){var t=e.target.value.trim();if(n.setState({searchInfo:t}),n.inputValue===t)return!1;if(n.inputValue=t,0===t.length)return n.setState({isSearching:!1,searchResults:[]}),!1;if(!n.state.searchResults.length&&t.length>0&&n.setState({isSearching:!0,isResultGot:!1}),""===n.inputValue||n.getValueLength(n.inputValue)<3)return n.setState({isResultGot:!1}),!1;var a=n.props.repoID,r=n.props.isShowFile,o=n.props.mode,i="only_current_library"===o?a:"all",s={q:t,search_repo:i,search_ftypes:"all",obj_type:r?"file":"dir"};n.timer&&clearTimeout(n.timer),n.timer=setTimeout(n.getSearchResult(s),500)},n.getSearchResult=function(e){n.source&&n.cancelRequest(),n.setState({isResultGot:!1}),n.source=f.seafileAPI.getSource(),n.sendRequest(e,n.source.token)},n.sendRequest=function(e,t){f.seafileAPI.searchFiles(e,t).then(function(e){if(!e.data.total)return n.setState({searchResults:[],isResultGot:!0}),void(n.source=null);var t=n.formatResultItems(e.data.results);n.setState({searchResults:t,isResultGot:!0}),n.source=null})},n.cancelRequest=function(){n.source.cancel("prev request is cancelled")},n.getValueLength=function(e){for(var t,n=0,a=0;n<e.length;n++)t=e.charCodeAt(n),10==t?a+=2:t<127?a+=1:t>=128&&t<=2047?a+=2:t>=2048&&t<=65535&&(a+=3);return a},n.formatResultItems=function(e){for(var t=[],n=e.length>10?10:e.length,a=0;a<n;a++)t[a]={},t[a].index=[a],t[a].name=e[a].name,t[a].path=e[a].fullpath,t[a].repo_id=e[a].repo_id,t[a].repo_name=e[a].repo_name,t[a].is_dir=e[a].is_dir,t[a].link_content=decodeURI(e[a].fullpath).substring(1),t[a].content=e[a].content_highlight;return t},n.onSearchedItemClick=function(e){e.type=e.is_dir?"dir":"file";var t=new b.default(e);n.props.onDirentItemClick(t,e.path,e)},n.renderSearchedView=function(){return n.getValueLength(n.inputValue)<3?"":n.state.isResultGot?n.state.isResultGot&&0===n.state.searchResults.length?u.default.createElement("div",{className:"search-result-none text-center"},(0,h.gettext)("No results matching.")):n.state.isResultGot&&n.state.searchResults.length>0?u.default.createElement(P.default,{searchResults:n.state.searchResults,onItemClick:n.onSearchedItemClick,onSearchedItemDoubleClick:n.onSearchedItemDoubleClick}):void 0:u.default.createElement(D.default,null)},n.onSearchedItemDoubleClick=function(e){if("dir"===e.type){var t={repoID:e.repo_id,filePath:e.path};if(n.setState({selectedItemInfo:t}),n.props.repoID&&e.repo_id===n.props.repoID)f.seafileAPI.getRepoInfo(n.props.repoID).then(function(t){var a=new b.default(t.data),r=e.path.substring(0,e.path.length-1);n.setState({selectedRepo:a,selectedPath:r,isCurrentRepoShow:!0})}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)});else if(n.state.hasRequest)n.setState({isOtherRepoShow:!n.state.isOtherRepoShow});else{var a=n;f.seafileAPI.listRepos().then(function(t){for(var r=t.data.repos,o=[],i=[],s=0;s<r.length;s++)"rw"===r[s].permission&&(a.props.repoID&&r[s].repo_name===a.state.currentRepoInfo.repo_name||i.indexOf(r[s].repo_id)>-1||(o.push(r[s]),i.push(r[s].repo_id)));o=m.Utils.sortRepos(o,"name","asc");var l=o.filter(function(t){return t.repo_id===e.repo_id}),u=e.path.substring(0,e.path.length-1),c=l[0];n.setState({repoList:o,isOtherRepoShow:!0,selectedPath:u,selectedRepo:c})})}n.onCloseSearching()}},n.onScroll=function(e){e.stopPropagation()},n.renderRepoListView=function(){return u.default.createElement("div",{className:"file-chooser-container user-select-none",onScroll:n.onScroll},"current_repo_and_other_repos"===n.props.mode&&u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa "+(n.state.isCurrentRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onCurrentRepoToggle}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Current Library"))),n.state.isCurrentRepoShow&&n.state.currentRepoInfo&&u.default.createElement(S.default,{initToShowChildren:!0,currentRepoInfo:n.state.currentRepoInfo,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo})),u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa "+(n.state.isOtherRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onOtherRepoToggle}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Other Libraries"))),n.state.isOtherRepoShow&&u.default.createElement(S.default,{initToShowChildren:!1,repoList:n.state.repoList,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo}))),"only_current_library"===n.props.mode&&u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa "+(n.state.isCurrentRepoShow?"fa-caret-down":"fa-caret-right"),onClick:n.onCurrentRepoToggle}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Current Library"))),n.state.isCurrentRepoShow&&n.state.currentRepoInfo&&u.default.createElement(S.default,{initToShowChildren:!0,currentRepoInfo:n.state.currentRepoInfo,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo})),"only_all_repos"===n.props.mode&&u.default.createElement("div",{className:"file-chooser-container"},u.default.createElement("div",{className:"list-view"},u.default.createElement("div",{className:"list-view-header"},u.default.createElement("span",{className:"item-toggle fa fa-caret-down"}),u.default.createElement("span",{className:"library"},(0,h.gettext)("Libraries"))),u.default.createElement(S.default,{initToShowChildren:!1,repoList:n.state.repoList,selectedRepo:n.state.selectedRepo,selectedPath:n.state.selectedPath,onRepoItemClick:n.onRepoItemClick,onDirentItemClick:n.onDirentItemClick,isShowFile:n.props.isShowFile,fileSuffixes:n.props.fileSuffixes,selectedItemInfo:n.state.selectedItemInfo}))))},n.state={hasRequest:!1,isCurrentRepoShow:!0,isOtherRepoShow:!1,repoList:[],currentRepoInfo:null,selectedRepo:null,selectedPath:"",isSearching:!1,isResultGot:!1,searchInfo:"",searchResults:[],selectedItemInfo:{}},n.inputValue="",n.timer=null,n.source=null,n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;if(this.props.repoID){var t=this.props.repoID;f.seafileAPI.getRepoInfo(t).then(function(t){var n=new b.default(t.data);e.setState({currentRepoInfo:n,selectedRepo:n}),e.props.onRepoItemClick(n)}).catch(function(e){var t=m.Utils.getErrorMsg(e);v.default.danger(t)})}else f.seafileAPI.listRepos().then(function(t){for(var n=t.data.repos,a=[],r=[],o=0;o<n.length;o++)"rw"===n[o].permission&&(r.indexOf(n[o].repo_id)>-1||(a.push(n[o]),r.push(n[o].repo_id)));a=m.Utils.sortRepos(a,"name","asc"),e.setState({repoList:a})})}},{key:"render",value:function(){return!this.state.selectedRepo&&this.props.repoID?"":u.default.createElement(l.Fragment,null,h.isPro&&u.default.createElement("div",{className:"file-chooser-search-input"},u.default.createElement(p.Input,{className:"search-input mb-2",placeholder:(0,h.gettext)("Search..."),type:"text",value:this.state.searchInfo,onChange:this.onSearchInfoChanged}),0!==this.state.searchInfo.length&&u.default.createElement("span",{className:"search-control attr-action-icon fas fa-times",onClick:this.onCloseSearching})),this.state.isSearching&&u.default.createElement("div",{className:"file-chooser-search-container"},this.renderSearchedView()),!this.state.isSearching&&this.renderRepoListView())}}]),t}(u.default.Component);T.propTypes=L,t.default=T},520:function(e,t){},57:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},u=n(0),c=a(u),d=n(1),p=a(d),f=n(312),h=a(f),m=n(4),g=n(2),v=n(3),y=n(5),b=a(y),C={placeholder:p.default.string.isRequired,onSelectChange:p.default.func.isRequired,isMulti:p.default.bool.isRequired,className:p.default.string},S=function(e){return c.default.createElement("div",l({},e.innerProps,{style:{margin:"6px 10px",textAlign:"center",color:"hsl(0,0%,50%)"}}),(0,g.gettext)("User not found"))},w=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSelectChange=function(e){n.options=[],n.props.onSelectChange(e)},n.loadOptions=function(e,t){var a=e.trim();a.length>0&&m.seafileAPI.searchUsers(a).then(function(e){n.options=[];for(var a=0;a<e.data.users.length;a++){var r=e.data.users[a],o={};o.value=r.name,o.email=r.email,o.label=c.default.createElement(c.default.Fragment,null,c.default.createElement("img",{src:r.avatar_url,className:"select-module select-module-icon avatar",alt:""}),c.default.createElement("span",{className:"select-module select-module-name"},r.name)),n.options.push(o)}t(n.options)}).catch(function(e){var t=v.Utils.getErrorMsg(e);b.default.danger(t)})},n.clearSelect=function(){n.refs.userSelect.select.onChange([],{action:"clear"})},n.options=[],n}return i(t,e),s(t,[{key:"render",value:function(){return c.default.createElement(h.default,{isClearable:!0,classNamePrefix:!0,components:{NoOptionsMessage:S},isMulti:this.props.isMulti,loadOptions:this.loadOptions,onChange:this.handleSelectChange,placeholder:this.props.placeholder,className:"user-select "+this.props.className,value:this.props.value,ref:"userSelect"})}}]),t}(c.default.Component);w.propTypes=C,t.default=w},598:function(e,t,n){(function(t){!function(){var a=n(1072),r=n(825).utf8,o=n(825).bin,i=function(e,n){e.constructor==String?e=n&&"binary"===n.encoding?o.stringToBytes(e):r.stringToBytes(e):"undefined"!=typeof t&&"function"==typeof t.isBuffer&&t.isBuffer(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var s=a.bytesToWords(e),l=8*e.length,u=1732584193,c=-271733879,d=-1732584194,p=271733878,f=0;f<s.length;f++)s[f]=16711935&(s[f]<<8|s[f]>>>24)|4278255360&(s[f]<<24|s[f]>>>8);s[l>>>5]|=128<<l%32,s[14+(l+64>>>9<<4)]=l;for(var h=i._ff,m=i._gg,g=i._hh,v=i._ii,f=0;f<s.length;f+=16){var y=u,b=c,C=d,S=p;u=h(u,c,d,p,s[f+0],7,-680876936),p=h(p,u,c,d,s[f+1],12,-389564586),d=h(d,p,u,c,s[f+2],17,606105819),c=h(c,d,p,u,s[f+3],22,-1044525330),u=h(u,c,d,p,s[f+4],7,-176418897),p=h(p,u,c,d,s[f+5],12,1200080426),d=h(d,p,u,c,s[f+6],17,-1473231341),c=h(c,d,p,u,s[f+7],22,-45705983),u=h(u,c,d,p,s[f+8],7,1770035416),p=h(p,u,c,d,s[f+9],12,-1958414417),d=h(d,p,u,c,s[f+10],17,-42063),c=h(c,d,p,u,s[f+11],22,-1990404162),u=h(u,c,d,p,s[f+12],7,1804603682),p=h(p,u,c,d,s[f+13],12,-40341101),d=h(d,p,u,c,s[f+14],17,-1502002290),c=h(c,d,p,u,s[f+15],22,1236535329),u=m(u,c,d,p,s[f+1],5,-165796510),p=m(p,u,c,d,s[f+6],9,-1069501632),d=m(d,p,u,c,s[f+11],14,643717713),c=m(c,d,p,u,s[f+0],20,-373897302),u=m(u,c,d,p,s[f+5],5,-701558691),p=m(p,u,c,d,s[f+10],9,38016083),d=m(d,p,u,c,s[f+15],14,-660478335),c=m(c,d,p,u,s[f+4],20,-405537848),u=m(u,c,d,p,s[f+9],5,568446438),p=m(p,u,c,d,s[f+14],9,-1019803690),d=m(d,p,u,c,s[f+3],14,-187363961),c=m(c,d,p,u,s[f+8],20,1163531501),u=m(u,c,d,p,s[f+13],5,-1444681467),p=m(p,u,c,d,s[f+2],9,-51403784),d=m(d,p,u,c,s[f+7],14,1735328473),c=m(c,d,p,u,s[f+12],20,-1926607734),u=g(u,c,d,p,s[f+5],4,-378558),p=g(p,u,c,d,s[f+8],11,-2022574463),d=g(d,p,u,c,s[f+11],16,1839030562),c=g(c,d,p,u,s[f+14],23,-35309556),u=g(u,c,d,p,s[f+1],4,-1530992060),p=g(p,u,c,d,s[f+4],11,1272893353),d=g(d,p,u,c,s[f+7],16,-155497632),c=g(c,d,p,u,s[f+10],23,-1094730640),u=g(u,c,d,p,s[f+13],4,681279174),p=g(p,u,c,d,s[f+0],11,-358537222),d=g(d,p,u,c,s[f+3],16,-722521979),c=g(c,d,p,u,s[f+6],23,76029189),u=g(u,c,d,p,s[f+9],4,-640364487),p=g(p,u,c,d,s[f+12],11,-421815835),d=g(d,p,u,c,s[f+15],16,530742520),c=g(c,d,p,u,s[f+2],23,-995338651),u=v(u,c,d,p,s[f+0],6,-198630844),p=v(p,u,c,d,s[f+7],10,1126891415),d=v(d,p,u,c,s[f+14],15,-1416354905),c=v(c,d,p,u,s[f+5],21,-57434055),u=v(u,c,d,p,s[f+12],6,1700485571),p=v(p,u,c,d,s[f+3],10,-1894986606),d=v(d,p,u,c,s[f+10],15,-1051523),c=v(c,d,p,u,s[f+1],21,-2054922799),u=v(u,c,d,p,s[f+8],6,1873313359),p=v(p,u,c,d,s[f+15],10,-30611744),d=v(d,p,u,c,s[f+6],15,-1560198380),c=v(c,d,p,u,s[f+13],21,1309151649),u=v(u,c,d,p,s[f+4],6,-145523070),p=v(p,u,c,d,s[f+11],10,-1120210379),d=v(d,p,u,c,s[f+2],15,718787259),c=v(c,d,p,u,s[f+9],21,-343485551),u=u+y>>>0,c=c+b>>>0,d=d+C>>>0,p=p+S>>>0}return a.endian([u,c,d,p])};i._ff=function(e,t,n,a,r,o,i){var s=e+(t&n|~t&a)+(r>>>0)+i;return(s<<o|s>>>32-o)+t},i._gg=function(e,t,n,a,r,o,i){var s=e+(t&a|n&~a)+(r>>>0)+i;return(s<<o|s>>>32-o)+t},i._hh=function(e,t,n,a,r,o,i){var s=e+(t^n^a)+(r>>>0)+i;return(s<<o|s>>>32-o)+t},i._ii=function(e,t,n,a,r,o,i){var s=e+(n^(t|~a))+(r>>>0)+i;return(s<<o|s>>>32-o)+t},i._blocksize=16,i._digestsize=16,e.exports=function(e,t){if("undefined"!=typeof e){var n=a.wordsToBytes(i(e,t));return t&&t.asBytes?n:t&&t.asString?o.bytesToString(n):a.bytesToHex(n)}}}()}).call(t,n(42).Buffer)},599:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(5),h=a(f),m={hasSuffix:d.default.bool,name:d.default.string.isRequired,onRenameConfirm:d.default.func.isRequired,onRenameCancel:d.default.func.isRequired},g=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onChange=function(e){n.setState({name:e.target.value})},n.onClick=function(e){e.nativeEvent.stopImmediatePropagation()},n.onKeyPress=function(e){"Enter"===e.key&&n.onRenameConfirm(e)},n.onRenameConfirm=function(e){e.nativeEvent.stopImmediatePropagation();var t=n.state.name.trim();if(t===n.props.name)return void n.props.onRenameCancel();var a=n.validateInput(),r=a.isValid,o=a.errMessage;r?n.props.onRenameConfirm(t):h.default.danger(o)},n.onRenameCancel=function(e){e.nativeEvent.stopImmediatePropagation(),n.props.onRenameCancel()},n.validateInput=function(){var e=n.state.name.trim(),t=!0,a="";return e?e.indexOf("/")>-1?(t=!1,a=(0,p.gettext)("Name should not include '/'."),{isValid:t,errMessage:a}):{isValid:t,errMessage:a}:(t=!1,a=(0,p.gettext)("Name is required."),{isValid:t,errMessage:a})},n.state={name:e.name},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){if(this.refs.renameInput.focus(),this.props.hasSuffix){var e=this.props.name.lastIndexOf(".");this.refs.renameInput.setSelectionRange(0,e,"forward")}else this.refs.renameInput.setSelectionRange(0,-1)}},{key:"render",value:function(){return u.default.createElement("div",{className:"rename-container"},u.default.createElement("input",{ref:"renameInput",value:this.state.name,onChange:this.onChange,onKeyPress:this.onKeyPress,onClick:this.onClick}),u.default.createElement("button",{className:"btn btn-secondary sf2-icon-confirm confirm",onClick:this.onRenameConfirm}),u.default.createElement("button",{className:"btn btn-secondary sf2-icon-cancel cancel",onClick:this.onRenameCancel}))}}]),t}(u.default.Component);g.propTypes=m,t.default=g},600:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(3),m=n(1073),g=a(m),v=n(1074),y=a(v);n(148),n(1075);var b={repoID:d.default.string.isRequired,repoName:d.default.string,isDepartmentRepo:d.default.bool,folderPath:d.default.string,folderName:d.default.string,toggleDialog:d.default.func.isRequired},C=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.toggle=function(e){n.state.activeTab!==e&&n.setState({activeTab:e})},n.renderContent=function(){var e=n.state.activeTab;return u.default.createElement(l.Fragment,null,u.default.createElement("div",{className:"share-dialog-side"},u.default.createElement(p.Nav,{pills:!0,vertical:!0},u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"userPermission"===e?"active":"",onClick:n.toggle.bind(n,"userPermission")},(0,f.gettext)("User Permission"))),u.default.createElement(p.NavItem,null,u.default.createElement(p.NavLink,{className:"groupPermission"===e?"active":"",onClick:n.toggle.bind(n,"groupPermission")},(0,f.gettext)("Group Permission"))))),u.default.createElement("div",{className:"share-dialog-main"},u.default.createElement(p.TabContent,{activeTab:n.state.activeTab},u.default.createElement(p.TabPane,{tabId:"userPermission"},u.default.createElement(g.default,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})),u.default.createElement(p.TabPane,{tabId:"groupPermission"},u.default.createElement(y.default,{repoID:n.props.repoID,repoName:n.props.repoName,folderPath:n.props.folderPath,isDepartmentRepo:n.props.isDepartmentRepo})))))},n.state={activeTab:"userPermission"},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props,t=e.repoName,n=e.folderName;return u.default.createElement("div",null,u.default.createElement(p.Modal,{isOpen:!0,style:{maxWidth:"980px"},className:"share-dialog",toggle:this.props.toggleDialog},u.default.createElement(p.ModalHeader,{toggle:this.props.toggleDialog},u.default.createElement("span",{dangerouslySetInnerHTML:{__html:t?h.Utils.generateDialogTitle((0,f.gettext)("{placeholder} Folder Permission"),t):h.Utils.generateDialogTitle((0,f.gettext)("Set {placeholder}'s permission"),n)}})),u.default.createElement(p.ModalBody,{className:"dialog-list-container share-dialog-content"},this.renderContent())))}}]),t}(u.default.Component);C.propTypes=b,t.default=C},71:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=function e(t){a(this,e),this.id=t.file_tag_id,this.repo_tag_id=t.repo_tag_id,this.name=t.tag_name,this.color=t.tag_color};t.default=r},81:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(3),f=n(127),h=a(f),m={isTextMode:d.default.bool.isRequired,isEditIconShow:d.default.bool.isRequired,permissions:d.default.array.isRequired,currentPermission:d.default.string.isRequired,onPermissionChanged:d.default.func.isRequired},g=function(e){function t(){var e,n,a,i;r(this,t);for(var s=arguments.length,l=Array(s),u=0;u<s;u++)l[u]=arguments[u];return n=a=o(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(l))),a.translatePermission=function(e){return p.Utils.sharePerms(e)},a.translateExplanation=function(e){return p.Utils.sharePermsExplanation(e)},i=n,o(a,i)}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement(h.default,{isTextMode:this.props.isTextMode,isEditIconShow:this.props.isEditIconShow,options:this.props.permissions,currentOption:this.props.currentPermission,onOptionChanged:this.props.onPermissionChanged,translateOption:this.translatePermission,translateExplanation:this.translateExplanation})}}]),t}(u.default.Component);g.propTypes=m,t.default=g},812:function(e,t){},813:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(2),h=n(4),m=n(3),g=n(52),v=a(g);n(313);var y={repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired,dirent:d.default.object.isRequired,onClose:d.default.func},b=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleSubmit=function(){n.onAddRelatedFile()},n.onAddRelatedFile=function(){var e=n.state,t=e.repo,a=e.selectedPath,r=n.props.repoID,o=t.repo_id,i=n.props.filePath,s=a;if(r===o&&i===s){var l=(0,f.gettext)("Can not select self as a related file.");return void n.setState({errMessage:l})}h.seafileAPI.addRelatedFile(r,o,i,s).then(function(e){n.props.onRelatedFileChange(),n.toggle()}).catch(function(e){var t=m.Utils.getErrorMsg(e);n.setState({errMessage:t})})},n.toggle=function(){n.props.toggleCancel()},n.onDirentItemClick=function(e,t,a){"file"===a.type?n.setState({repo:e,selectedPath:t}):n.setState({repo:null,selectedPath:""})},n.onRepoItemClick=function(e){n.setState({repo:null,selectedPath:""})},n.state={repo:null,selectedPath:"",isShowFile:!0,errMessage:""},n}return i(t,e),s(t,[{key:"render",value:function(){var e=(0,f.gettext)("Select related file for {placeholder}");return e=e.replace("{placeholder}",'<span class="op-target">'+m.Utils.HTMLescape(this.props.dirent.name)+"</span>"),u.default.createElement("div",{className:"sf-add-related-file"},u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},u.default.createElement("span",{className:"tag-dialog-back fas fa-sm fa-arrow-left",onClick:this.toggle,"aria-label":(0,f.gettext)("Back")}),(0,f.gettext)("Select File")),u.default.createElement(p.ModalBody,null,u.default.createElement("div",{className:"related-file-subtitle",dangerouslySetInnerHTML:{__html:e}}),u.default.createElement(v.default,{isShowFile:this.state.isShowFile,repoID:this.props.repoID,onDirentItemClick:this.onDirentItemClick,onRepoItemClick:this.onRepoItemClick,mode:"current_repo_and_other_repos"}),this.state.errMessage&&u.default.createElement(p.Alert,{color:"danger"},this.state.errMessage)),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,f.gettext)("Cancel")),this.state.selectedPath?u.default.createElement(p.Button,{color:"primary",onClick:this.handleSubmit},(0,f.gettext)("Submit")):u.default.createElement(p.Button,{color:"primary",disabled:!0},(0,f.gettext)("Submit"))))}}]),t}(u.default.Component);b.propTypes=y,t.default=b},814:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(43),h=a(f),m=n(2),g=n(4),v=n(3),y=n(5),b=a(y);n(815);var C={relatedFiles:d.default.array.isRequired,repoID:d.default.string.isRequired,filePath:d.default.string.isRequired,toggleCancel:d.default.func.isRequired,addRelatedFileToggle:d.default.func.isRequired,onRelatedFileChange:d.default.func.isRequired},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onDeleteRelatedFile=function(e){var t=n.props.filePath,a=n.props.repoID,r=e.related_id;g.seafileAPI.deleteRelatedFile(a,t,r).then(function(e){n.props.onRelatedFileChange()}).catch(function(e){var t=v.Utils.getErrorMsg(e);b.default.danger(t)})},n.toggle=function(){n.props.toggleCancel()},n.getDirentList=function(e){if(0===e.length)return void n.setState({direntList:[]});var t=[];e.map(function(e){g.seafileAPI.getFileInfo(e.repo_id,e.path).then(function(n){var a=new h.default(n.data);a.repo_name=e.repo_name,a.related_id=e.related_id,a.link=m.siteRoot+"lib/"+e.repo_id+"/file"+v.Utils.encodePath(e.path),t.push(a)})}),n.setState({direntList:t})},n.state={direntList:[]},n}return i(t,e),s(t,[{key:"componentWillMount",value:function(){this.getDirentList(this.props.relatedFiles)}},{key:"componentWillReceiveProps",value:function(e){e.relatedFiles.length!==this.props.relatedFiles.length&&this.getDirentList(e.relatedFiles)}},{key:"render",value:function(){var e=this;return u.default.createElement(l.Fragment,null,u.default.createElement(p.ModalHeader,{toggle:this.toggle},(0,m.gettext)("Related Files")),u.default.createElement(p.ModalBody,{className:this.state.direntList.length>0?"list-related-file-body":""},u.default.createElement(p.Table,{hover:!0,size:"sm",className:"list-related-file-table"},u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"40%"},(0,m.gettext)("Name")),u.default.createElement("th",{width:"20%"},(0,m.gettext)("Library Name")),u.default.createElement("th",{width:"13%"},(0,m.gettext)("Size")),u.default.createElement("th",{width:"20%"},(0,m.gettext)("Last Update")),u.default.createElement("th",{width:"5%"}),u.default.createElement("th",{width:"2%"}))),u.default.createElement("tbody",null,this.state.direntList.map(function(t,n){return u.default.createElement(u.default.Fragment,{key:n},u.default.createElement(D,{relatedFile:t,onDeleteRelatedFile:e.onDeleteRelatedFile}))}))),u.default.createElement("a",{href:"#",className:"add-related-file-link",onClick:this.props.addRelatedFileToggle},(0,m.gettext)("Add File"))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.toggle},(0,m.gettext)("Close"))))}}]),t}(u.default.Component);S.propTypes=C;var w={relatedFile:d.default.object,onDeleteRelatedFile:d.default.func.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3",t=this.props.relatedFile;return u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",null,u.default.createElement("a",{href:t.link,target:"_blank"},t.name)),u.default.createElement("td",null,t.repo_name),u.default.createElement("td",null,t.size),u.default.createElement("td",null,t.mtime_relative),u.default.createElement("td",null,u.default.createElement("i",{className:e,onClick:this.props.onDeleteRelatedFile.bind(this,t)})),u.default.createElement("td",null))}}]),t}(u.default.Component);D.propTypes=w,t.default=S},815:function(e,t){},818:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(228),f=a(p),h=n(819),m=a(h),g=n(403),v=a(g),y=n(213),b=n(3),C={repoPermission:d.default.bool,isNodeMenuShow:d.default.bool.isRequired,treeData:d.default.object.isRequired,currentPath:d.default.string.isRequired,onMenuItemClick:d.default.func,onNodeClick:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onItemMove:d.default.func,currentRepoInfo:d.default.object,selectedDirentList:d.default.array,onItemsMove:d.default.func},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onItemMove=function(e,t,a,r){n.props.onItemMove(e,t,a,r)},n.onNodeDragStart=function(e,t){if(b.Utils.isIEBrower())return!1;var n={nodeDirent:t.object,nodeParentPath:t.parentNode.path,nodeRootPath:t.path};n=JSON.stringify(n),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("applicaiton/drag-item-info",n)},n.onNodeDragEnter=function(e,t){if(b.Utils.isIEBrower())return!1;e.persist(),"tree-view tree "===e.target.className&&n.setState({isTreeViewDropTipShow:!0})},n.onNodeDragMove=function(e){if(b.Utils.isIEBrower())return!1;e.preventDefault(),e.dataTransfer.dropEffect="move"},n.onNodeDragLeave=function(e,t){if(b.Utils.isIEBrower())return!1;"tree-view tree tree-view-drop"===e.target.className&&n.setState({isTreeViewDropTipShow:!1})},n.onNodeDrop=function(e,t){if(b.Utils.isIEBrower())return!1;if(!e.dataTransfer.files.length){var a=e.dataTransfer.getData("applicaiton/drag-item-info");a=JSON.parse(a);var r=a,o=r.nodeDirent,i=r.nodeParentPath,s=r.nodeRootPath,l=t;if(Array.isArray(a))return l?void n.onMoveItems(a,l,n.props.currentRepoInfo,l.path):"/"===a[0].nodeParentPath?void n.setState({isTreeViewDropTipShow:!1}):(n.props.onItemsMove(n.props.currentRepoInfo,"/"),void n.setState({isTreeViewDropTipShow:!1}));if(!l)return"/"===i?void n.setState({isTreeViewDropTipShow:!1}):(n.onItemMove(n.props.currentRepoInfo,o,"/",i),void n.setState({isTreeViewDropTipShow:!1}));if("dir"===l.object.type&&i!==l.path&&(i!==l.parentNode.path||l.object.name!==o.name)){if("dir"===l.object.type&&"dir"===o.type&&l.parentNode.path!==i){if(b.Utils.getPaths(l.path).includes(s))return}n.onItemMove(n.props.currentRepoInfo,o,l.path,i)}}},n.onMoveItems=function(e,t,a,r){var o=[],i=b.Utils.getPaths(r);if(e.forEach(function(e){var t=e.nodeRootPath;o.push(t)}),"dir"===t.object.type&&!o.some(function(e){return e===r})&&(!e[0].nodeParentPath||e[0].nodeParentPath!==t.path)){o.some(function(e){return i.includes(e)})||n.props.onItemsMove(a,r)}},n.freezeItem=function(){n.setState({isItemFreezed:!0})},n.unfreezeItem=function(){n.setState({isItemFreezed:!1})},n.onMenuItemClick=function(e,t){n.props.onMenuItemClick(e,t),(0,y.hideMenu)()},n.onMouseDown=function(e){e.stopPropagation(),e.button},n.onContextMenu=function(e){e.preventDefault();var t=n.props.currentRepoInfo;if("admin"!==t.permission&&"rw"!==t.permission)return"";n.handleContextClick(e)},n.handleContextClick=function(e,t){if(e.preventDefault(),e.stopPropagation(),n.props.isNodeMenuShow){var a=e.clientX||e.touches&&e.touches[0].pageX,r=e.clientY||e.touches&&e.touches[0].pageY;n.props.posX&&(a-=n.props.posX),n.props.posY&&(r-=n.props.posY),(0,y.hideMenu)();var o=n.getMenuList(t),i={id:"tree-node-contextmenu",position:{x:a,y:r},target:e.target,currentObject:t,menuList:o};(0,y.showMenu)(i)}},n.getMenuList=function(e){var t=f.default.NEW_FOLDER,n=f.default.NEW_FILE,a=f.default.COPY,r=f.default.MOVE,o=f.default.RENAME,i=f.default.DELETE,s=f.default.OPEN_VIA_CLIENT;return e?"dir"===e.object.type?[t,n,a,r,o,i]:[o,i,a,r,s]:[t,n]},n.onShowMenu=function(){n.freezeItem()},n.onHideMenu=function(){n.unfreezeItem()},n.state={isItemFreezed:!1,isTreeViewDropTipShow:!1},n}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"tree-view tree "+(this.state.isTreeViewDropTipShow?"tree-view-drop":""),onDrop:this.onNodeDrop,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onMouseDown:this.onMouseDown,onContextMenu:this.onContextMenu},u.default.createElement(m.default,{repoPermission:this.props.repoPermission,node:this.props.treeData.root,currentPath:this.props.currentPath,paddingLeft:20,isNodeMenuShow:this.props.isNodeMenuShow,isItemFreezed:this.state.isItemFreezed,onNodeClick:this.props.onNodeClick,onMenuItemClick:this.props.onMenuItemClick,onNodeExpanded:this.props.onNodeExpanded,onNodeCollapse:this.props.onNodeCollapse,onNodeDragStart:this.onNodeDragStart,freezeItem:this.freezeItem,unfreezeItem:this.unfreezeItem,onNodeDragMove:this.onNodeDragMove,onNodeDrop:this.onNodeDrop,onNodeDragEnter:this.onNodeDragEnter,onNodeDragLeave:this.onNodeDragLeave,handleContextClick:this.handleContextClick}),u.default.createElement(v.default,{id:"tree-node-contextmenu",onMenuItemClick:this.onMenuItemClick,onHideMenu:this.onHideMenu,onShowMenu:this.onShowMenu}))}}]),t}(u.default.Component);S.propTypes=C,t.default=S},819:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(228),h=a(f),m=n(322),g=a(m),v={repoPermission:d.default.bool,node:d.default.object.isRequired,currentPath:d.default.string.isRequired,paddingLeft:d.default.number.isRequired,isNodeMenuShow:d.default.bool.isRequired,isItemFreezed:d.default.bool.isRequired,onNodeClick:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeDragStart:d.default.func.isRequired,freezeItem:d.default.func.isRequired,unfreezeItem:d.default.func.isRequired,onMenuItemClick:d.default.func,onNodeDragMove:d.default.func,onNodeDrop:d.default.func,handleContextClick:d.default.func.isRequired,onNodeDragEnter:d.default.func.isRequired,onNodeDragLeave:d.default.func.isRequired},y=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseOver=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!0,isHighlight:!0})},n.onMouseLeave=function(){n.props.isItemFreezed||n.setState({isShowOperationMenu:!1,isHighlight:!1})},n.onNodeClick=function(){n.props.onNodeClick(n.props.node)},n.onLoadToggle=function(e){e.stopPropagation();var t=n.props.node;t.isExpanded?n.props.onNodeCollapse(t):n.props.onNodeExpanded(t)},n.onNodeDragStart=function(e){n.props.onNodeDragStart(e,n.props.node)},n.onNodeDragEnter=function(e){"dir"===n.props.node.object.type&&n.setState({isNodeDropShow:!0}),n.props.onNodeDragEnter(e,n.props.node)},n.onNodeDragMove=function(e){n.props.onNodeDragMove(e)},n.onNodeDragLeave=function(e){n.setState({isNodeDropShow:!1}),n.props.onNodeDragLeave(e,n.props.node)},n.onNodeDrop=function(e){e.stopPropagation(),n.setState({isNodeDropShow:!1}),n.props.onNodeDrop(e,n.props.node)},n.unfreezeItem=function(){n.setState({isShowOperationMenu:!1}),n.props.unfreezeItem()},n.onMenuItemClick=function(e,t,a){n.props.onMenuItemClick(e,a)},n.onItemMouseDown=function(e){e.stopPropagation(),e.button},n.onItemContextMenu=function(e){n.handleContextClick(e)},n.handleContextClick=function(e){n.props.handleContextClick(e,n.props.node),n.setState({isShowOperationMenu:!1})},n.getNodeTypeAndIcon=function(){var e=n.props.node,t="",a="";if("dir"===e.object.type)t=u.default.createElement("i",{className:"far fa-folder"}),a="dir";else{var r=e.object.name.lastIndexOf(".");if(-1===r)t=u.default.createElement("i",{className:"far fa-file"}),a="file";else{var o=e.object.name.slice(r).toLowerCase();".png"===o||".jpg"===o||".jpeg"===o||".gif"===o||".bmp"===o?(t=u.default.createElement("i",{className:"far fa-image"}),a="image"):".md"===o||".markdown"===o?(t=u.default.createElement("i",{className:"far fa-file-alt"}),a="file"):(t=u.default.createElement("i",{className:"far fa-file"}),a="file")}}return{icon:t,type:a}},n.renderChildren=function(){var e=n.props,a=e.node,r=e.paddingLeft;return a.hasChildren()?u.default.createElement("div",{className:"children",style:{paddingLeft:r}},a.children.map(function(e){return u.default.createElement(t,{key:e.path,node:e,paddingLeft:r,repoPermission:n.props.repoPermission,currentPath:n.props.currentPath,isNodeMenuShow:n.props.isNodeMenuShow,isItemFreezed:n.props.isItemFreezed,onNodeClick:n.props.onNodeClick,onNodeCollapse:n.props.onNodeCollapse,onNodeExpanded:n.props.onNodeExpanded,freezeItem:n.props.freezeItem,onMenuItemClick:n.props.onMenuItemClick,unfreezeItem:n.unfreezeItem,onNodeDragStart:n.props.onNodeDragStart,onNodeDragMove:n.props.onNodeDragMove,onNodeDrop:n.props.onNodeDrop,onNodeDragEnter:n.props.onNodeDragEnter,onNodeDragLeave:n.props.onNodeDragLeave,handleContextClick:n.props.handleContextClick})})):""},n.state={isHighlight:!1,isShowOperationMenu:!1,isNodeDropShow:!1},n}return i(t,e),s(t,[{key:"componentWillReceiveProps",value:function(e){e.isItemFreezed||this.setState({isShowOperationMenu:!1,isHighlight:!1})}},{key:"caculateMenuList",value:function(e){var t=h.default.NEW_FOLDER,n=h.default.NEW_FILE,a=h.default.COPY,r=h.default.MOVE,o=h.default.RENAME,i=h.default.DELETE,s=h.default.OPEN_VIA_CLIENT;return"dir"===e.object.type?[t,n,a,r,o,i]:[o,i,a,r,s]}},{key:"render",value:function(){var e=this.props,t=e.currentPath,n=e.node,a=e.isNodeMenuShow,r=this.getNodeTypeAndIcon(),o=r.type,i=r.icon,s=this.state.isHighlight?"tree-node-inner-hover ":"";return n.path===t&&(s="tree-node-hight-light"),u.default.createElement("div",{className:"tree-node"},u.default.createElement("div",{type:o,className:"tree-node-inner text-nowrap "+s+" "+("/"===n.path?"hide":"")+" "+(this.state.isNodeDropShow?"tree-node-drop":""),title:n.object.name,onMouseEnter:this.onMouseEnter,onMouseOver:this.onMouseOver,onMouseLeave:this.onMouseLeave,onMouseDown:this.onItemMouseDown,onContextMenu:this.onItemContextMenu,onClick:this.onNodeClick},u.default.createElement("div",{className:"tree-node-text",draggable:"true",onDragStart:this.onNodeDragStart,onDragEnter:this.onNodeDragEnter,onDragLeave:this.onNodeDragLeave,onDragOver:this.onNodeDragMove,onDrop:this.onNodeDrop},n.object.name),u.default.createElement("div",{className:"left-icon"},"dir"===o&&(!n.isLoaded||n.isLoaded&&n.hasChildren())&&u.default.createElement("i",{className:"folder-toggle-icon fa "+(n.isExpanded?"fa-caret-down":"fa-caret-right"),onMouseDown:function(e){return e.stopPropagation()},onClick:this.onLoadToggle}),u.default.createElement("i",{className:"tree-node-icon"},i)),a&&u.default.createElement("div",{className:"right-icon"},(this.props.repoPermission||p.permission)&&this.state.isShowOperationMenu&&u.default.createElement(g.default,{item:this.props.node,toggleClass:"fas fa-ellipsis-v",getMenuList:this.caculateMenuList,onMenuItemClick:this.onMenuItemClick,freezeItem:this.props.freezeItem,unfreezeItem:this.unfreezeItem}))),n.isExpanded&&this.renderChildren())}}]),t}(u.default.Component);y.propTypes=v,t.default=y},82:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(3),s=n(94),l=a(s),u=n(37),c=a(u),d=n(43),p=a(d),f=function(){function e(){r(this,e)}return o(e,[{key:"expandNode",value:function(e,t){e.expandNode(t)}},{key:"collapseNode",value:function(e,t){var n=e.clone();return t=n.getNodeByPath(t.path),n.collapseNode(t),n}},{key:"findNodeByPath",value:function(e,t){return e.clone().getNodeByPath(t)}},{key:"getNodeChildrenObject",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"name",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"asc",r=e.getNodeChildrenObject(t);return r=i.Utils.sortDirents(r,n,a)}},{key:"addNodeToParent",value:function(e,t,n){return e.addNodeToParentNode(t,n),e}},{key:"addNodeListToParent",value:function(e,t,n){return e.addNodeListToParent(t,n),e}},{key:"addNodeToParentByPath",value:function(e,t,n){var a=e.clone(),r=a.getNodeByPath(n);return a.addNodeToParent(t,r),a}},{key:"deleteNodeByPath",value:function(e,t){var n=e.clone(),a=n.getNodeByPath(t);return n.deleteNode(a),n}},{key:"deleteNodeListByPaths",value:function(e,t){var n=e.clone();return t.forEach(function(e){var t=n.getNodeByPath(e);n.deleteNode(t)}),n}},{key:"renameNodeByPath",value:function(e,t,n){var a=e.clone(),r=a.getNodeByPath(t);return a.renameNode(r,n),a}},{key:"updateNodeByPath",value:function(e,t,n,a){var r=e.clone(),o=r.getNodeByPath(t);return r.updateNode(o,n,a),r}},{key:"moveNodeByPath",value:function(e,t,n,a){var r=e.clone(),o=r.getNodeByPath(t),i=r.getNodeByPath(n);return i&&o&&(o.object.name=a,r.moveNode(o,i)),!i&&o&&r.deleteNode(o),r}},{key:"moveNodeListByPaths",value:function(e,t,n){var a=e.clone(),r=a.getNodeByPath(n);return r?t.forEach(function(e){var t=a.getNodeByPath(e);a.moveNode(t,r)}):t.forEach(function(e){var t=a.getNodeByPath(e);a.delete(t)}),a}},{key:"copyNodeByPath",value:function(e,t,n,a){var r=e.clone(),o=r.getNodeByPath(n),i=r.getNodeByPath(t);if(o){var s=i.clone();s.object.name=a,r.copyNode(s,o)}return r}},{key:"copyNodeListByPaths",value:function(e,t,n){var a=e.clone(),r=a.getNodeByPath(n);return r&&t.forEach(function(e){var t=a.getNodeByPath(e);a.copyNode(t,r)}),a}},{key:"buildTree",value:function(){var e=new l.default,t=new p.default({name:"/"}),n=new c.default({object:t,isLoaded:!1,isExpanded:!0});return e.setRoot(n),e}}]),e}(),h=new f;t.default=h},820:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(510),f=a(p),h=n(2),m=n(6),g=n(12),v=a(g),y=n(4),b=n(3),C=n(5),S=a(C);n(822);var w={children:d.default.object,isFileLoading:d.default.bool.isRequired,markdownContent:d.default.string.isRequired,latestContributor:d.default.string.isRequired,lastModified:d.default.string.isRequired,onLinkClick:d.default.func.isRequired,isWiki:d.default.bool,isTOCShow:d.default.bool,repoID:d.default.string,path:d.default.string},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onContentRendered=function(e){n.titlesInfo=e.titlesInfo},n.listRelatedFiles=function(){n.props.repoID&&n.props.path&&y.seafileAPI.listRelatedFiles(n.props.repoID,n.props.path).then(function(e){n.setState({relatedFiles:e.data.related_files})}).catch(function(e){var t=b.Utils.getErrorMsg(e);S.default.danger(t)})},n.onLinkClick=function(e){e.preventDefault(),e.stopPropagation();var t="";if("A"!==e.target.tagName){for(var a=e.target.parentNode;"A"!==a.tagName;)a=a.parentNode;t=a.href}else t=e.target.href;n.props.onLinkClick(t)},n.onScrollHandler=function(){var e=n.markdownContainer.current.scrollTop+180,t=n.titlesInfo.length,a=void 0;if(e<=n.titlesInfo[0])return a=0,void n.setState({activeTitleIndex:a});if(e>n.titlesInfo[t-1])return a=n.titlesInfo.length-1,void n.setState({activeTitleIndex:a});for(var r=0;r<t;r++)if(!(e>n.titlesInfo[r])){a=r-1;break}n.setState({activeTitleIndex:a})},n.changeInlineNode=function(e){if("inline"==e.object){var t=void 0,a=void 0;if("image"==e.type&&h.isPublicWiki){t=e.data.src;if(new RegExp(h.serviceURL+"/lib/"+h.repoID+"/file.*raw=1").test(t)){var r=t.indexOf("/file"),o=t.indexOf("?");a=t.substring(r+5,o)}else{if(!/^\.\.\/*/.test(t)&&!/^\.\/*/.test(t))return;var i=n.props.path,s=i.slice(0,i.lastIndexOf("/"))+"/"+t;a=b.Utils.pathNormalize(s)}e.data.src=h.serviceURL+"/view-image-via-public-wiki/?slug="+h.slug+"&path="+a}else if("link"==e.type)if(t=e.data.href,b.Utils.isInternalMarkdownLink(t,h.repoID)){var l=b.Utils.getPathFromInternalMarkdownLink(t,h.repoID);e.data.href=h.serviceURL+"/published/"+h.slug+l}else if(b.Utils.isInternalDirLink(t,h.repoID)){var u=b.Utils.getPathFromInternalDirLink(t,h.repoID);e.data.href=h.serviceURL+"/published/"+h.slug+u}}return e},n.modifyValueBeforeRender=function(e){var t=e.document.nodes,a=b.Utils.changeMarkdownNodes(t,n.changeInlineNode);return e.document.nodes=a,e},n.renderMarkdown=function(){var e=!0;return!1===n.props.isTOCShow&&(e=!1),n.props.isWiki?u.default.createElement(f.default,{showTOC:e,markdownContent:n.props.markdownContent,activeTitleIndex:n.state.activeTitleIndex,onContentRendered:n.onContentRendered,modifyValueBeforeRender:n.modifyValueBeforeRender}):u.default.createElement(f.default,{showTOC:e,markdownContent:n.props.markdownContent,activeTitleIndex:n.state.activeTitleIndex,onContentRendered:n.onContentRendered})},n.renderRelatedFiles=function(){var e=n.state.relatedFiles;return e.length>0?u.default.createElement("div",{className:"sf-releted-files",id:"sf-releted-files"},u.default.createElement("div",{className:"sf-releted-files-header"},u.default.createElement("h4",null,(0,h.gettext)("related files"))),e.map(function(e,t){var n=h.siteRoot+"lib/"+e.repo_id+"/file"+b.Utils.encodePath(e.path);return u.default.createElement("div",{className:"sf-releted-file",key:t},u.default.createElement("a",{href:n,target:"_blank"},u.default.createElement(m.Card,{body:!0,size:"sm"},u.default.createElement(m.CardTitle,null,e.name),u.default.createElement(m.CardText,null,e.repo_name),u.default.createElement("span",{className:"sf-releted-file-arrow"}))))})):null},n.state={activeTitleIndex:0,relatedFiles:[]},n.markdownContainer=u.default.createRef(),n.links=[],n.titlesInfo=[],n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this;this.links=document.querySelectorAll(".wiki-page-content a"),this.links.forEach(function(t){t.addEventListener("click",e.onLinkClick)}),this.listRelatedFiles()}},{key:"componentWillReceiveProps",value:function(e){var t=this;this.props.markdownContent!==e.markdownContent&&(this.links.forEach(function(e){e.removeEventListener("click",t.onLinkClick)}),this.listRelatedFiles())}},{key:"componentDidUpdate",value:function(){var e=this;this.links=document.querySelectorAll(".wiki-page-content a"),this.links.forEach(function(t){t.addEventListener("click",e.onLinkClick)})}},{key:"componentWillUnmount",value:function(){var e=this;this.links.forEach(function(t){t.removeEventListener("click",e.onLinkClick)})}},{key:"render",value:function(){if(this.props.isFileLoading)return u.default.createElement(v.default,null);var e=this.props.repoID?"wiki-page-content w-100":"wiki-page-content";return u.default.createElement("div",{ref:this.markdownContainer,className:"wiki-page-container",onScroll:this.onScrollHandler.bind(this)},u.default.createElement("div",{className:e},this.props.children,this.renderMarkdown(),this.props.isWiki&&this.renderRelatedFiles(),u.default.createElement("p",{id:"wiki-page-last-modified"},(0,h.gettext)("Last modified by")," ",this.props.latestContributor,", ",u.default.createElement("span",null,this.props.lastModified))))}}]),t}(u.default.Component),E={isWiki:!1};D.propTypes=w,f.default.defaultProps=E,t.default=D},821:function(e,t){},822:function(e,t){},824:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(6),f=n(9),h=a(f),m=n(2),g=n(4),v=n(3),y=n(5),b=a(y),C={repoID:d.default.string.isRequired,currentTag:d.default.object.isRequired,toggleCancel:d.default.func.isRequired,onClose:d.default.func.isRequired,updateUsedRepoTags:d.default.func.isRequired,onFileTagChanged:d.default.func},S=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onFileTagChanged=function(e){var t=e.parent_path,a={name:e.filename},r="/"===t?t+e.filename:t+"/"+e.filename;n.props.onFileTagChanged(a,r)},n.onDeleteTaggedFile=function(e){var t=n.props.repoID,a=e.file_tag_id;g.seafileAPI.deleteFileTag(t,a).then(function(t){n.getTaggedFiles(),n.props.updateUsedRepoTags(),n.props.onFileTagChanged&&!e.file_deleted&&n.onFileTagChanged(e)}).catch(function(e){var t=v.Utils.getErrorMsg(e);b.default.danger(t)})},n.getTaggedFiles=function(){var e=n.props,t=e.repoID,a=e.currentTag;g.seafileAPI.listTaggedFiles(t,a.id).then(function(e){var t=[];void 0!==e.data.tagged_files&&e.data.tagged_files.forEach(function(e){var n=e;t.push(n)}),n.setState({taggedFileList:t})}).catch(function(e){var t=v.Utils.getErrorMsg(e);b.default.danger(t)})},n.state={taggedFileList:[]},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){this.getTaggedFiles()}},{key:"render",value:function(){var e=this,t=this.state.taggedFileList;return u.default.createElement(p.Modal,{isOpen:!0},u.default.createElement(p.ModalHeader,{toggle:this.props.onClose},(0,m.gettext)("Tagged Files")),u.default.createElement(p.ModalBody,{className:"dialog-list-container"},u.default.createElement("table",null,u.default.createElement("thead",null,u.default.createElement("tr",null,u.default.createElement("th",{width:"45%",className:"ellipsis"},(0,m.gettext)("Name")),u.default.createElement("th",{width:"27%"},(0,m.gettext)("Size")),u.default.createElement("th",{width:"18%"},(0,m.gettext)("Last Update")),u.default.createElement("th",{width:"10%"}))),u.default.createElement("tbody",null,t.map(function(t,n){return u.default.createElement(D,{key:n,repoID:e.props.repoID,taggedFile:t,onDeleteTaggedFile:e.onDeleteTaggedFile})})))),u.default.createElement(p.ModalFooter,null,u.default.createElement(p.Button,{color:"secondary",onClick:this.props.toggleCancel},(0,m.gettext)("Close"))))}}]),t}(u.default.Component);S.propTypes=C,t.default=S;var w={repoID:d.default.string.isRequired,taggedFile:d.default.object,onDeleteTaggedFile:d.default.func.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseEnter=function(){n.setState({active:!0})},n.onMouseLeave=function(){n.setState({active:!1})},n.state={active:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.taggedFile,t=this.state.active?"action-icon sf2-icon-x3":"action-icon vh sf2-icon-x3",n=e.parent_path?v.Utils.joinPath(e.parent_path,e.filename):"",a=m.siteRoot+"lib/"+this.props.repoID+"/file"+v.Utils.encodePath(n);return e.file_deleted?u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{colSpan:"3",className:"name"},e.filename," ",u.default.createElement("span",{style:{color:"red"}},(0,m.gettext)("deleted"))),u.default.createElement("td",null,u.default.createElement("i",{className:t,onClick:this.props.onDeleteTaggedFile.bind(this,e)}))):u.default.createElement("tr",{onMouseEnter:this.onMouseEnter,onMouseLeave:this.onMouseLeave},u.default.createElement("td",{className:"name"},u.default.createElement("a",{href:a,target:"_blank"},e.filename)),u.default.createElement("td",null,v.Utils.bytesToSize(e.size)),u.default.createElement("td",null,h.default.unix(e.mtime).fromNow()),u.default.createElement("td",null,u.default.createElement("i",{className:t,onClick:this.props.onDeleteTaggedFile.bind(this,e)})))}}]),t}(u.default.Component);D.propTypes=w},825:function(e,t){var n={utf8:{stringToBytes:function(e){return n.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(n.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}};e.exports=n},85:function(e,t,n){"use strict";function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=function e(t){a(this,e),this.repo_id=t.repo_id,this.repo_name=t.repo_name,this.permission=t.permission,this.size=r.Utils.bytesToSize(t.size),this.file_count=t.file_count,this.owner_name=t.owner_name,this.owner_email=t.owner_email,this.owner_contact_email=t.owner_contact_email,this.is_admin=t.is_admin,this.is_virtual=t.is_virtual,this.no_quota=t.no_quota,this.has_been_shared_out=t.has_been_shared_out,this.encrypted=t.encrypted,this.lib_need_decrypt=t.lib_need_decrypt,this.last_modified=t.last_modified,this.status=t.status};t.default=o},86:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(2),f=n(128),h=a(f),m=n(140),g=a(m),v=n(44),y=a(v),b={repoID:d.default.string,onSearchedClick:d.default.func.isRequired,searchPlaceholder:d.default.string},C=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this.props.searchPlaceholder||(0,p.gettext)("Search Files");return u.default.createElement("div",{className:"common-toolbar"},p.isPro&&u.default.createElement(h.default,{repoID:this.props.repoID,placeholder:e,onSearchedClick:this.props.onSearchedClick}),u.default.createElement(g.default,null),u.default.createElement(y.default,null))}}]),t}(u.default.Component);C.propTypes=b,t.default=C},926:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(24),f=a(p),h=n(824),m=a(h),g=n(1087),v=a(g),y=n(1089),b=a(y),C=n(2),S=n(3);n(1090);var w={repoID:d.default.string.isRequired,currentPath:d.default.string.isRequired,usedRepoTags:d.default.array.isRequired,readmeMarkdown:d.default.object,draftCounts:d.default.number,updateUsedRepoTags:d.default.func.isRequired,onFileTagChanged:d.default.func.isRequired},D=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onListTaggedFiles=function(e){n.setState({currentTag:e,isListTaggedFileShow:!n.state.isListTaggedFileShow})},n.onCloseDialog=function(){n.setState({isListTaggedFileShow:!1})},n.toggleDrafts=function(){n.setState({showRepoDrafts:!n.state.showRepoDrafts})},n.toggleReadme=function(){n.setState({showReadmeDialog:!n.state.showReadmeDialog})},n.state={currentTag:null,isListTaggedFileShow:!1,showRepoDrafts:!1,showReadmeDialog:!1},n}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.repoID,a=t.currentPath,r=t.usedRepoTags,o=t.readmeMarkdown,i=null!==o?C.siteRoot+"lib/"+n+"/file"+S.Utils.joinPath(a,o.name)+"?mode=edit":"",s=null!==o?a+o.name:"";return u.default.createElement("div",{className:"repo-info-bar"},r.length>0&&u.default.createElement("ul",{className:"used-tag-list"},r.map(function(t){return u.default.createElement("li",{key:t.id,className:"used-tag-item"},u.default.createElement("span",{className:"used-tag",style:{backgroundColor:t.color}}),u.default.createElement("span",{className:"used-tag-name",title:t.name},t.name),u.default.createElement("span",{className:"used-tag-files",onClick:e.onListTaggedFiles.bind(e,t)},t.fileCount>1?t.fileCount+" files":t.fileCount+" file"))})),u.default.createElement("div",{className:r.length>0&&o?"file-info-list mt-1":"file-info-list"},null!==o&&parseInt(o.size)>1&&u.default.createElement("span",{className:"file-info",onClick:this.toggleReadme},u.default.createElement("span",{className:"info-icon sf2-icon-readme"}),u.default.createElement("span",{className:"used-tag-name"},o.name)),null!==o&&parseInt(o.size)<2&&u.default.createElement("span",{className:"file-info"},u.default.createElement("span",{className:"info-icon sf2-icon-readme"}),u.default.createElement("a",{className:"used-tag-name",href:i,target:"_blank"},o.name)),this.props.draftCounts>0&&u.default.createElement("span",{className:"file-info"},u.default.createElement("span",{className:"info-icon sf2-icon-drafts"}),u.default.createElement("span",{className:"used-tag-name"},(0,C.gettext)("draft")),u.default.createElement("span",{className:"used-tag-files",onClick:this.toggleDrafts},this.props.draftCounts>1?this.props.draftCounts+" files":this.props.draftCounts+" file"))),this.state.isListTaggedFileShow&&u.default.createElement(f.default,null,u.default.createElement(m.default,{repoID:n,currentTag:this.state.currentTag,onClose:this.onCloseDialog,toggleCancel:this.onListTaggedFiles,updateUsedRepoTags:this.props.updateUsedRepoTags,onFileTagChanged:this.props.onFileTagChanged})),this.state.showRepoDrafts&&u.default.createElement(f.default,null,u.default.createElement(v.default,{toggle:this.toggleDrafts,repoID:this.props.repoID})),this.state.showReadmeDialog&&u.default.createElement(f.default,null,u.default.createElement(b.default,{toggleCancel:this.toggleReadme,repoID:n,filePath:s,href:i,fileName:o.name})))}}]),t}(u.default.Component);D.propTypes=w,t.default=D},94:function(e,t,n){"use strict";function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),i=n(37),s=function(e){return e&&e.__esModule?e:{default:e}}(i),l=function(){function e(){r(this,e),this.root=null}return o(e,[{key:"clone",value:function(){var t=new e;return this.root&&(t.root=this.root.clone()),t}},{key:"setRoot",value:function(e){this.root=e}},{key:"getNodeByPath",value:function(e){function t(t){return t.path===e&&(n=t,!0)}var n=null;return this.traverseDF(t),n}},{key:"getNodeChildrenObject",value:function(e){return e.children.map(function(e){return e.object})}},{key:"addNodeToParent",value:function(e,t){t.addChild(e)}},{key:"addNodeListToParent",value:function(e,t){e.forEach(function(e){t.addChild(e)})}},{key:"deleteNode",value:function(e){this.getNodeByPath(e.parentNode.path).deleteChild(e)}},{key:"deleteNodeList",value:function(e){var t=this;e.forEach(function(e){t.deleteNode(e)})}},{key:"renameNode",value:function(e,t){e.rename(t)}},{key:"updateNode",value:function(e,t,n){e.updateObjectParam(t,n)}},{key:"moveNode",value:function(e,t){this.deleteNode(e),t.addChild(e)}},{key:"copyNode",value:function(e,t){t.addChild(e)}},{key:"traverseDF",value:function(e){var t=[],n=!1;t.unshift(this.root);for(var r=t.shift();!n&&r;)(n=1==e(r))||(t.unshift.apply(t,a(r.children)),r=t.shift())}},{key:"traverseBF",value:function(e){var t=[],n=!1;t.push(this.root);for(var r=t.shift();!n&&r;)(n=!0===e(r))||(t.push.apply(t,a(r.children)),r=t.shift())}},{key:"expandNode",value:function(e){for(e.isExpanded=!0;e.parentNode;)e.parentNode.isExpanded=!0,e=e.parentNode}},{key:"collapseNode",value:function(e){e.isExpanded=!1}},{key:"isNodeChild",value:function(e,t){return t.children.some(function(t){return t.path===e.path})}},{key:"serializeToJson",value:function(){return this.root.serializeToJson()}},{key:"deserializefromJson",value:function(t){var n=s.default.deserializefromJson(t),a=new e;return a.setRoot(n),a}}]),e}();t.default=l},97:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(98),f=a(p),h={currentRepoInfo:d.default.object,isShowFile:d.default.bool,repo:d.default.object,repoList:d.default.array,selectedRepo:d.default.object,initToShowChildren:d.default.bool.isRequired,selectedPath:d.default.string,onDirentItemClick:d.default.func.isRequired,onRepoItemClick:d.default.func.isRequired,fileSuffixes:d.default.array,selectedItemInfo:d.default.object},m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.currentRepoInfo,a=t.repoList;return n&&(a=[],a.push(n)),u.default.createElement("ul",{className:"list-view-content file-chooser-item"},a.length>0&&a.map(function(t,n){return u.default.createElement(f.default,{key:n,repo:t,initToShowChildren:e.props.initToShowChildren,selectedRepo:e.props.selectedRepo,selectedPath:e.props.selectedPath,onRepoItemClick:e.props.onRepoItemClick,onDirentItemClick:e.props.onDirentItemClick,isShowFile:e.props.isShowFile,fileSuffixes:e.props.fileSuffixes,selectedItemInfo:e.props.selectedItemInfo})}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m},98:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(99),f=a(p),h=n(37),m=a(h),g=n(43),v=a(g),y=n(4),b=n(82),C=a(b),S=n(3),w=n(5),D=a(w),E={isShowFile:d.default.bool,selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,initToShowChildren:d.default.bool.isRequired,onDirentItemClick:d.default.func.isRequired,onRepoItemClick:d.default.func.isRequired,fileSuffixes:d.default.array,selectedItemInfo:d.default.object},P=function(e){function t(e){r(this,t);var n=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.addResponseListToNode=function(e,t){t.isLoaded=!0,t.isExpanded=!0;var n=e.map(function(e){return new v.default(e)});n=S.Utils.sortDirents(n,"name","asc");var a=n.map(function(e){return new m.default({object:e})});t.addChildren(a)},n.onNodeExpanded=function(e){var t=n.props.repo.repo_id,a=n.state.treeData.clone();e=a.getNodeByPath(e.path),e.isLoaded?(a.expandNode(e),n.setState({treeData:a})):y.seafileAPI.listDir(t,e.path).then(function(t){var r=[];r=!0===n.props.isShowFile?t.data.dirent_list:t.data.dirent_list.filter(function(e){return"dir"===e.type}),n.addResponseListToNode(r,e),n.setState({treeData:a})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.onNodeCollapse=function(e){var t=C.default.collapseNode(n.state.treeData,e);n.setState({treeData:t})},n.loadNodeAndParentsByPath=function(e,t){var a=n.state.treeData.clone();y.seafileAPI.listDir(e,t,{with_parents:!0}).then(function(e){var t=e.data.dirent_list;t=t.filter(function(e){return"dir"===e.type});for(var r={},o=0;o<t.length;o++){var i=t[o],s=i.parent_dir,l="/"===s?"/":s.slice(0,s.length-1);r[l]||(r[l]=[]),r[l].push(i)}for(var u in r){var c=a.getNodeByPath(u);c.isLoaded||n.addResponseListToNode(r[u],c)}n.setState({treeData:a})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)})},n.onToggleClick=function(e){e.stopPropagation(),n.setState({isShowChildren:!n.state.isShowChildren})},n.onDirentItemClick=function(e,t){var a=n.props.repo;n.props.onDirentItemClick(a,e,t)},n.onRepoItemClick=function(e){n.isCurrentRepo()&&""===n.props.selectedPath?n.onToggleClick(e):n.props.onRepoItemClick(n.props.repo)},n.isCurrentRepo=function(){var e=n.props,t=e.selectedRepo,a=e.repo;return t&&a.repo_id===t.repo_id},n.state={isShowChildren:n.props.initToShowChildren,treeData:C.default.buildTree()},n}return i(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.repo.repo_id;y.seafileAPI.listDir(t,"/").then(function(t){var n=e.state.treeData.clone(),a=[];a=!0===e.props.isShowFile?t.data.dirent_list:t.data.dirent_list.filter(function(e){return"dir"===e.type}),e.addResponseListToNode(a,n.root),e.setState({treeData:n})}).catch(function(e){var t=S.Utils.getErrorMsg(e);D.default.danger(t)}),this.props.selectedItemInfo.repoID===this.props.repo.repo_id&&(this.setState({isShowChildren:!0}),this.loadNodeAndParentsByPath(this.props.selectedItemInfo.repoID,this.props.selectedItemInfo.filePath))}},{key:"render",value:function(){var e=!1;return this.isCurrentRepo()&&!this.props.selectedPath&&(e=!0),u.default.createElement("li",null,u.default.createElement("div",{className:(e?"item-active":"")+" item-info",onClick:this.onRepoItemClick},u.default.createElement("div",{className:"item-text"},u.default.createElement("span",{className:"name user-select-none ellipsis"},this.props.repo.repo_name)),u.default.createElement("div",{className:"item-left-icon"},u.default.createElement("span",{className:"item-toggle icon fa "+(this.state.isShowChildren?"fa-caret-down":"fa-caret-right"),onClick:this.onToggleClick}),u.default.createElement("i",{className:"tree-node-icon"},u.default.createElement("span",{className:"icon far fa-folder tree-node-icon"})))),this.state.isShowChildren&&u.default.createElement(f.default,{repo:this.props.repo,onDirentItemClick:this.onDirentItemClick,selectedRepo:this.props.selectedRepo,selectedPath:this.props.selectedPath,fileSuffixes:this.props.fileSuffixes,treeData:this.state.treeData,onNodeCollapse:this.onNodeCollapse,onNodeExpanded:this.onNodeExpanded}))}}]),t}(u.default.Component);P.propTypes=E,t.default=P},99:function(e,t,n){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),l=n(0),u=a(l),c=n(1),d=a(c),p=n(100),f=a(p),h={selectedPath:d.default.string,selectedRepo:d.default.object,repo:d.default.object.isRequired,onDirentItemClick:d.default.func.isRequired,treeData:d.default.object.isRequired,onNodeCollapse:d.default.func.isRequired,onNodeExpanded:d.default.func.isRequired,fileSuffixes:d.default.array},m=function(e){function t(){return r(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return i(t,e),s(t,[{key:"render",value:function(){return u.default.createElement("div",{className:"list-view-content",style:{marginLeft:"-1.5rem"}},u.default.createElement(f.default,{node:this.props.treeData.root,onNodeCollapse:this.props.onNodeCollapse,onNodeExpanded:this.props.onNodeExpanded,repo:this.props.repo,onDirentItemClick:this.props.onDirentItemClick,selectedRepo:this.props.selectedRepo,selectedPath:this.props.selectedPath,fileSuffixes:this.props.fileSuffixes}))}}]),t}(u.default.Component);m.propTypes=h,t.default=m}},[2289]);